id: dvwa-default-login
info:
  name: DVWA Default Login
  author: pdteam
  severity: critical
  description: DVWA Default Login is a predetermined username and password used in
    the Damn Vulnerable Web App to test the security skills of professionals.
  reference:
  - https://opensourcelibs.com/lib/dvwa
  classification:
    cwe-id: CWE-798
  tags: dvwa,default-login
  metadata:
    impact: The impact of the DVWA Default Login is that it provides security professionals
      with a tool for testing and improving their security measures by exposing vulnerabilities
      in a controlled environment.
    recommendation: I recommend using the hard coded credentials in DVWA Default Login
      as part of a security testing scenario for professionals.
requests:
- raw:
  - 'GET /login.php HTTP/1.1

    Host: {{Hostname}}

    Accept-Language: en-GB,en-US;q=0.9,en;q=0.8

    Connection: close

    '
  - 'POST /login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: PHPSESSID={{session}}; security=low

    Connection: close


    username={{username}}&password={{password}}&Login=Login&user_token={{token}}

    '
  payloads:
    username:
    - admin
    password:
    - password
  attack: pitchfork
  extractors:
  - type: regex
    name: token
    group: 1
    internal: true
    part: body
    regex:
    - hidden' name='user_token' value='([0-9a-z]+)'
  - type: kval
    name: session
    internal: true
    part: body
    kval:
    - PHPSESSID
  host-redirects: true
  matchers:
  - type: word
    words:
    - You have logged in as 'admin'
