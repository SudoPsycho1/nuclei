id: wordpress-email-enumeraion
info:
  name: Wordpress - User Email Enumeraion
  author: UiltonLopes
  severity: info
  description: The endpoint supports the parameter “search”. Its value is match against all user's fields including the email address. With simple automation it is possible to discover each email address. The user information associated to an email matched will be returned in the JSON response.
  reference:
    - https://www.gosecure.net/blog/2021/03/16/6-ways-to-enumerate-wordpress-users/
  tags: wordpress,wp,enum

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wp/v2/users?search=@{{Hostname}}"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"name":'
          - '"id":'
        condition: and

      - type: word
        part: header
        words:
          - "application/json"

      - type: status
        status:
          - 200
