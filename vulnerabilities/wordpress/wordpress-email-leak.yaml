id: wordpress-email-leak

info:
  name: Wordpress Email Leak
  author: UiltonLopes
  severity: info
  description: The endpoint supports the parameter “search”. Its value is match against all user’s fields including the email address. With simple automation it is possible to discover each email address. The user information associated to an email matched will be returned in the JSON response.
  reference:
    - https://www.gosecure.net/blog/2021/03/16/6-ways-to-enumerate-wordpress-users/
  tags: wordpress, enum

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-json/wp/v2/users?search=@"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '[{"id":'
        part: body
