id: httpbin-open-redirect

info:
  name: HTTPBin - Open Redirect
  author: Adam Crosser
  severity: low
  reference: https://github.com/postmanlabs/httpbin
  metadata:
    shodan-query: http.title:"httpbin.org"
  tags: panel,redirect,httpbin

requests:
  - method: GET
    path:
      - "{{BaseURL}}/redirect-to?url=https%3A%2F%2Fattacker.com"

    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?:\/\/|\/\/|\/\\\\|\/\\)?(?:[a-zA-Z0-9\-_\.@]*)attacker\.com\/?(\/|[^.].*)?$' # https://regex101.com/r/ZDYhFh/1
