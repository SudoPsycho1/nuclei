id: hadoop-unauth-rce
info:
  name: Apache Hadoop YARN ResourceManager - Remote Code Execution
  author: pdteam,Couskito
  severity: critical
  description: Apache Hadoop YARN ResourceManager is vulnerable to a type of attack
    called hadoop-unauth-rce, which allows an attacker to gain access to and control
    a system without proper authentication.
  reference:
  - http://archive.hack.lu/2016/Wavestone%20-%20Hack.lu%202016%20-%20Hadoop%20safari%20-%20Hunting%20for%20vulnerabilities%20-%20v1.0.pdf
  - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/hadoop_unauth_exec.rb
  - https://github.com/vulhub/vulhub/tree/master/hadoop/unauthorized-yarn
  - https://github.com/Al1ex/Hadoop-Yarn-ResourceManager-RCE
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-306
  tags: vulhub,apache,hadoop,unauth,rce,msf
  metadata:
    impact: The Hadoop-unauth-rce vulnerability has a significant impact on the security
      of the Apache Hadoop YARN ResourceManager, exposing the system to a range of
      malicious activities that can compromise data integrity and confidentiality.
    recommendation: It is highly recommended to immediately update Apache Hadoop YARN
      ResourceManager to the latest version to prevent remote code execution vulnerabilities.
requests:
- method: POST
  path:
  - '{{BaseURL}}/ws/v1/cluster/apps/new-application'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - '"application-id"'
  - type: status
    status:
    - 200
