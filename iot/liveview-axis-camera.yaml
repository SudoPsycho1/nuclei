id: liveview-axis-camera

info:
  name: Live View AXIS Network Camera
  author: dhiyaneshDK,f1she3
  severity: info
  reference: https://www.exploit-db.com/ghdb/6843
  tags: iot,axis,network

requests:
- method: GET
  path:
      - '{{BaseURL}}/view/viewer_index.shtml'
      - '{{BaseURL}}/view/view.shtml'
      - '{{BaseURL}}/pics/logo_70x29px.gif'
  redirects: true

  matchers-condition: or
  matchers:
    - type: dsl
      name: stream-view
      dsl:
        - 'status_code == 200'
        - 'contains(tolower(body), "live view  - axis")'
        - 'contains(tolower(body), "live view - axis")'
      condition: and

    - type: dsl
      dsl:
        - 'status_code == 200'
        - 'contains(tolower(body), "/incl/axis_connection.js")'
      condition: and

    - type: dsl
      dsl:
        - 'status_code == 200'
        - 'contains(body, "/js/sharedjs/AxisConnection.js")'
      condition: and

    - type: dsl
      name: logo
      dsl:
        - 'status_code == 200'
        - '"1106649083" == mmh3(base64_py(body))'
      condition: and
