id: require-sts-header

info:
  name: Require Sts Header
  author: glassrye
  severity: high
  description: Looks for the Strict-Transport-Security header in the response
  tags: compliance


requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Content-Type: application/json
    matchers:
      - type: dsl
        dsl:
         - "!contains(tolower(all_headers), 'strict-transport-security')"