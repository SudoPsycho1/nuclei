id: require-content-type-options

info:
  name: Require X-Content-Type-Options
  author: glassrye
  severity: high
  description: Look for the X-Content-Type-Options header and fail if not there.
  tags: compliance


requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    headers:
      Content-Type: application/json
    matchers:
      - type: dsl
        dsl:
          - "!contains(tolower(all_headers), 'x-content-type-options')"