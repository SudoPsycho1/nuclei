id: Directory-listing

info:
  name: Directory listing
  author: huowuzhao
  severity: medium
  reference: https://portswigger.net/kb/issues/00600100_directory-listing
  tags: Directory listing

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: or
    matchers:
      - type: word
        words:
          - "<title>/</title>"
          - "<title>Index of /</title>"
          - "<title>Directory listing for /</title>"
        part: body

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "<small>([a-z0-9.]+)</small>"
