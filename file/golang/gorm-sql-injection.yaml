id: gorm-sql-injection

info:
  name: Gorm SQL Injection
  author: wahyuhadi
  severity: high
  reference:
    - https://github.com/go-gorm/gorm/issues/2517
  metadata:
    verified: true
  tags: go,file

file:
  - extensions:
      - go
    extractors:
      - type: regex
        # Likely vulnerable: Where("id = "+id)
        # Likely not Vulnerable: Where("id = ?", id)
        regex:
          - 'Where\(.*\+.*\)|where\(.*\+.*\)'
      - type: regex
        # Likely vulnerable: Find(&users) or First(&users)
        # Likely not Vulnerable: Find(&users,id) or First(&users,id)
        regex:
          - 'Find\(.*\,.*\)|First\(.*\,.*\)'
