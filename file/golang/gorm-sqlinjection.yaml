id: gorm-sqlinjection

info:
  name: Gorm SQL Injection
  author: wahyuhadi
  severity: high
  tags: go,file

file:
  - extensions:
      - go
    extractors:
      - type: regex
        # Investigate for possible SQL Injection https://github.com/go-gorm/gorm/issues/2517
        # Likely vulnerable: Where("id = "+id)
        # Likely not Vulnerable: Where("id = ?", id)
        regex:
          - 'Where\(.*\+.*\)|where\(.*\+.*\)'
      - type: regex
        # Investigate for possible SQL Injection https://github.com/go-gorm/gorm/issues/2517
        # Likely vulnerable: Find(&users) or First(&users)
        # Likely not Vulnerable: Find(&users,id) or First(&users,id)
        regex:
          - 'Find\(.*\,.*\)|First\(.*\,.*\)'