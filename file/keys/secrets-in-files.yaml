id: secrets-in-files

info:
  name: Secrets in files
  author: ayadi momhamed
  severity: info
  tags: token,file

file:
  - extensions:
      - all
    extractors:
      - type: regex
        name: secrets
        regex:
          - "(password|pwd|passwd|pass|key|secret|private|access|cred|creds|api|token)(_|-){1,}(\\s){0,}(key|pass|pwd|passwd|private|credentials|auth|cred|creds|secret|password|access|token)(\\s){0,}(=|:|is){0,}"
          - "([a-z0-9]+)((_|-){1,}(\\s){0,})(key|pass|credentials|auth|cred|creds|secret|password|access|token|api)(\\s){0,}(=|:|is){0,}"
          - "(password|pwd|passwd|pass|key|secret|private|access|cred|creds|api|token)(\\s){0,}(=|:|is){0,}"
      - type: regex
        name: deep-look
        regex:
          - "(([a-z0-9]+)(_|-){1,}){1,}((key|pass|credentials|auth|cred|creds|secret|password|access|token|passwd|db|api|admin|private|bash)(\\s|_|-){0,}){1,}(=|:|is){0,}"       
