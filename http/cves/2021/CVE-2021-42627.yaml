id: CVE-2021-42627

info:
  name: D-Link DIR-615 - Unauthorized Access
  author: For3stCo1d
  severity: critical
  description: |
    D-Link DIR-615 devices with firmware 20.06 are susceptible to unauthorized access. An attacker can access the WAN configuration page wan.htm without authentication, which can lead to disclosure of WAN settings, data modification, and/or other unauthorized operations.
  remediation: |
    Apply the latest firmware update provided by D-Link to fix the vulnerability and ensure strong and unique passwords are set for router administration.
  reference:
    - https://github.com/sanjokkarki/D-Link-DIR-615/blob/main/CVE-2021-42627
    - https://www.dlink.com/en/security-bulletin/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-42627
    - http://d-link.com
    - http://dlink.com
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-42627
    epss-score: 0.05731
    epss-percentile: 0.92544
    cpe: cpe:2.3:o:dlink:dir-615_firmware:20.06:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: dlink
    product: dir-615_firmware
    shodan-query: http.title:"Roteador Wireless"
  tags: cve,cve2021,d-link,router,unauth,dir-615,roteador,dlink

http:
  - method: GET
    path:
      - "{{BaseURL}}/wan.htm"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "src='menu.js?v=\"+Math.random()+\"'></scr\"+\"ipt>\");"
          - "var ipv6conntype"
        condition: and

      - type: word
        part: header
        words:
          - Virtual Web

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100a31f1135554cae533c4ec983d536c1fddcfeef0b8bfabab1221f2a7465464196022100c6157673e9d5d4fcc6b32fdf30b57fee8debe3eb5197ea33e48026a6f3ad4ec0:922c64590222798bb761d5b6d8e72950