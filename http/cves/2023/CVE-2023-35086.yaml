id: CVE-2023-35086

info:
  name: ASUS RT-AX56U V2 & RT-AC86U - Unauthenticated Remote Command Injection
  author: gy741
  severity: critical
  description: |
    It is identified a format string vulnerability in ASUS RT-AX56U V2 & RT-AC86U. This vulnerability is caused by directly using input as a format string when calling syslog in logmessage_normal function, in the do_detwan_cgi module of httpd. An unauthenticated remote attacker without privilege can exploit this vulnerability to perform remote arbitrary code execution, arbitrary system operation or disrupt service. This issue affects RT-AX56U V2: 3.0.0.4.386_50460; RT-AC86U: 3.0.0.4_386_51529
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-35086
    - https://github.com/tin-z/CVE-2023-35086-POC
    - https://www.twcert.org.tw/tw/cp-132-7240-a5f96-1.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-35086
    cwe-id: CWE-134
    epss-score: 0.002510000
    cpe: cpe:2.3:o:asus:rt-ac86u_firmware:3.0.0.4_386_51529:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    fofa-query: app="ASUS-RT-AX56U-V2"
  tags: cve,cve2023,asus,router,iot

http:
  - raw:
      - |
        GET /detwan.cgi?action_mode=GetWanStatus HTTP/1.1
        Host: {{Hostname}}
        Referer: {{RootURL}}
        Origin: {{RootURL}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '{ \"state\":'

      - type: status
        status:
          - 200
