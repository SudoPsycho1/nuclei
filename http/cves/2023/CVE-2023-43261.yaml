id: CVE-2023-43261

info:
  name: Milesight Industrial Cellular Routers - Information Disclosure
  author: ritikchaddha
  severity: high
  description: |
    A critical security vulnerability has been identified in Milesight Industrial Cellular Routers, compromising the security of sensitive credentials and permitting unauthorized access. This vulnerability stems from a misconfiguration that results in directory listing being enabled on the router systems, rendering log files publicly accessible. These log files, while containing sensitive information such as admin and other user passwords (encrypted as a security measure), can be exploited by attackers via the router's web interface.
  reference:
    - https://github.com/win3zz/CVE-2023-43261
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-43261
  classification:
    cve-id: CVE-2023-43261
  metadata:
    max-request: 1
    verified: true
    shodan-query: http.html:rt_title
  tags: cve,cve2023,,milesight,log,exposure

http:
  - method: GET
    path:
      - '{{BaseURL}}/lang/log/httpd.log'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'username":'
          - 'password":'
          - 'model":'
          - 'Loggined in'
        condition: and

      - type: word
        part: header
        words:
          - 'text/plain'

      - type: status
        status:
          - 200
