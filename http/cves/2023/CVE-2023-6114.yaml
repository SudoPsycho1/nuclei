id: CVE-2023-6114

info:
  name: Duplicator < 1.5.7.1; Duplicator Pro < 4.5.14.2 - Unauthenticated Sensitive Data Exposure
  author: DhiyaneshDk
  severity: high
  description: |
    The Duplicator WordPress plugin before 1.5.7.1, Duplicator Pro WordPress plugin before 4.5.14.2 does not disallow listing the `backups-dup-lite/tmp` directory (or the `backups-dup-pro/tmp` directory in the Pro version), which temporarily stores files containing sensitive data. When directory listing is enabled in the web server, this allows unauthenticated attackers to discover and access these sensitive files, which include a full database dump and a zip archive of the site.
  remediation: Duplicator Fixed in 1.5.7.1,Duplicator-Pro Fixed in 4.5.14.2.
  reference:
    - https://drive.google.com/file/d/1mpapFCqfZLv__EAM7uivrrl2h55rpi1V/view?usp=sharing
    - https://wpscan.com/vulnerability/5c5d41b9-1463-4a9b-862f-e9ee600ef8e1
    - https://nvd.nist.gov/vuln/detail/CVE-2023-6114
    - https://wpscan.com/plugin/duplicator/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2023-6114
    cwe-id: CWE-552
    epss-score: 0.00145
    epss-percentile: 0.50326
    cpe: cpe:2.3:a:awesomemotive:duplicator:*:*:*:*:-:wordpress:*:*
  metadata:
    max-request: 2
  tags: cve,cve2023,duplicator,duplicator-pro,lfi,wpscan,wordpress,wp-plugin,wp

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/backups-dup-lite/tmp/"
      - "{{BaseURL}}/wp-content/backups-dup-pro/tmp/"

    stop-at-first-match: true
    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains(body, '/tmp') && contains(body, '<title>Index of')"
        condition: and
# digest: 490a00463044022075b9822fd34e2ba3c249425a486eb6691669b77956bfd44c957765119abe95e702203966ded44a62c396e22db4e8038af5f42f2945f08c6daddf8d3f09ee760fb970:922c64590222798bb761d5b6d8e72950