id: CVE-2023-22515

info:
  name: Confluence - Privilege Escalation
  author: DhiyaneshDk
  severity: critical
  description: |
    Atlassian Confluence Data Center and Server contains a privilege escalation vulnerability that allows an attacker to create unauthorized Confluence administrator accounts and access Confluence.
  remediation: Update to the latest version of Confluence
  reference:
    - https://confluence.atlassian.com/security/cve-2023-22515-privilege-escalation-vulnerability-in-confluence-data-center-and-server-1295682276.html
    - https://confluence.atlassian.com/kb/faq-for-cve-2023-22515-1295682188.html
    - https://jira.atlassian.com/browse/CONFSERVER-92475
    - https://x.com/h4x0r_dz/status/1709911774365884821?s=20
    - https://www.cisa.gov/news-events/alerts/2023/10/05/cisa-adds-three-known-exploited-vulnerabilities-catalog
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
  metadata:
    max-request: 1
    verified: true
    fofa-query: app="ATLASSIAN-Confluence"
  tags: cve,cve2023,confluence,auth-bypass,kev

http:
  - method: GET
    path:
      - "{{BaseURL}}/setup/setupadministrator.action"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "<title>Setup System Administrator - Confluence</title>"
        part: body

      - type: status
        status:
          - 200
      - type: word
        words:
          - "Setup is already complete"
        part: body
        negative: true
