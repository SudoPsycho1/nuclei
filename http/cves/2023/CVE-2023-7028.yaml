id: CVE-2023-7028

info:
  name: Gitlab CVE-2023-7028 unauthenticated account takeover via password reset
  author: h4sh5
  severity: critical
  description: An issue has been discovered in GitLab CE/EE affecting all versions from 16.1 prior to 16.1.6, 16.2 prior to 16.2.9, 16.3 prior to 16.3.7, 16.4 prior to 16.4.5, 16.5 prior to 16.5.6, 16.6 prior to 16.6.4, and 16.7 prior to 16.7.2 in which user account password reset emails could be delivered to an unverified email address. (patch includes changing the message on the password reset page.)
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N
    cvss-score: 10
    cwe-id: CWE-204
    cve-id: CVE-2023-7028
  metadata:
    max-request: 1
    shodan-query: product:gitlab
  tags: cve,cve2023,gitlab

http:
  - method: GET
    path:
      - "{{BaseURL}}/users/password/new"

    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'GitLab'
          - 'Requires your primary GitLab email address.'
        condition: and

      - type: status
        status:
          - 200
