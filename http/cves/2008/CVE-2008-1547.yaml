id: CVE-2008-1547

info:
  name: Microsoft OWA Exchange Server 2003 - 'redir.asp' Open Redirection
  author: ctflearner
  severity: medium
  description: |
    Open redirect vulnerability in exchweb/bin/redir.asp in Microsoft Outlook Web Access (OWA) for Exchange Server 2003 SP2 (aka build 6.5.7638) allows remote attackers to redirect users to arbitrary web sites and conduct phishing attacks via a URL in the URL parameter.
  remediation: |
    Apply the necessary security patches or upgrade to a newer version of Microsoft Exchange Server.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2008-1547
    - https://www.exploit-db.com/exploits/32489
    - http://securityreason.com/securityalert/4441
    - https://exchange.xforce.ibmcloud.com/vulnerabilities/46061
  classification:
    cvss-metrics: CVSS:2.0/AV:N/AC:M/Au:N/C:N/I:P/A:N
    cvss-score: 4.3
    cve-id: CVE-2008-1547
    cwe-id: CWE-601
    epss-score: 0.03523
    epss-percentile: 0.90476
    cpe: cpe:2.3:a:microsoft:exchange_server:2003:sp2:*:*:*:*:*:*
  metadata:
    max-request: 2
    vendor: microsoft
    product: exchange_server
    shodan-query: http.title:"Outlook"
  tags: cve,cve2008,redirect,owa,exchange,microsoft

http:
  - method: GET
    path:
      - "{{BaseURL}}/exchweb/bin/redir.asp?URL=https://interact.sh"
      - "{{BaseURL}}/CookieAuth.dll?GetLogon?url=%2Fexchweb%2Fbin%2Fredir.asp%3FURL%3Dhttps%3A%2F%2Finteract.sh&reason=0"

    stop-at-first-match: true
    matchers:
      - type: regex
        part: header
        regex:
          - '(?m)^(?:Location\s*?:\s*?)(?:https?://|//)(?:[a-zA-Z0-9\-_\.@]*)interact\.sh.*$'
# digest: 490a0046304402202e6dd993c0ce94ac8b1f241c3302919d622f72b7fde605d50622cb2dd4e9113f022052633e63ab4558e9a3cc6a6e37815b12918645d3e303e5d9f9c936c962f7ed78:922c64590222798bb761d5b6d8e72950