id: CVE-2024-34351

info:
  name: Next.Js >= 13.4.0, < 14.1.1 - SSRF
  author: userdehghani
  severity: high
  remediation: Upgrade to Next.js version 14.1.1 or higher.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-34351
    - https://www.tenable.com/cve/CVE-2024-34351
    - https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g
    - https://www.assetnote.io/resources/research/digging-for-ssrf-in-nextjs-apps
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2024-34351
    cwe-id: CWE-918
  metadata:
    max-request: 1
    shodan-query: html:"/_next/static"
  tags: cve,cve2024,vercel,nextjs,ssrf

http:
  - method: GET
    path:
      - '{{BaseURL}}'

    extractors:
      - type: regex
        part: body
        regex:
          - '_next/static/chunks/main-(.*?).js'
        group: 1
        name: jsfile

  - method: GET
    path:
      - "{{BaseURL}}/_next/static/chunks/main-{{jsfile}}.js"
    
    matchers:
      - type: regex
        part: body
        regex:
          - '"13.4.0"'
          - '"13.5.0"'
          - '"13.5.1"'
          - '"14.0.0"'
          - '"14.1.0"'
        condition: or