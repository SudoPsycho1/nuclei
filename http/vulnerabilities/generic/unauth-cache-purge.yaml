id: unauth-cache-purge

info:
  name: Unauthenticated Cache Purge Vulnerability
  author: 0xKayala
  severity: low
  description: This Template Checks if it's possible to purge the cache without authentication.
  reference:
    - https://vulners.com/hackerone/H1:1911568
    - https://hackerone.com/reports/1911568
  tags: cache,purge,vuln

requests:
  - method: PURGE
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 204

      - type: word
        words:
          - '"status": "ok"'
        part: body

      - type: regex
        regex:
          - '.*"id": "\d{4}-\d+-\d+".*'
        part: body

    extractors:
      - type: regex
        regex:
          - '"id": "(?P<cache_id>\d{4}-\d+-\d+)"'
        group: 1
