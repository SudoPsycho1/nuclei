id: f5-bigip-internal-ip-disclosure

info:
  name: F5 Big ip Cookie internal ip disclosure
  author: Arm!tage
  severity: low
  description: The cookie is set to expire based on the expiration setting configured in the persistence profile. The cookie value contains the encoded IP address and port of the destination server.
  reference: 
    - "https://my.f5.com/manage/s/article/K6917"
  tags: disclosure,f5,bigip


http: 
  - method: GET
    path: 
      - "{{BaseURL}}/"
    
    matchers:
      - type: regex
        part: header
        regex:
          - BIGipServer.+=\d+\.\d+\.0000

    extractors:
      - type: regex
        part: header
        regex:
          - "BIGipServer.+=(.*?)"