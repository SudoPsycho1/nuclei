id: backup-migration-rce

info:
  name: Worpress Backup Migration <= 1.3.7 backup-backup Unauthenticated Remote Code Execution
  author: FLX
  severity: critical
  description: |
    The Backup Migration plugin for WordPress is vulnerable to Remote Code Execution in all versions up to, and including, 1.3.7 via the /includes/backup-heart.php file. This is due to an attacker being able to control the values passed to an include, and subsequently leverage that to achieve remote code execution. This makes it possible for unauthenticated threat actors to easily execute code on the server.
  reference:
    - https://www.wordfence.com/blog/2023/12/critical-unauthenticated-remote-code-execution-found-in-backup-migration-plugin/
    - https://github.com/Chocapikk/CVE-2023-6553
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-6553
  tags: wp-plugin,rce,unauth,wordpress,wp,intrusive,backup-migration

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-content/plugins/backup-backup/includes/backup-heart.php"
    headers:
      Content-Dir: "{{rand_text_alpha(10)}}"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        negative: true
        words:
        - "Incorrect parameters"