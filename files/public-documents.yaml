id: public-documents

info:
  name: Alerts on pages that contain links to Excel, Word or CSV documents
  author: geeknik
  severity: info

requests:
  - method: GET
    path:
      - "{{BaseURL}}"

    redirects: true
    max-redirects: 3

    extractors:
      - type: regex
        part: body
        name: public_xls
        regex:
          - '([a-zA-Z0-9_\\.\-\(\):])+\.(xls|xlsx)'
      - type: regex
        part: body
        name: public_doc
        regex:
          - '([a-zA-Z0-9_\\.\-\(\):])+\.(doc|docx)'
      - type: regex
        part: body
        name: public_csv
        regex:
          - '([a-zA-Z0-9_\\.\-\(\):])+\.(csv)'
