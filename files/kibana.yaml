id: kibana

info:
  name: Exposed Kibana
  author: Shine
  severity: medium

requests:
  - method: GET
    path:
      - '{{BaseURL}}/'
      - '{{BaseURL}}:5601/'
      - '{{BaseURL}}/api/console/proxy?uri=_mapping'
      - '{{BaseURL}}:5601/api/console/proxy?uri=_mapping'
      - '{{BaseURL}}/app/kibana/'
      - '{{BaseURL}}:5601/app/kibana/'

    matchers-condition: and
    matchers:
      - type: word
        words:
           - 'kibanaWelcomeView'
           - 'cluster_uuid'
           - 'kibanaWelcomeLogo'
           - 'kibanaWelcomeTitle'
      - type: status
        status:
          - 200
