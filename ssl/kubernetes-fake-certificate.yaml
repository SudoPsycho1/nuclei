id: kubernetes-fake-certificate
info:
  name: Kubernetes Fake Ingress Certificate - Detect
  author: kchason
  severity: low
  description: Kubernetes Fake Ingress Certificate is a testing feature that enables
    users to create and utilize fake or self-signed SSL/TLS certificates without needing
    to obtain a real SSL/TLS certificate from a trusted CA.
  remediation: Purchase or generate a proper SSL certificate for this service.
  reference:
  - https://snyk.io/blog/setting-up-ssl-tls-for-kubernetes-ingress/
  metadata:
    verified: 'true'
    shodan-query: ssl:"Kubernetes Ingress Controller Fake Certificate"
    impact: The impact of the Kubernetes Fake Ingress Certificate is that developers
      can easily test SSL/TLS functionality without incurring the cost and time associated
      with obtaining a real certificate from a trusted CA.
    recommendation: I highly recommend using Kubernetes Fake Ingress Certificate for
      testing purposes as it saves time and eliminates the need to obtain a real SSL/TLS
      certificate from a trusted Certificate Authority.
  tags: ssl,kubernetes,tls,self-signed
ssl:
- address: '{{Host}}:{{Port}}'
  matchers:
  - type: dsl
    dsl:
    - subject_cn == "Kubernetes Ingress Controller Fake Certificate"
    - issuer_cn == "Kubernetes Ingress Controller Fake Certificate"
    condition: or
  extractors:
  - type: dsl
    dsl:
    - '"Issuer: " + issuer_cn'
