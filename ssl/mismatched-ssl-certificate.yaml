id: mismatched-ssl-certificate
info:
  name: Mismatched SSL Certificate
  author: pdteam
  severity: low
  reference:
  - https://www.invicti.com/web-vulnerability-scanner/vulnerabilities/ssl-certificate-name-hostname-mismatch/
  tags: ssl,mismatched,tls
  description: When a user accesses a website with a mismatched SSL certificate, it
    means that the certificate does not match the identity of the website's owner,
    which could result in a security risk.
  metadata:
    impact: The impact of a mismatched SSL certificate can lead to a lack of trust
      in the website's security and potential loss of sensitive information.
    recommendation: I recommend resolving the mismatched SSL certificate issue to
      ensure secure and trustworthy website communication.
ssl:
- address: '{{Host}}:{{Port}}'
  matchers:
  - type: dsl
    dsl:
    - mismatched == true
    - ip != host
    condition: and
  extractors:
  - type: dsl
    dsl:
    - '"CN: " + subject_cn'
