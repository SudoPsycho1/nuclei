id: express-full-path-disclosure

info:
  name: Express JS Routes exposure
  author: nithissh
  severity: low
  description: when a malformed URI like %ff was passed as a subdirectory. The server get crashes and leaks some internal paths
  tags: dos

requests:
- raw:
  - |+
    GET /%ff HTTP/2
    Host: {{Hostname}}


  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - 'URIError: Failed to decode param'
    - 'node_modules'
  - type: status
    status:
    - 500
