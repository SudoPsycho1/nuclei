id: CVE-2016-3088
info:
  name: Apache ActiveMQ Fileserver - Arbitrary File Write
  author: fq_hsu
  severity: critical
  description: The Apache ActiveMQ Fileserver vulnerability in versions before 5.14.0
    allows attackers to upload and execute malicious files by utilizing HTTP PUT and
    MOVE requests.
  reference:
  - https://www.exploit-db.com/exploits/40857
  - https://medium.com/@knownsec404team/analysis-of-apache-activemq-remote-code-execution-vulnerability-cve-2016-3088-575f80924f30
  - http://activemq.apache.org/security-advisories.data/CVE-2016-3088-announcement.txt
  - https://nvd.nist.gov/vuln/detail/CVE-2016-3088
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2016-3088
    cwe-id: CWE-20
  tags: fileupload,kev,edb,cve,cve2016,apache,activemq,intrusive
  metadata:
    impact: The impact of CVE-2016-3088 on Apache ActiveMQ Fileserver is severe as
      it allows remote attackers to upload and execute arbitrary files, potentially
      compromising the entire system.
    recommendation: It is recommended to update Apache ActiveMQ to version 5.14.0
      or later to prevent remote attackers from uploading and executing arbitrary
      files via the Fileserver web application.
requests:
- raw:
  - 'PUT /fileserver/test.txt HTTP/1.1

    Host: {{Hostname}}


    {{randstr}}

    '
  - 'GET /fileserver/test.txt HTTP/1.1

    Host: {{Hostname}}

    '
  req-condition: true
  matchers:
  - type: dsl
    dsl:
    - status_code_1==204
    - status_code_2==200
    - contains((body_2), '{{randstr}}')
    condition: and
