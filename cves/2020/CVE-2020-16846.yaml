id: CVE-2020-16846
info:
  name: SaltStack <=3002 - Shell Injection
  author: dwisiswant0
  severity: critical
  description: The SaltStack vulnerability CVE-2020-16846 enables unauthorized access
    to the Salt API by exploiting shell injections, allowing for the execution of
    remote code.
  reference:
  - https://saltproject.io/on-november-3-2020-saltstack-publicly-disclosed-three-new-cves/
  - https://mp.weixin.qq.com/s/R8qw_lWizGyeJS0jOcYXag
  - https://github.com/vulhub/vulhub/tree/master/saltstack/CVE-2020-16846
  - https://nvd.nist.gov/vuln/detail/CVE-2020-16846
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-16846
    cwe-id: CWE-78
  tags: vulhub,cve,cve2020,saltstack,kev
  metadata:
    impact: The impact of CVE-2020-16846 on SaltStack <=3002 is that an unauthenticated
      user can execute arbitrary code on the Salt-API using shell injections, posing
      a significant security risk.
    recommendation: It is recommended to update SaltStack to a version higher than
      3002 to prevent the CVE-2020-16846 vulnerability which allows unauthorized users
      to execute shell injection attacks.
requests:
- method: POST
  path:
  - '{{BaseURL}}/run'
  body: token=1337&client=ssh&tgt=*&fun=a&roster=projectdiscovery&ssh_priv=nuclei
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - An unexpected error occurred
  - type: dsl
    dsl:
    - regex("CherryPy\/([0-9.]+)", header) || regex("CherryPy ([0-9.]+)", body)
  - type: word
    part: header
    words:
    - application/json
  - type: status
    status:
    - 500
