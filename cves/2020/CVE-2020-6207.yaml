id: CVE-2020-6207
info:
  name: SAP Solution Manager 7.2 - Remote Command Execution
  author: _generic_human_
  severity: critical
  description: SAP Solution Manager 7.2 has a critical vulnerability that allows attackers
    to remotely execute arbitrary commands without proper authentication checks.
  reference:
  - https://launchpad.support.sap.com/#/notes/2890213
  - https://wiki.scn.sap.com/wiki/pages/viewpage.action?pageId=540935305
  - https://i.blackhat.com/USA-20/Wednesday/us-20-Artuso-An-Unauthenticated-Journey-To-Root-Pwning-Your-Companys-Enterprise-Software-Servers-wp.pdf
  - https://github.com/chipik/SAP_EEM_CVE-2020-6207
  - https://www.rapid7.com/db/modules/auxiliary/admin/sap/cve_2020_6207_solman_rce/
  - https://www.rapid7.com/db/modules/exploit/multi/sap/cve_2020_6207_solman_rs/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-6207
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-6207
    cwe-id: CWE-306
  tags: cve,cve2020,sap,solman,rce,kev
  metadata:
    impact: The impact of CVE-2020-6207 is that it allows attackers to remotely execute
      OS commands on connected SMDAgents within SAP Solution Manager 7.2 without proper
      authentication, by sending HTTP requests, leading to potential data breaches
      and system compromise.
    recommendation: I recommend updating SAP Solution Manager 7.2 to patch CVE-2020-6207
      and prevent remote command execution vulnerabilities.
requests:
- raw:
  - 'POST /EemAdminService/EemAdmin HTTP/1.1

    Host: {{Hostname}}

    SOAPAction: ""

    Content-Type: text/xml; charset=UTF-8

    Connection: close


    <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:adm="http://sap.com/smd/eem/admin/"><soapenv:Header/><soapenv:Body><adm:getAllAgentInfo/></soapenv:Body></soapenv:Envelope>

    '
  matchers-condition: and
  matchers:
  - type: word
    words:
    - :Envelope
    - :Body
    - :getAllAgentInfoResponse
    part: body
    condition: and
  - type: status
    status:
    - 200
  - type: word
    words:
    - text/xml
    - SAP NetWeaver Application Server
    part: header
    condition: and
