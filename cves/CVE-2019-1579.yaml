id: CVE-2019-1579

info:
  name: PreAuth RCE on Palo Alto GlobalProtect
  author: shelld3v
  severity: high
  description: Remote Code Execution in PAN-OS 7.1.18 and earlier, PAN-OS 8.0.11-h1 and earlier, and PAN-OS 8.1.2 and earlier with GlobalProtect Portal or GlobalProtect Gateway Interface enabled may allow an unauthenticated remote attacker to execute arbitrary code

  # References:
  # - https://blog.orange.tw/2019/07/attacking-ssl-vpn-part-1-preauth-rce-on-palo-alto.html

  requests:
    - method: GET
      path:
        - "{{BaseURL}}/sslmgr"
      matchers:
        - type: word
          words:
            - "<clientcert-response>"
            - "<msg>Invalid parameters</msg>"
          condition: and
          part: body
