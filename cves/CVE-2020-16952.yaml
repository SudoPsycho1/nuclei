id: cve-2020-16952

info:
  name: Microsoft SharePoint Server DataFormWebPart CreateChildControls Server-Side Include RCE
  author: dwisiswant0
  severity: critical

  # This template supports the detection part only. See references[2].
  # References:
  # - [1] Patch: https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-16952
  # - [2] https://srcincite.io/pocs/cve-2020-16952.py.txt
  # - [3] https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16952

requests:
  - method: PUT
    path:
      - "{{BaseURL}}/poc.aspx"
    body: "<asp:Literal runat=\"server\" Text=\"<%$SPTokens:{ProductNumber}%>\" />"
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "16.0.10364.20001"
        part: body
      - type: status
        status:
          - 200