id: CVE-2019-7609
info:
  name: Kibana Timelion - Arbitrary Code Execution
  author: dwisiswant0
  severity: critical
  description: Kibana Timelion versions before 5.6.15 and 6.6.1 are susceptible to
    arbitrary code execution attacks, potentially allowing attackers to execute arbitrary
    commands with the privileges of the Kibana process on the host system.
  reference:
  - https://github.com/mpgn/CVE-2019-7609
  - https://discuss.elastic.co/t/elastic-stack-6-6-1-and-5-6-15-security-update/169077
  - https://nvd.nist.gov/vuln/detail/CVE-2019-7609
  - https://www.elastic.co/community/security
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2019-7609
    cwe-id: CWE-94
  tags: cve,cve2019,kibana,rce,kev
  metadata:
    impact: The CVE-2019-7609 vulnerability in Kibana Timelion could allow an attacker
      to execute arbitrary commands with the permissions of the Kibana process, leading
      to potential system compromise.
    recommendation: It is recommended to update Kibana to version 5.6.15 or 6.6.1
      to mitigate the arbitrary code execution vulnerability in Timelion.
requests:
- method: POST
  path:
  - '{{BaseURL}}/api/timelion/run'
  headers:
    Content-Type: application/json; charset=utf-8
  body: '{"sheet":[".es(*)"],"time":{"from":"now-1m","to":"now","mode":"quick","interval":"auto","timezone":"Asia/Shanghai"}}'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - seriesList
    part: body
  - type: word
    words:
    - application/json
    part: header
  - type: status
    status:
    - 200
