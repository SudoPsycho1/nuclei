id: CVE-2017-12149
info:
  name: Jboss Application Server - Remote Code Execution
  author: fopina,s0obi
  severity: critical
  description: The vulnerability CVE-2017-12149 in Jboss Application Server allows
    an attacker to execute arbitrary code remotely due to improper deserialization
    in the HTTP Invoker's ReadOnlyAccessFilter.
  reference:
  - https://chowdera.com/2020/12/20201229190934023w.html
  - https://github.com/vulhub/vulhub/tree/master/jboss/CVE-2017-12149
  - https://nvd.nist.gov/vuln/detail/CVE-2017-12149
  - https://bugzilla.redhat.com/show_bug.cgi?id=1486220
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2017-12149
    cwe-id: CWE-502
  tags: java,rce,deserialization,kev,vulhub,cve,cve2017,jboss
  metadata:
    impact: The CVE-2017-12149 vulnerability in Jboss Application Server could allow
      a remote attacker to execute arbitrary code by exploiting a flaw in the doFilter
      method of the HTTP Invoker.
    recommendation: It is highly recommended to update Jboss Application Server to
      prevent remote code execution vulnerability.
requests:
- raw:
  - 'POST /invoker/JMXInvokerServlet/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
  - 'POST /invoker/EJBInvokerServlet/ HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
  - 'POST /invoker/readonly HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/octet-stream


    {{ base64_decode("rO0ABXNyABNqYXZhLnV0aWwuQXJyYXlMaXN0eIHSHZnHYZ0DAAFJAARzaXpleHAAAAACdwQAAAACdAAJZWxlbWVudCAxdAAJZWxlbWVudCAyeA==")
    }}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - ClassCastException
  - type: status
    status:
    - 200
    - 500
