id: CVE-2022-30117

info:
  name: Path Traversal in Concrete CMS
  author: amit-jd
  severity: medium
  description: Concrete CMS Versions 9.0.0 through 9.0.2 as well as 8.5.7 and below allowed traversal in /index.php/ccm/system/file/upload which could result in an Arbitrary File Delete exploit.
  reference:
    - https://documentation.concretecms.org/developers/introduction/version-history/858-release-notes
    - https://github.com/github/advisory-database/blob/b8681b90369a9364834cb69462b82895ed7230cd/advisories/unreviewed/2022/06/GHSA-3jxh-6635-6jwp/GHSA-3jxh-6635-6jwp.json
  remediation: By sanitizing /index.php/ccm/system/file/upload endpoint and by changing isFullChunkFilePresent to have an early false return when input doesn't match expectations.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:N/I:N/A:H
    cvss-score: 5.8
  tags: concrete,traversal,cms,php

requests:
  - method: GET
    path:
      - "{{BaseURL}}/index.php/ccm/system/file/upload"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "AbstractController.php"
          - "call_user_func_array([$controller, $method]"
        condition: and

      - type: status
        status:
          - 500