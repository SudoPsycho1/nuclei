id: CVE-2022-0773

info:
  name: Documentor <= 1.5.3 - Unauthenticated SQLi
  author: akincibor
  severity: critical
  description: The plugin fails to sanitize and escape user input before it is being interpolated in an SQL statement and then executed, leading to an SQL Injection exploitable by unauthenticated users.
  reference:
    - https://wpscan.com/vulnerability/55b89de0-30ed-4f98-935e-51f069faf6fc
  tags: cve,cve2022,sqli,wp,wordpress,wp-plugin,unauth

requests:
  - method: GET
    path:
      - '{{BaseURL}}/wp-content/plugins/documentor-lite/readme.txt'

    extractors:
      - type: regex
        name: version
        internal: true
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

      - type: regex
        group: 1
        regex:
          - "(?m)Stable tag: ([0-9.]+)"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        words:
          - "Documentor - Create Product Documentation"
        part: body

      - type: dsl
        dsl:
          - compare_versions(version, '< 1.5.3')