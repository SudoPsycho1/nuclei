id: CVE-2022-34045
info:
  name: WAVLINK WN530HG4 - Improper Access Control
  author: arafatansari
  severity: critical
  description: The WAVLINK WN530HG4 router is vulnerable to improper access control
    due to a hardcoded encryption/decryption key, which can allow attackers to access
    sensitive information, modify data, and perform unauthorized operations.
  reference:
  - https://drive.google.com/file/d/1s5uZGC_iSzfCJt9BJ8h-P24vmsrmttrf/view?usp=sharing
  - https://nvd.nist.gov/vuln/detail/CVE-2022-34045
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-34045
    cwe-id: CWE-798
  metadata:
    shodan-query: http.html:"WN530HG4"
    verified: 'true'
    impact: The vulnerability CVE-2022-34045 in WAVLINK WN530HG4 router has an impact
      on the security of the device as it allows attackers to gain unauthorized access
      to sensitive information, modify data or execute unauthorized operations.
    recommendation: It is recommended to update the firmware of WAVLINK WN530HG4 to
      address the vulnerability of hardcoded encryption/decryption key for its configuration
      files to prevent unauthorized access and potential compromise of sensitive information.
  tags: cve,cve2022,wavlink,exposure
requests:
- raw:
  - 'GET /backupsettings.dat HTTP/1.1

    Host: {{Hostname}}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - Salted__
  - type: word
    part: header
    words:
    - application/octet-stream
  - type: status
    status:
    - 200
