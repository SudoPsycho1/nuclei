id: CVE-2021-22005
info:
  name: VMware vCenter Server - Arbitrary File Upload
  author: PR3R00T
  severity: critical
  description: The VMware vCenter Server has an arbitrary file upload vulnerability
    that allows a malicious actor to execute code on it by uploading a specially crafted
    file.
  reference:
  - https://kb.vmware.com/s/article/85717
  - https://www.vmware.com/security/advisories/VMSA-2021-0020.html
  - https://core.vmware.com/vmsa-2021-0020-questions-answers-faq
  - https://nvd.nist.gov/vuln/detail/CVE-2021-22005
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-22005
    cwe-id: CWE-434
  tags: cve,cve2021,vmware,vcenter,fileupload,kev,intrusive
  metadata:
    impact: The CVE-2021-22005 vulnerability in VMware vCenter Server may cause severe
      impact as it allows malicious actors to execute code on the server by uploading
      a specially crafted file through port 443.
    recommendation: It is highly recommended to immediately update VMware vCenter
      Server to address the arbitrary file upload vulnerability (CVE-2021-22005) and
      prevent malicious actors from exploiting this issue.
requests:
- raw:
  - 'GET / HTTP/1.1

    Host: {{Hostname}}

    '
  - 'POST /analytics/telemetry/ph/api/hyper/send?_c&_i=test HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/json


    test_data

    '
  req-condition: true
  matchers:
  - type: dsl
    dsl:
    - status_code_1 == 200
    - status_code_2 == 201
    - contains(body_1, 'VMware vSphere')
    - content_length_2 == 0
    condition: and
