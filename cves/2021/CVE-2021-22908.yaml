id: CVE-2021-22908

info:
  name: Pulse Connect Secure Samba buffer overflow
  description: |
    Pulse Connect Secure (PCS) gateway contains a buffer overflow vulnerability in Samba-related code that may allow an authenticated remote attacker to execute arbitrary code. 
    
    This template only implements the workaround detection, that whether the server has been patched (as there is no patch at the moment)
  author: pdteam, ImNightmaree
  severity: info
  reference: |
    - https://kb.cert.org/vuls/id/667933
    - https://github.com/CERTCC/PoC-Exploits/tree/master/cve-2021-22908
  tags: cve,cve2021,pcs,pulseconnectsecure

requests:
  - raw:
      - |
        GET /dana-na/ HTTP/1.1
        Host: {{Hostname}}
        Connection: close

      - | # Workaround-2104
        GET /dana/meeting HTTP/1.1
        Host: {{Hostname}}
        Connection: close

      - | # Workaround-2105
        GET /dana-cached/fb/smb/wfmd.cgi HTTP/1.1
        Host: {{Hostname}}
        Connection: close

    req-condition: true
    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'contains(body_1, "Pulse Secure")'

      - type: dsl
        dsl:
          - 'status_code_2 == 403'
          - 'status_code_3 == 403'
        condition: or
