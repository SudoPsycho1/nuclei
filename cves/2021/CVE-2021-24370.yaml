id: CVE-2021-24370
info:
  name: WordPress Fancy Product Designer <4.6.9  - Arbitrary File Upload
  author: pikpikcu
  severity: critical
  description: The CVE-2021-24370 vulnerability in the WordPress Fancy Product Designer
    plugin allows attackers to upload malicious files and execute code on the server,
    potentially gaining full control over the system without authentication.
  reference:
  - https://www.wordfence.com/blog/2021/06/critical-0-day-in-fancy-product-designer-under-active-attack/
  - https://wpscan.com/vulnerability/82c52461-1fdc-41e4-9f51-f9dd84962b38
  - https://seclists.org/fulldisclosure/2020/Nov/30
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24370
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24370
    cwe-id: CWE-434,CWE-434
  metadata:
    google-query: "inurl:\u201C/wp-content/plugins/fancy-product-designer\u201D"
    impact: The impact of the vulnerability CVE-2021-24370 in WordPress Fancy Product
      Designer plugin before 4.6.9 is an arbitrary file upload that could lead to
      the compromise of the entire system by malicious actors.
    recommendation: It is recommended to immediately update the WordPress Fancy Product
      Designer plugin to version 4.6.9 or higher to mitigate the vulnerability and
      prevent attackers from gaining system control.
  tags: wordpress,wp,seclists,cve,wpscan,cve2021,rce,wp-plugin,fancyproduct
requests:
- method: GET
  path:
  - '{{BaseURL}}/wp-content/plugins/fancy-product-designer/inc/custom-image-handler.php'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '{"error":"You need to define a directory'
  - type: word
    part: header
    words:
    - text/html
  - type: status
    status:
    - 200
