id: CVE-2021-40859
info:
  name: Auerswald COMpact 5500R 7.8A and 8.0B Devices Backdoor
  author: pussycat0x
  severity: critical
  description: The Auerswald COMpact 5500R 7.8A and 8.0B devices contain an unauthenticated
    endpoint that allows for backdoor access to the web interface and resetting the
    administrator password.
  reference:
  - https://thehackernews.com/2021/12/secret-backdoors-found-in-german-made.html
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40859
  - https://www.redteam-pentesting.de/en/advisories/-advisories-publicised-vulnerability-analyses
  - https://www.redteam-pentesting.de/en/advisories/rt-sa-2021-007/-auerswald-compact-multiple-backdoors
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-40859
  metadata:
    fofa-query: '"auerswald"'
    impact: The impact of CVE-2021-40859 is significant as it allows unauthorized
      access to sensitive information and control over the affected device.
    recommendation: It is recommended to update the firmware of Auerswald COMpact
      5500R 7.8A and 8.0B devices to fix the CVE-2021-40859 vulnerability and prevent
      bad actors from gaining backdoor access.
  tags: cve,cve2021,iot,unauth,voip,auerswald
requests:
- method: GET
  path:
  - '{{BaseURL}}/about_state'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - '"pbx"'
    - '"dongleStatus":0'
    - '"macaddr"'
    condition: and
  - type: word
    part: header
    words:
    - application/json
  - type: status
    status:
    - 200
