id: elfinder-version
info:
  name: elFinder 2.1.58 - Remote Code Execution
  author: idealphase
  severity: critical
  description: ElFinder version 2.1.58 is vulnerable to remote code execution, enabling
    attackers to execute arbitrary code and commands on the PHP connector's hosting
    server, regardless of setup.
  remediation: The issues were patched in version 2.1.59. As a workaround, ensure
    the connector is not exposed without authentication.
  reference:
  - https://github.com/Studio-42/elFinder/
  classification:
    cvss-metrics: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cwe-id: CWE-77
  tags: tech,elfinder,oss
  metadata:
    impact: The impact of the elFinder 2.1.58 remote code execution vulnerability
      is that an attacker can execute arbitrary code and commands on the server hosting
      the elFinder PHP connector, compromising its security and functionality.
    recommendation: It is recommended to update elFinder to a non-vulnerable version
      to prevent remote code execution on the server.
requests:
- method: GET
  path:
  - '{{BaseURL}}/js/elfinder.min.js'
  - '{{BaseURL}}/js/elFinder.version.js'
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - elFinder - file manager for web
    - elFinder.prototype.version =
    condition: or
  - type: status
    status:
    - 200
  extractors:
  - type: regex
    group: 1
    regex:
    - \* Version (.+) \(
    - elFinder.prototype.version = '([0-9.]+)';
