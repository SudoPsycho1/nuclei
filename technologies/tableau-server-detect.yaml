id: tableau-server-detect

# https://www.tableau.com/products/server
# The version can be inferred from the buildId 2020_4_87_v171kyxhcgb -> 2020.4
# Headers that can be used to identify Tableau Server
# X-Tableau: Tableau Server
# Server: Tableau
# Content-Security-Policy-Report-Only includes report-uri /vizql/csp-report
# In the body: VizPortalRun vizportal

info:
  name: Detect Tableau Server
  author: TechbrunchFR
  description: Detects Tableau Server and extract the buildId
  severity: info
  tags: tech,tableau

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    matchers:
      - type: word
        words:
          - "X-Tableau: Tableau Server"
        part: header
    extractors:
      - type: regex
        part: body
        name: buildId
        regex:
          - 'data-buildId="([0-9a-z_]*)'
